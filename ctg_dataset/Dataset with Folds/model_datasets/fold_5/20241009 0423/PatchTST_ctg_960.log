Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_5', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9676
Dataset loaded and preprocessed.
val set size: 1080
Dataset loaded and preprocessed.
test set size: 1080
	iters: 100, epoch: 1 | loss: 0.7081680
	speed: 0.2098s/iter; left time: 4216.7027s
	iters: 200, epoch: 1 | loss: 0.6815161
	speed: 0.0316s/iter; left time: 631.5621s
Epoch: 1 cost time: 25.42570471763611
Epoch: 1, Steps: 202 | Train Loss: 0.7247931 Vali Loss: 0.7162032 Vali AUC: 0.4999829
Validation loss decreased (inf --> 0.716203).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7427868
	speed: 0.5607s/iter; left time: 11158.3575s
	iters: 200, epoch: 2 | loss: 0.6731884
	speed: 0.0315s/iter; left time: 624.4470s
Epoch: 2 cost time: 25.114654302597046
Epoch: 2, Steps: 202 | Train Loss: 0.7034096 Vali Loss: 0.6989055 Vali AUC: 0.5224914
Validation loss decreased (0.716203 --> 0.698905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7223264
	speed: 0.5595s/iter; left time: 11020.4608s
	iters: 200, epoch: 3 | loss: 0.7200025
	speed: 0.0315s/iter; left time: 617.7171s
Epoch: 3 cost time: 24.83784770965576
Epoch: 3, Steps: 202 | Train Loss: 0.6970287 Vali Loss: 0.7012930 Vali AUC: 0.5131499
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6828219
	speed: 0.5565s/iter; left time: 10849.6536s
	iters: 200, epoch: 4 | loss: 0.6917100
	speed: 0.0316s/iter; left time: 612.5514s
Epoch: 4 cost time: 24.991886615753174
Epoch: 4, Steps: 202 | Train Loss: 0.6903371 Vali Loss: 0.6939966 Vali AUC: 0.5111728
Validation loss decreased (0.698905 --> 0.693997).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6814660
	speed: 0.5583s/iter; left time: 10770.5875s
	iters: 200, epoch: 5 | loss: 0.6661994
	speed: 0.0315s/iter; left time: 605.2090s
Epoch: 5 cost time: 24.957671403884888
Epoch: 5, Steps: 202 | Train Loss: 0.6889243 Vali Loss: 0.7097029 Vali AUC: 0.5159619
EarlyStopping counter: 1 out of 25
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6946086
	speed: 0.5570s/iter; left time: 10634.0386s
	iters: 200, epoch: 6 | loss: 0.6883633
	speed: 0.0316s/iter; left time: 599.3199s
Epoch: 6 cost time: 24.969938039779663
Epoch: 6, Steps: 202 | Train Loss: 0.6891633 Vali Loss: 0.7048738 Vali AUC: 0.5289592
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7069573
	speed: 0.5571s/iter; left time: 10522.8068s
	iters: 200, epoch: 7 | loss: 0.6767472
	speed: 0.0315s/iter; left time: 592.3642s
Epoch: 7 cost time: 24.8817241191864
Epoch: 7, Steps: 202 | Train Loss: 0.6863917 Vali Loss: 0.7052350 Vali AUC: 0.5145216
EarlyStopping counter: 3 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6648822
	speed: 0.5576s/iter; left time: 10420.5612s
	iters: 200, epoch: 8 | loss: 0.6872889
	speed: 0.0316s/iter; left time: 586.9874s
Epoch: 8 cost time: 24.998422145843506
Epoch: 8, Steps: 202 | Train Loss: 0.6861031 Vali Loss: 0.7160880 Vali AUC: 0.5400977
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6681020
	speed: 0.5608s/iter; left time: 10367.1076s
	iters: 200, epoch: 9 | loss: 0.6663355
	speed: 0.0315s/iter; left time: 579.9970s
Epoch: 9 cost time: 25.073143243789673
Epoch: 9, Steps: 202 | Train Loss: 0.6866017 Vali Loss: 0.7061216 Vali AUC: 0.5311780
EarlyStopping counter: 5 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6687400
	speed: 0.5585s/iter; left time: 10210.5901s
	iters: 200, epoch: 10 | loss: 0.6935925
	speed: 0.0316s/iter; left time: 573.9662s
Epoch: 10 cost time: 25.009445190429688
Epoch: 10, Steps: 202 | Train Loss: 0.6852042 Vali Loss: 0.7122899 Vali AUC: 0.5321485
EarlyStopping counter: 6 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6998436
	speed: 0.5569s/iter; left time: 10069.7104s
	iters: 200, epoch: 11 | loss: 0.7010670
	speed: 0.0316s/iter; left time: 567.9149s
Epoch: 11 cost time: 24.971302032470703
Epoch: 11, Steps: 202 | Train Loss: 0.6825123 Vali Loss: 0.7090642 Vali AUC: 0.5322788
EarlyStopping counter: 7 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6831656
	speed: 0.5574s/iter; left time: 9964.9768s
	iters: 200, epoch: 12 | loss: 0.6931109
	speed: 0.0316s/iter; left time: 561.7935s
Epoch: 12 cost time: 25.004377126693726
Epoch: 12, Steps: 202 | Train Loss: 0.6827038 Vali Loss: 0.7059724 Vali AUC: 0.5327812
EarlyStopping counter: 8 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6820217
	speed: 0.5579s/iter; left time: 9862.5819s
	iters: 200, epoch: 13 | loss: 0.6781672
	speed: 0.0316s/iter; left time: 555.1728s
Epoch: 13 cost time: 24.964189767837524
Epoch: 13, Steps: 202 | Train Loss: 0.6814808 Vali Loss: 0.7142341 Vali AUC: 0.5203378
EarlyStopping counter: 9 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6864015
	speed: 0.5584s/iter; left time: 9758.4802s
	iters: 200, epoch: 14 | loss: 0.7119216
	speed: 0.0316s/iter; left time: 548.5504s
Epoch: 14 cost time: 24.94439435005188
Epoch: 14, Steps: 202 | Train Loss: 0.6792943 Vali Loss: 0.7126520 Vali AUC: 0.5212363
EarlyStopping counter: 10 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6486878
	speed: 0.5563s/iter; left time: 9609.7282s
	iters: 200, epoch: 15 | loss: 0.7366157
	speed: 0.0315s/iter; left time: 541.3465s
Epoch: 15 cost time: 25.041558265686035
Epoch: 15, Steps: 202 | Train Loss: 0.6777438 Vali Loss: 0.7085189 Vali AUC: 0.5228035
EarlyStopping counter: 11 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6769199
	speed: 0.5583s/iter; left time: 9529.9478s
	iters: 200, epoch: 16 | loss: 0.6892259
	speed: 0.0316s/iter; left time: 535.5757s
Epoch: 16 cost time: 24.929981231689453
Epoch: 16, Steps: 202 | Train Loss: 0.6744196 Vali Loss: 0.7102394 Vali AUC: 0.5336626
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6626574
	speed: 0.5614s/iter; left time: 9470.7164s
	iters: 200, epoch: 17 | loss: 0.6443214
	speed: 0.0315s/iter; left time: 528.9761s
Epoch: 17 cost time: 25.100631713867188
Epoch: 17, Steps: 202 | Train Loss: 0.6754208 Vali Loss: 0.7078562 Vali AUC: 0.5342644
EarlyStopping counter: 13 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6657104
	speed: 0.5605s/iter; left time: 9341.9791s
	iters: 200, epoch: 18 | loss: 0.6240340
	speed: 0.0316s/iter; left time: 523.2651s
Epoch: 18 cost time: 24.939223289489746
Epoch: 18, Steps: 202 | Train Loss: 0.6724835 Vali Loss: 0.7105020 Vali AUC: 0.5332990
EarlyStopping counter: 14 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6477630
	speed: 0.5614s/iter; left time: 9243.7426s
	iters: 200, epoch: 19 | loss: 0.6864328
	speed: 0.0315s/iter; left time: 515.9168s
Epoch: 19 cost time: 25.173871517181396
Epoch: 19, Steps: 202 | Train Loss: 0.6708900 Vali Loss: 0.7067027 Vali AUC: 0.5332356
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6803360
	speed: 0.5598s/iter; left time: 9104.1203s
	iters: 200, epoch: 20 | loss: 0.6614676
	speed: 0.0316s/iter; left time: 510.2541s
Epoch: 20 cost time: 25.02845549583435
Epoch: 20, Steps: 202 | Train Loss: 0.6708947 Vali Loss: 0.7080080 Vali AUC: 0.5332082
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6862451
	speed: 0.5581s/iter; left time: 8964.1819s
	iters: 200, epoch: 21 | loss: 0.6375737
	speed: 0.0316s/iter; left time: 503.6943s
Epoch: 21 cost time: 25.032772302627563
Epoch: 21, Steps: 202 | Train Loss: 0.6694235 Vali Loss: 0.7086755 Vali AUC: 0.5322617
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6857921
	speed: 0.5587s/iter; left time: 8859.9776s
	iters: 200, epoch: 22 | loss: 0.7304528
	speed: 0.0316s/iter; left time: 497.3761s
Epoch: 22 cost time: 24.960804224014282
Epoch: 22, Steps: 202 | Train Loss: 0.6680667 Vali Loss: 0.7101239 Vali AUC: 0.5335802
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6982554
	speed: 0.5603s/iter; left time: 8772.6509s
	iters: 200, epoch: 23 | loss: 0.6834357
	speed: 0.0315s/iter; left time: 490.5790s
Epoch: 23 cost time: 25.046162843704224
Epoch: 23, Steps: 202 | Train Loss: 0.6668609 Vali Loss: 0.7098428 Vali AUC: 0.5307630
EarlyStopping counter: 19 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.7073799
	speed: 0.5575s/iter; left time: 8616.5582s
	iters: 200, epoch: 24 | loss: 0.6820449
	speed: 0.0316s/iter; left time: 484.5075s
Epoch: 24 cost time: 25.001564264297485
Epoch: 24, Steps: 202 | Train Loss: 0.6663728 Vali Loss: 0.7119919 Vali AUC: 0.5335511
EarlyStopping counter: 20 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6739973
	speed: 0.5587s/iter; left time: 8521.2356s
	iters: 200, epoch: 25 | loss: 0.6698245
	speed: 0.0316s/iter; left time: 479.2785s
Epoch: 25 cost time: 24.927013874053955
Epoch: 25, Steps: 202 | Train Loss: 0.6650924 Vali Loss: 0.7116202 Vali AUC: 0.5323028
EarlyStopping counter: 21 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6768720
	speed: 0.5592s/iter; left time: 8415.8428s
	iters: 200, epoch: 26 | loss: 0.6333358
	speed: 0.0316s/iter; left time: 472.0770s
Epoch: 26 cost time: 25.068439483642578
Epoch: 26, Steps: 202 | Train Loss: 0.6621824 Vali Loss: 0.7111776 Vali AUC: 0.5338392
EarlyStopping counter: 22 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6477377
	speed: 0.5569s/iter; left time: 8269.9886s
	iters: 200, epoch: 27 | loss: 0.6322036
	speed: 0.0316s/iter; left time: 465.6590s
Epoch: 27 cost time: 25.071980953216553
Epoch: 27, Steps: 202 | Train Loss: 0.6621194 Vali Loss: 0.7089932 Vali AUC: 0.5341169
EarlyStopping counter: 23 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6412292
	speed: 0.5570s/iter; left time: 8158.9367s
	iters: 200, epoch: 28 | loss: 0.6508703
	speed: 0.0315s/iter; left time: 458.7243s
Epoch: 28 cost time: 24.910942792892456
Epoch: 28, Steps: 202 | Train Loss: 0.6621600 Vali Loss: 0.7117870 Vali AUC: 0.5338409
EarlyStopping counter: 24 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6591789
	speed: 0.5601s/iter; left time: 8090.0778s
	iters: 200, epoch: 29 | loss: 0.6344132
	speed: 0.0316s/iter; left time: 452.7303s
Epoch: 29 cost time: 24.921243906021118
Epoch: 29, Steps: 202 | Train Loss: 0.6608078 Vali Loss: 0.7146230 Vali AUC: 0.5336540
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1080
Accuracy: 0.5351851851851852, AUC: 0.5111728395061729, Sensitivity: 0.1574074074074074, Specificity: 0.912962962962963, PPV: 0.6439393939393939, NPV: 0.520042194092827, F1: 0.25297619047619047
