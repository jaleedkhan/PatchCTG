Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_2', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9680
Dataset loaded and preprocessed.
val set size: 1076
Dataset loaded and preprocessed.
test set size: 1076
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
All layers except the classification head are frozen for linear probing.
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1076
loading model
Accuracy: 0.516728624535316, AUC: 0.4923784911761861, Sensitivity: 0.31970260223048325, Specificity: 0.7137546468401487, PPV: 0.5276073619631901, NPV: 0.512, F1: 0.3981481481481481
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.7887033
	speed: 0.1710s/iter; left time: 3437.4713s
	iters: 200, epoch: 1 | loss: 0.7175481
	speed: 0.0138s/iter; left time: 276.9710s
Epoch: 1 cost time: 19.57676362991333
Epoch: 1, Steps: 202 | Train Loss: 0.7191008 Vali Loss: 0.7193785 Vali AUC: 0.4903176
Validation loss decreased (inf --> 0.719378).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7403669
	speed: 0.4840s/iter; left time: 9631.5888s
	iters: 200, epoch: 2 | loss: 0.7632124
	speed: 0.0138s/iter; left time: 272.3620s
Epoch: 2 cost time: 19.52811360359192
Epoch: 2, Steps: 202 | Train Loss: 0.7189288 Vali Loss: 0.7211860 Vali AUC: 0.4880184
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6278027
	speed: 0.4837s/iter; left time: 9527.2215s
	iters: 200, epoch: 3 | loss: 0.7281432
	speed: 0.0137s/iter; left time: 268.8289s
Epoch: 3 cost time: 19.532508611679077
Epoch: 3, Steps: 202 | Train Loss: 0.7175775 Vali Loss: 0.7199839 Vali AUC: 0.4887077
EarlyStopping counter: 2 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7663626
	speed: 0.4845s/iter; left time: 9445.9299s
	iters: 200, epoch: 4 | loss: 0.6972501
	speed: 0.0138s/iter; left time: 268.1040s
Epoch: 4 cost time: 19.51734948158264
Epoch: 4, Steps: 202 | Train Loss: 0.7163583 Vali Loss: 0.7205716 Vali AUC: 0.4886006
EarlyStopping counter: 3 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6973447
	speed: 0.4852s/iter; left time: 9361.6946s
	iters: 200, epoch: 5 | loss: 0.6766108
	speed: 0.0137s/iter; left time: 263.7470s
Epoch: 5 cost time: 19.626542329788208
Epoch: 5, Steps: 202 | Train Loss: 0.7184256 Vali Loss: 0.7161008 Vali AUC: 0.4912401
Validation loss decreased (0.719378 --> 0.716101).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.7377603
	speed: 0.4848s/iter; left time: 9255.3150s
	iters: 200, epoch: 6 | loss: 0.6755316
	speed: 0.0136s/iter; left time: 257.9140s
Epoch: 6 cost time: 19.57738161087036
Epoch: 6, Steps: 202 | Train Loss: 0.7186019 Vali Loss: 0.7176536 Vali AUC: 0.4904127
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6681756
	speed: 0.4841s/iter; left time: 9143.4368s
	iters: 200, epoch: 7 | loss: 0.6938977
	speed: 0.0137s/iter; left time: 258.1938s
Epoch: 7 cost time: 19.528754472732544
Epoch: 7, Steps: 202 | Train Loss: 0.7184961 Vali Loss: 0.7182367 Vali AUC: 0.4903401
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6035806
	speed: 0.4856s/iter; left time: 9073.6746s
	iters: 200, epoch: 8 | loss: 0.6801009
	speed: 0.0138s/iter; left time: 255.6030s
Epoch: 8 cost time: 19.57778811454773
Epoch: 8, Steps: 202 | Train Loss: 0.7180269 Vali Loss: 0.7157761 Vali AUC: 0.4913904
Validation loss decreased (0.716101 --> 0.715776).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7464471
	speed: 0.4847s/iter; left time: 8960.5167s
	iters: 200, epoch: 9 | loss: 0.7313670
	speed: 0.0138s/iter; left time: 252.8737s
Epoch: 9 cost time: 19.514691591262817
Epoch: 9, Steps: 202 | Train Loss: 0.7187452 Vali Loss: 0.7201033 Vali AUC: 0.4894073
EarlyStopping counter: 1 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7720990
	speed: 0.4844s/iter; left time: 8856.5067s
	iters: 200, epoch: 10 | loss: 0.7072704
	speed: 0.0137s/iter; left time: 249.7023s
Epoch: 10 cost time: 19.54904866218567
Epoch: 10, Steps: 202 | Train Loss: 0.7183095 Vali Loss: 0.7168936 Vali AUC: 0.4914906
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7734606
	speed: 0.4829s/iter; left time: 8731.3466s
	iters: 200, epoch: 11 | loss: 0.7336167
	speed: 0.0139s/iter; left time: 249.9607s
Epoch: 11 cost time: 19.50185990333557
Epoch: 11, Steps: 202 | Train Loss: 0.7189684 Vali Loss: 0.7179255 Vali AUC: 0.4897320
EarlyStopping counter: 3 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6778234
	speed: 0.4829s/iter; left time: 8633.4632s
	iters: 200, epoch: 12 | loss: 0.7511548
	speed: 0.0138s/iter; left time: 245.3441s
Epoch: 12 cost time: 19.49517583847046
Epoch: 12, Steps: 202 | Train Loss: 0.7172454 Vali Loss: 0.7177543 Vali AUC: 0.4890929
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7055027
	speed: 0.4823s/iter; left time: 8524.9100s
	iters: 200, epoch: 13 | loss: 0.8501138
	speed: 0.0138s/iter; left time: 242.7316s
Epoch: 13 cost time: 19.53760576248169
Epoch: 13, Steps: 202 | Train Loss: 0.7185805 Vali Loss: 0.7176597 Vali AUC: 0.4899272
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7603638
	speed: 0.4853s/iter; left time: 8480.4924s
	iters: 200, epoch: 14 | loss: 0.7025490
	speed: 0.0137s/iter; left time: 238.5414s
Epoch: 14 cost time: 19.522783994674683
Epoch: 14, Steps: 202 | Train Loss: 0.7182094 Vali Loss: 0.7165389 Vali AUC: 0.4905025
EarlyStopping counter: 6 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7460958
	speed: 0.4839s/iter; left time: 8357.7384s
	iters: 200, epoch: 15 | loss: 0.7034445
	speed: 0.0138s/iter; left time: 236.3647s
Epoch: 15 cost time: 19.65989899635315
Epoch: 15, Steps: 202 | Train Loss: 0.7184362 Vali Loss: 0.7198728 Vali AUC: 0.4891862
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6499938
	speed: 0.4862s/iter; left time: 8299.8197s
	iters: 200, epoch: 16 | loss: 0.7081692
	speed: 0.0138s/iter; left time: 233.6150s
Epoch: 16 cost time: 19.590463399887085
Epoch: 16, Steps: 202 | Train Loss: 0.7173489 Vali Loss: 0.7168225 Vali AUC: 0.4906960
EarlyStopping counter: 8 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6993287
	speed: 0.4844s/iter; left time: 8171.6282s
	iters: 200, epoch: 17 | loss: 0.7929630
	speed: 0.0137s/iter; left time: 229.8788s
Epoch: 17 cost time: 19.51553463935852
Epoch: 17, Steps: 202 | Train Loss: 0.7191048 Vali Loss: 0.7190114 Vali AUC: 0.4899186
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.7638502
	speed: 0.4847s/iter; left time: 8079.1694s
	iters: 200, epoch: 18 | loss: 0.7583229
	speed: 0.0138s/iter; left time: 228.1109s
Epoch: 18 cost time: 19.614337921142578
Epoch: 18, Steps: 202 | Train Loss: 0.7179097 Vali Loss: 0.7169134 Vali AUC: 0.4911347
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6954088
	speed: 0.4848s/iter; left time: 7982.6565s
	iters: 200, epoch: 19 | loss: 0.7208645
	speed: 0.0138s/iter; left time: 225.4342s
Epoch: 19 cost time: 19.612695455551147
Epoch: 19, Steps: 202 | Train Loss: 0.7189469 Vali Loss: 0.7158201 Vali AUC: 0.4912591
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.7796947
	speed: 0.4846s/iter; left time: 7881.5139s
	iters: 200, epoch: 20 | loss: 0.7467248
	speed: 0.0138s/iter; left time: 222.5934s
Epoch: 20 cost time: 19.501524925231934
Epoch: 20, Steps: 202 | Train Loss: 0.7178808 Vali Loss: 0.7167112 Vali AUC: 0.4895144
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6992553
	speed: 0.4836s/iter; left time: 7766.5450s
	iters: 200, epoch: 21 | loss: 0.6887450
	speed: 0.0138s/iter; left time: 220.4130s
Epoch: 21 cost time: 19.619631052017212
Epoch: 21, Steps: 202 | Train Loss: 0.7176968 Vali Loss: 0.7178440 Vali AUC: 0.4901328
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.8056084
	speed: 0.4849s/iter; left time: 7690.6376s
	iters: 200, epoch: 22 | loss: 0.6844648
	speed: 0.0138s/iter; left time: 217.0687s
Epoch: 22 cost time: 19.626224756240845
Epoch: 22, Steps: 202 | Train Loss: 0.7185247 Vali Loss: 0.7218188 Vali AUC: 0.4894971
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.7643015
	speed: 0.4863s/iter; left time: 7614.6612s
	iters: 200, epoch: 23 | loss: 0.6683285
	speed: 0.0137s/iter; left time: 213.1262s
Epoch: 23 cost time: 19.69997787475586
Epoch: 23, Steps: 202 | Train Loss: 0.7168421 Vali Loss: 0.7132804 Vali AUC: 0.4918533
Validation loss decreased (0.715776 --> 0.713280).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.7630773
	speed: 0.4869s/iter; left time: 7525.0846s
	iters: 200, epoch: 24 | loss: 0.6769909
	speed: 0.0138s/iter; left time: 212.0563s
Epoch: 24 cost time: 19.574442863464355
Epoch: 24, Steps: 202 | Train Loss: 0.7192791 Vali Loss: 0.7156671 Vali AUC: 0.4908825
EarlyStopping counter: 1 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.7395605
	speed: 0.4858s/iter; left time: 7409.2031s
	iters: 200, epoch: 25 | loss: 0.7694736
	speed: 0.0138s/iter; left time: 208.4364s
Epoch: 25 cost time: 19.562899589538574
Epoch: 25, Steps: 202 | Train Loss: 0.7195525 Vali Loss: 0.7174065 Vali AUC: 0.4908704
EarlyStopping counter: 2 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.7746055
	speed: 0.4856s/iter; left time: 7309.4517s
	iters: 200, epoch: 26 | loss: 0.6416343
	speed: 0.0138s/iter; left time: 205.6519s
Epoch: 26 cost time: 19.71846652030945
Epoch: 26, Steps: 202 | Train Loss: 0.7183478 Vali Loss: 0.7167057 Vali AUC: 0.4905491
EarlyStopping counter: 3 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.7270479
	speed: 0.4864s/iter; left time: 7222.0231s
	iters: 200, epoch: 27 | loss: 0.7174623
	speed: 0.0137s/iter; left time: 201.5924s
Epoch: 27 cost time: 19.5058856010437
Epoch: 27, Steps: 202 | Train Loss: 0.7200675 Vali Loss: 0.7199520 Vali AUC: 0.4901864
EarlyStopping counter: 4 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.7889481
	speed: 0.4848s/iter; left time: 7100.5720s
	iters: 200, epoch: 28 | loss: 0.7293599
	speed: 0.0138s/iter; left time: 200.4529s
Epoch: 28 cost time: 19.587859392166138
Epoch: 28, Steps: 202 | Train Loss: 0.7165750 Vali Loss: 0.7171189 Vali AUC: 0.4905163
EarlyStopping counter: 5 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6832689
	speed: 0.4848s/iter; left time: 7003.4514s
	iters: 200, epoch: 29 | loss: 0.6804274
	speed: 0.0137s/iter; left time: 196.9571s
Epoch: 29 cost time: 19.63899803161621
Epoch: 29, Steps: 202 | Train Loss: 0.7179607 Vali Loss: 0.7182078 Vali AUC: 0.4897873
EarlyStopping counter: 6 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6465185
	speed: 0.4857s/iter; left time: 6917.8900s
	iters: 200, epoch: 30 | loss: 0.7699020
	speed: 0.0138s/iter; left time: 195.2766s
Epoch: 30 cost time: 19.628714084625244
Epoch: 30, Steps: 202 | Train Loss: 0.7172603 Vali Loss: 0.7154264 Vali AUC: 0.4906372
EarlyStopping counter: 7 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.7317209
	speed: 0.4846s/iter; left time: 6803.5723s
	iters: 200, epoch: 31 | loss: 0.7132517
	speed: 0.0136s/iter; left time: 189.3467s
Epoch: 31 cost time: 19.519097805023193
Epoch: 31, Steps: 202 | Train Loss: 0.7186437 Vali Loss: 0.7130641 Vali AUC: 0.4933390
Validation loss decreased (0.713280 --> 0.713064).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6997747
	speed: 0.4851s/iter; left time: 6712.6458s
	iters: 200, epoch: 32 | loss: 0.6832959
	speed: 0.0138s/iter; left time: 188.9725s
Epoch: 32 cost time: 19.57901406288147
Epoch: 32, Steps: 202 | Train Loss: 0.7189508 Vali Loss: 0.7139706 Vali AUC: 0.4914422
EarlyStopping counter: 1 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6821386
	speed: 0.4844s/iter; left time: 6606.2923s
	iters: 200, epoch: 33 | loss: 0.6934544
	speed: 0.0138s/iter; left time: 187.0283s
Epoch: 33 cost time: 19.508541107177734
Epoch: 33, Steps: 202 | Train Loss: 0.7170227 Vali Loss: 0.7152495 Vali AUC: 0.4906752
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.6610311
	speed: 0.4841s/iter; left time: 6503.8601s
	iters: 200, epoch: 34 | loss: 0.7359122
	speed: 0.0138s/iter; left time: 183.8857s
Epoch: 34 cost time: 19.5950710773468
Epoch: 34, Steps: 202 | Train Loss: 0.7194216 Vali Loss: 0.7170153 Vali AUC: 0.4909758
EarlyStopping counter: 3 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.7676709
	speed: 0.4849s/iter; left time: 6416.5930s
	iters: 200, epoch: 35 | loss: 0.7169976
	speed: 0.0137s/iter; left time: 179.3275s
Epoch: 35 cost time: 19.56536054611206
Epoch: 35, Steps: 202 | Train Loss: 0.7202212 Vali Loss: 0.7173076 Vali AUC: 0.4901535
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.7196299
	speed: 0.4859s/iter; left time: 6331.9501s
	iters: 200, epoch: 36 | loss: 0.7558180
	speed: 0.0137s/iter; left time: 177.1088s
Epoch: 36 cost time: 19.654725313186646
Epoch: 36, Steps: 202 | Train Loss: 0.7178895 Vali Loss: 0.7172578 Vali AUC: 0.4904213
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.7352176
	speed: 0.4854s/iter; left time: 6227.8058s
	iters: 200, epoch: 37 | loss: 0.7250878
	speed: 0.0136s/iter; left time: 173.7369s
Epoch: 37 cost time: 19.525044918060303
Epoch: 37, Steps: 202 | Train Loss: 0.7187143 Vali Loss: 0.7157101 Vali AUC: 0.4911624
EarlyStopping counter: 6 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6839806
	speed: 0.4841s/iter; left time: 6112.8231s
	iters: 200, epoch: 38 | loss: 0.7178304
	speed: 0.0138s/iter; left time: 172.7379s
Epoch: 38 cost time: 19.715308904647827
Epoch: 38, Steps: 202 | Train Loss: 0.7178138 Vali Loss: 0.7192503 Vali AUC: 0.4894246
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.6998059
	speed: 0.4845s/iter; left time: 6019.7536s
	iters: 200, epoch: 39 | loss: 0.7165737
	speed: 0.0137s/iter; left time: 169.1497s
Epoch: 39 cost time: 19.512362718582153
Epoch: 39, Steps: 202 | Train Loss: 0.7186384 Vali Loss: 0.7185984 Vali AUC: 0.4904990
EarlyStopping counter: 8 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7106317
	speed: 0.4852s/iter; left time: 5931.0394s
	iters: 200, epoch: 40 | loss: 0.7325508
	speed: 0.0137s/iter; left time: 166.0687s
Epoch: 40 cost time: 19.55886697769165
Epoch: 40, Steps: 202 | Train Loss: 0.7177361 Vali Loss: 0.7181700 Vali AUC: 0.4899946
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.6952204
	speed: 0.4861s/iter; left time: 5843.0890s
	iters: 200, epoch: 41 | loss: 0.6677651
	speed: 0.0137s/iter; left time: 162.8521s
Epoch: 41 cost time: 19.549248695373535
Epoch: 41, Steps: 202 | Train Loss: 0.7172894 Vali Loss: 0.7161388 Vali AUC: 0.4915735
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.6572788
	speed: 0.4850s/iter; left time: 5732.3804s
	iters: 200, epoch: 42 | loss: 0.6777558
	speed: 0.0136s/iter; left time: 159.8951s
Epoch: 42 cost time: 19.677481174468994
Epoch: 42, Steps: 202 | Train Loss: 0.7166720 Vali Loss: 0.7180213 Vali AUC: 0.4888649
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.6991085
	speed: 0.4860s/iter; left time: 5646.2609s
	iters: 200, epoch: 43 | loss: 0.7660677
	speed: 0.0137s/iter; left time: 158.2511s
Epoch: 43 cost time: 19.5971519947052
Epoch: 43, Steps: 202 | Train Loss: 0.7181341 Vali Loss: 0.7170465 Vali AUC: 0.4898167
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.7013849
	speed: 0.4854s/iter; left time: 5540.9647s
	iters: 200, epoch: 44 | loss: 0.7241740
	speed: 0.0137s/iter; left time: 155.2882s
Epoch: 44 cost time: 19.63288402557373
Epoch: 44, Steps: 202 | Train Loss: 0.7176304 Vali Loss: 0.7162075 Vali AUC: 0.4909171
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.7376347
	speed: 0.4855s/iter; left time: 5444.2607s
	iters: 200, epoch: 45 | loss: 0.6995295
	speed: 0.0136s/iter; left time: 151.4597s
Epoch: 45 cost time: 19.608803272247314
Epoch: 45, Steps: 202 | Train Loss: 0.7181867 Vali Loss: 0.7173079 Vali AUC: 0.4920416
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.7271466
	speed: 0.4848s/iter; left time: 5338.0464s
	iters: 200, epoch: 46 | loss: 0.6802056
	speed: 0.0137s/iter; left time: 149.3396s
Epoch: 46 cost time: 19.54100799560547
Epoch: 46, Steps: 202 | Train Loss: 0.7176905 Vali Loss: 0.7177534 Vali AUC: 0.4906165
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.7892417
	speed: 0.4842s/iter; left time: 5234.0621s
	iters: 200, epoch: 47 | loss: 0.7384560
	speed: 0.0137s/iter; left time: 146.7146s
Epoch: 47 cost time: 19.665557622909546
Epoch: 47, Steps: 202 | Train Loss: 0.7176544 Vali Loss: 0.7146321 Vali AUC: 0.4918810
EarlyStopping counter: 16 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.7768954
	speed: 0.4864s/iter; left time: 5159.0775s
	iters: 200, epoch: 48 | loss: 0.7044460
	speed: 0.0137s/iter; left time: 144.2968s
Epoch: 48 cost time: 19.545800924301147
Epoch: 48, Steps: 202 | Train Loss: 0.7191666 Vali Loss: 0.7162325 Vali AUC: 0.4902917
EarlyStopping counter: 17 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.7736959
	speed: 0.4844s/iter; left time: 5039.9044s
	iters: 200, epoch: 49 | loss: 0.7016743
	speed: 0.0138s/iter; left time: 141.8704s
Epoch: 49 cost time: 19.583824396133423
Epoch: 49, Steps: 202 | Train Loss: 0.7172493 Vali Loss: 0.7212491 Vali AUC: 0.4896059
EarlyStopping counter: 18 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.6613519
	speed: 0.4859s/iter; left time: 4957.5732s
	iters: 200, epoch: 50 | loss: 0.7324852
	speed: 0.0136s/iter; left time: 137.8176s
Epoch: 50 cost time: 19.631452083587646
Epoch: 50, Steps: 202 | Train Loss: 0.7183550 Vali Loss: 0.7196835 Vali AUC: 0.4898944
EarlyStopping counter: 19 out of 25
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.6779992
	speed: 0.4867s/iter; left time: 4867.5768s
	iters: 200, epoch: 51 | loss: 0.6792854
	speed: 0.0137s/iter; left time: 136.0383s
Epoch: 51 cost time: 19.556971549987793
Epoch: 51, Steps: 202 | Train Loss: 0.7188788 Vali Loss: 0.7176301 Vali AUC: 0.4902848
EarlyStopping counter: 20 out of 25
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.6932260
	speed: 0.4843s/iter; left time: 4745.3254s
	iters: 200, epoch: 52 | loss: 0.7172281
	speed: 0.0137s/iter; left time: 132.9902s
Epoch: 52 cost time: 19.57342267036438
Epoch: 52, Steps: 202 | Train Loss: 0.7170764 Vali Loss: 0.7216478 Vali AUC: 0.4879407
EarlyStopping counter: 21 out of 25
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.7165741
	speed: 0.4856s/iter; left time: 4660.5866s
	iters: 200, epoch: 53 | loss: 0.7244347
	speed: 0.0138s/iter; left time: 131.0008s
Epoch: 53 cost time: 19.51777410507202
Epoch: 53, Steps: 202 | Train Loss: 0.7190163 Vali Loss: 0.7150075 Vali AUC: 0.4918015
EarlyStopping counter: 22 out of 25
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.6477749
	speed: 0.4859s/iter; left time: 4564.5851s
	iters: 200, epoch: 54 | loss: 0.7600033
	speed: 0.0137s/iter; left time: 127.3969s
Epoch: 54 cost time: 19.57664394378662
Epoch: 54, Steps: 202 | Train Loss: 0.7196869 Vali Loss: 0.7193834 Vali AUC: 0.4896837
EarlyStopping counter: 23 out of 25
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.7175510
	speed: 0.4849s/iter; left time: 4457.8119s
	iters: 200, epoch: 55 | loss: 0.6338887
	speed: 0.0136s/iter; left time: 123.7077s
Epoch: 55 cost time: 19.522380590438843
Epoch: 55, Steps: 202 | Train Loss: 0.7178607 Vali Loss: 0.7159891 Vali AUC: 0.4918257
EarlyStopping counter: 24 out of 25
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.7087334
	speed: 0.4851s/iter; left time: 4361.2789s
	iters: 200, epoch: 56 | loss: 0.6704401
	speed: 0.0138s/iter; left time: 122.3422s
Epoch: 56 cost time: 19.56203842163086
Epoch: 56, Steps: 202 | Train Loss: 0.7173145 Vali Loss: 0.7170319 Vali AUC: 0.4904731
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1076
Accuracy: 0.516728624535316, AUC: 0.49333895330357513, Sensitivity: 0.3215613382899628, Specificity: 0.7118959107806692, PPV: 0.5274390243902439, NPV: 0.5120320855614974, F1: 0.39953810623556585
