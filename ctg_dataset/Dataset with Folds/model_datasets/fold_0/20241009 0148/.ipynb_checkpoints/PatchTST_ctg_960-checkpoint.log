Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_0', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9682
Dataset loaded and preprocessed.
val set size: 1074
Dataset loaded and preprocessed.
test set size: 1074
	iters: 100, epoch: 1 | loss: 0.7727183
	speed: 0.2095s/iter; left time: 4210.4939s
	iters: 200, epoch: 1 | loss: 0.6884431
	speed: 0.0316s/iter; left time: 632.7305s
Epoch: 1 cost time: 25.30076265335083
Epoch: 1, Steps: 202 | Train Loss: 0.7249324 Vali Loss: 0.7187315 Vali AUC: 0.4932413
Validation loss decreased (inf --> 0.718732).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7374245
	speed: 0.5551s/iter; left time: 11045.7441s
	iters: 200, epoch: 2 | loss: 0.6709501
	speed: 0.0317s/iter; left time: 627.6086s
Epoch: 2 cost time: 24.84833073616028
Epoch: 2, Steps: 202 | Train Loss: 0.7031263 Vali Loss: 0.6986448 Vali AUC: 0.5242918
Validation loss decreased (0.718732 --> 0.698645).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7173211
	speed: 0.5540s/iter; left time: 10912.2779s
	iters: 200, epoch: 3 | loss: 0.7037131
	speed: 0.0317s/iter; left time: 620.8408s
Epoch: 3 cost time: 24.917577505111694
Epoch: 3, Steps: 202 | Train Loss: 0.6956851 Vali Loss: 0.7004628 Vali AUC: 0.5162847
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6741990
	speed: 0.5551s/iter; left time: 10822.1722s
	iters: 200, epoch: 4 | loss: 0.6645200
	speed: 0.0317s/iter; left time: 614.5107s
Epoch: 4 cost time: 24.79403018951416
Epoch: 4, Steps: 202 | Train Loss: 0.6911530 Vali Loss: 0.7023703 Vali AUC: 0.5275827
EarlyStopping counter: 2 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7002363
	speed: 0.5582s/iter; left time: 10769.7436s
	iters: 200, epoch: 5 | loss: 0.7061140
	speed: 0.0317s/iter; left time: 608.0580s
Epoch: 5 cost time: 24.999140739440918
Epoch: 5, Steps: 202 | Train Loss: 0.6902021 Vali Loss: 0.6960778 Vali AUC: 0.5231249
Validation loss decreased (0.698645 --> 0.696078).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6981620
	speed: 0.5595s/iter; left time: 10680.7718s
	iters: 200, epoch: 6 | loss: 0.6896436
	speed: 0.0316s/iter; left time: 600.7314s
Epoch: 6 cost time: 25.015002727508545
Epoch: 6, Steps: 202 | Train Loss: 0.6897667 Vali Loss: 0.6978853 Vali AUC: 0.5374312
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7077996
	speed: 0.5571s/iter; left time: 10522.8010s
	iters: 200, epoch: 7 | loss: 0.6774325
	speed: 0.0316s/iter; left time: 594.5048s
Epoch: 7 cost time: 24.8202805519104
Epoch: 7, Steps: 202 | Train Loss: 0.6874832 Vali Loss: 0.7022615 Vali AUC: 0.5368746
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.7077618
	speed: 0.5518s/iter; left time: 10312.1053s
	iters: 200, epoch: 8 | loss: 0.6877725
	speed: 0.0317s/iter; left time: 588.7594s
Epoch: 8 cost time: 24.840187311172485
Epoch: 8, Steps: 202 | Train Loss: 0.6864797 Vali Loss: 0.7173925 Vali AUC: 0.5324047
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6683105
	speed: 0.5546s/iter; left time: 10252.0915s
	iters: 200, epoch: 9 | loss: 0.7037668
	speed: 0.0317s/iter; left time: 582.3440s
Epoch: 9 cost time: 24.85904312133789
Epoch: 9, Steps: 202 | Train Loss: 0.6851835 Vali Loss: 0.7026532 Vali AUC: 0.5346344
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6814303
	speed: 0.5552s/iter; left time: 10151.1823s
	iters: 200, epoch: 10 | loss: 0.6801142
	speed: 0.0317s/iter; left time: 576.0045s
Epoch: 10 cost time: 24.882770776748657
Epoch: 10, Steps: 202 | Train Loss: 0.6829815 Vali Loss: 0.7023528 Vali AUC: 0.5337016
EarlyStopping counter: 5 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7106681
	speed: 0.5551s/iter; left time: 10036.7696s
	iters: 200, epoch: 11 | loss: 0.6857616
	speed: 0.0317s/iter; left time: 569.2109s
Epoch: 11 cost time: 24.890677452087402
Epoch: 11, Steps: 202 | Train Loss: 0.6831227 Vali Loss: 0.7065854 Vali AUC: 0.5360909
EarlyStopping counter: 6 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6550850
	speed: 0.5552s/iter; left time: 9926.1187s
	iters: 200, epoch: 12 | loss: 0.6911294
	speed: 0.0317s/iter; left time: 563.0597s
Epoch: 12 cost time: 24.876172304153442
Epoch: 12, Steps: 202 | Train Loss: 0.6825524 Vali Loss: 0.7063467 Vali AUC: 0.5345425
EarlyStopping counter: 7 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6600348
	speed: 0.5562s/iter; left time: 9831.1811s
	iters: 200, epoch: 13 | loss: 0.7021858
	speed: 0.0327s/iter; left time: 574.1839s
Epoch: 13 cost time: 25.00369644165039
Epoch: 13, Steps: 202 | Train Loss: 0.6817759 Vali Loss: 0.7034317 Vali AUC: 0.5312430
EarlyStopping counter: 8 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6481810
	speed: 0.5579s/iter; left time: 9750.1373s
	iters: 200, epoch: 14 | loss: 0.6912279
	speed: 0.0323s/iter; left time: 561.4254s
Epoch: 14 cost time: 25.142380237579346
Epoch: 14, Steps: 202 | Train Loss: 0.6795610 Vali Loss: 0.7095231 Vali AUC: 0.5360354
EarlyStopping counter: 9 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6614322
	speed: 0.5599s/iter; left time: 9671.4666s
	iters: 200, epoch: 15 | loss: 0.6991610
	speed: 0.0317s/iter; left time: 544.3580s
Epoch: 15 cost time: 25.006431818008423
Epoch: 15, Steps: 202 | Train Loss: 0.6773253 Vali Loss: 0.7091244 Vali AUC: 0.5379063
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6575047
	speed: 0.5553s/iter; left time: 9479.5512s
	iters: 200, epoch: 16 | loss: 0.6581393
	speed: 0.0317s/iter; left time: 537.1962s
Epoch: 16 cost time: 24.819236755371094
Epoch: 16, Steps: 202 | Train Loss: 0.6775853 Vali Loss: 0.7058801 Vali AUC: 0.5327445
EarlyStopping counter: 11 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6666257
	speed: 0.5536s/iter; left time: 9338.8554s
	iters: 200, epoch: 17 | loss: 0.6544613
	speed: 0.0317s/iter; left time: 531.2604s
Epoch: 17 cost time: 24.882354974746704
Epoch: 17, Steps: 202 | Train Loss: 0.6742805 Vali Loss: 0.7057741 Vali AUC: 0.5348668
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6583933
	speed: 0.5541s/iter; left time: 9234.8826s
	iters: 200, epoch: 18 | loss: 0.6803018
	speed: 0.0317s/iter; left time: 525.0596s
Epoch: 18 cost time: 24.88295817375183
Epoch: 18, Steps: 202 | Train Loss: 0.6730505 Vali Loss: 0.7059329 Vali AUC: 0.5374208
EarlyStopping counter: 13 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6880258
	speed: 0.5544s/iter; left time: 9127.6768s
	iters: 200, epoch: 19 | loss: 0.6840967
	speed: 0.0317s/iter; left time: 518.5938s
Epoch: 19 cost time: 24.895591497421265
Epoch: 19, Steps: 202 | Train Loss: 0.6721308 Vali Loss: 0.7058013 Vali AUC: 0.5383103
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.7063020
	speed: 0.5580s/iter; left time: 9074.7789s
	iters: 200, epoch: 20 | loss: 0.6571165
	speed: 0.0317s/iter; left time: 512.2753s
Epoch: 20 cost time: 25.038123846054077
Epoch: 20, Steps: 202 | Train Loss: 0.6695685 Vali Loss: 0.7121491 Vali AUC: 0.5400893
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6982245
	speed: 0.5569s/iter; left time: 8944.8443s
	iters: 200, epoch: 21 | loss: 0.6748333
	speed: 0.0317s/iter; left time: 505.8076s
Epoch: 21 cost time: 24.88099765777588
Epoch: 21, Steps: 202 | Train Loss: 0.6686477 Vali Loss: 0.7112717 Vali AUC: 0.5363666
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6978971
	speed: 0.5545s/iter; left time: 8793.1612s
	iters: 200, epoch: 22 | loss: 0.7000337
	speed: 0.0317s/iter; left time: 498.8475s
Epoch: 22 cost time: 24.903387308120728
Epoch: 22, Steps: 202 | Train Loss: 0.6684668 Vali Loss: 0.7101401 Vali AUC: 0.5370896
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6446792
	speed: 0.5560s/iter; left time: 8705.8059s
	iters: 200, epoch: 23 | loss: 0.6285229
	speed: 0.0317s/iter; left time: 493.1641s
Epoch: 23 cost time: 25.002347230911255
Epoch: 23, Steps: 202 | Train Loss: 0.6647149 Vali Loss: 0.7107266 Vali AUC: 0.5403892
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6696806
	speed: 0.5544s/iter; left time: 8567.7566s
	iters: 200, epoch: 24 | loss: 0.6573743
	speed: 0.0317s/iter; left time: 486.7850s
Epoch: 24 cost time: 24.87145972251892
Epoch: 24, Steps: 202 | Train Loss: 0.6652822 Vali Loss: 0.7096395 Vali AUC: 0.5322451
EarlyStopping counter: 19 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6833955
	speed: 0.5556s/iter; left time: 8474.0944s
	iters: 200, epoch: 25 | loss: 0.7119214
	speed: 0.0317s/iter; left time: 479.9147s
Epoch: 25 cost time: 24.899860858917236
Epoch: 25, Steps: 202 | Train Loss: 0.6637495 Vali Loss: 0.7125877 Vali AUC: 0.5371677
EarlyStopping counter: 20 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6624079
	speed: 0.5554s/iter; left time: 8359.3159s
	iters: 200, epoch: 26 | loss: 0.6693068
	speed: 0.0316s/iter; left time: 473.0771s
Epoch: 26 cost time: 24.876120567321777
Epoch: 26, Steps: 202 | Train Loss: 0.6633794 Vali Loss: 0.7103002 Vali AUC: 0.5352084
EarlyStopping counter: 21 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6689433
	speed: 0.5551s/iter; left time: 8243.0296s
	iters: 200, epoch: 27 | loss: 0.6844980
	speed: 0.0316s/iter; left time: 466.7572s
Epoch: 27 cost time: 24.894871473312378
Epoch: 27, Steps: 202 | Train Loss: 0.6629856 Vali Loss: 0.7115057 Vali AUC: 0.5364741
EarlyStopping counter: 22 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6370646
	speed: 0.5559s/iter; left time: 8142.6836s
	iters: 200, epoch: 28 | loss: 0.6374937
	speed: 0.0317s/iter; left time: 460.4559s
Epoch: 28 cost time: 24.95973014831543
Epoch: 28, Steps: 202 | Train Loss: 0.6634728 Vali Loss: 0.7084999 Vali AUC: 0.5404135
EarlyStopping counter: 23 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6781837
	speed: 0.5587s/iter; left time: 8070.1217s
	iters: 200, epoch: 29 | loss: 0.6528212
	speed: 0.0317s/iter; left time: 454.1297s
Epoch: 29 cost time: 25.110605001449585
Epoch: 29, Steps: 202 | Train Loss: 0.6613212 Vali Loss: 0.7110619 Vali AUC: 0.5434114
EarlyStopping counter: 24 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6402481
	speed: 0.5604s/iter; left time: 7981.9153s
	iters: 200, epoch: 30 | loss: 0.6929874
	speed: 0.0317s/iter; left time: 447.9457s
Epoch: 30 cost time: 24.95839214324951
Epoch: 30, Steps: 202 | Train Loss: 0.6605768 Vali Loss: 0.7123620 Vali AUC: 0.5444673
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1074
Accuracy: 0.5260707635009311, AUC: 0.5231248851298163, Sensitivity: 0.8081936685288641, Specificity: 0.24394785847299813, PPV: 0.5166666666666667, NPV: 0.5598290598290598, F1: 0.6303558460421207
