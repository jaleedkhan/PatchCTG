Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_0', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9682
Dataset loaded and preprocessed.
val set size: 1074
Dataset loaded and preprocessed.
test set size: 1074
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
All layers except the classification head are frozen for linear probing.
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1074
loading model
Accuracy: 0.5288640595903166, AUC: 0.5022107091955099, Sensitivity: 0.29981378026070765, Specificity: 0.7579143389199255, PPV: 0.5532646048109966, NPV: 0.5197956577266922, F1: 0.3888888888888889
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.7738771
	speed: 0.1692s/iter; left time: 3402.0687s
	iters: 200, epoch: 1 | loss: 0.7289611
	speed: 0.0137s/iter; left time: 273.0254s
Epoch: 1 cost time: 19.474721908569336
Epoch: 1, Steps: 202 | Train Loss: 0.7215618 Vali Loss: 0.7172404 Vali AUC: 0.4981066
Validation loss decreased (inf --> 0.717240).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7603016
	speed: 0.4795s/iter; left time: 9541.5673s
	iters: 200, epoch: 2 | loss: 0.7173250
	speed: 0.0136s/iter; left time: 269.2641s
Epoch: 2 cost time: 19.378422260284424
Epoch: 2, Steps: 202 | Train Loss: 0.7204471 Vali Loss: 0.7155302 Vali AUC: 0.4984915
Validation loss decreased (0.717240 --> 0.715530).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7178059
	speed: 0.4792s/iter; left time: 9438.0369s
	iters: 200, epoch: 3 | loss: 0.7100908
	speed: 0.0137s/iter; left time: 268.6969s
Epoch: 3 cost time: 19.402920722961426
Epoch: 3, Steps: 202 | Train Loss: 0.7201762 Vali Loss: 0.7157443 Vali AUC: 0.4978552
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7769860
	speed: 0.4791s/iter; left time: 9339.1935s
	iters: 200, epoch: 4 | loss: 0.6735811
	speed: 0.0137s/iter; left time: 264.9187s
Epoch: 4 cost time: 19.407289028167725
Epoch: 4, Steps: 202 | Train Loss: 0.7194904 Vali Loss: 0.7171883 Vali AUC: 0.4977824
EarlyStopping counter: 2 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6876190
	speed: 0.4791s/iter; left time: 9242.5498s
	iters: 200, epoch: 5 | loss: 0.7603287
	speed: 0.0136s/iter; left time: 261.0468s
Epoch: 5 cost time: 19.389650344848633
Epoch: 5, Steps: 202 | Train Loss: 0.7223457 Vali Loss: 0.7146735 Vali AUC: 0.4996272
Validation loss decreased (0.715530 --> 0.714674).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.7282194
	speed: 0.4806s/iter; left time: 9174.4594s
	iters: 200, epoch: 6 | loss: 0.7497090
	speed: 0.0137s/iter; left time: 260.5350s
Epoch: 6 cost time: 19.467544555664062
Epoch: 6, Steps: 202 | Train Loss: 0.7192621 Vali Loss: 0.7174929 Vali AUC: 0.4984274
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7621355
	speed: 0.4790s/iter; left time: 9048.7503s
	iters: 200, epoch: 7 | loss: 0.7313780
	speed: 0.0137s/iter; left time: 257.5704s
Epoch: 7 cost time: 19.414541006088257
Epoch: 7, Steps: 202 | Train Loss: 0.7189640 Vali Loss: 0.7159912 Vali AUC: 0.4977789
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.7112006
	speed: 0.4776s/iter; left time: 8925.2509s
	iters: 200, epoch: 8 | loss: 0.7441492
	speed: 0.0137s/iter; left time: 254.3247s
Epoch: 8 cost time: 19.43112802505493
Epoch: 8, Steps: 202 | Train Loss: 0.7192219 Vali Loss: 0.7164908 Vali AUC: 0.4977685
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6605875
	speed: 0.4798s/iter; left time: 8869.7741s
	iters: 200, epoch: 9 | loss: 0.6758015
	speed: 0.0137s/iter; left time: 251.8528s
Epoch: 9 cost time: 19.43331789970398
Epoch: 9, Steps: 202 | Train Loss: 0.7193896 Vali Loss: 0.7176042 Vali AUC: 0.4977633
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7247181
	speed: 0.4789s/iter; left time: 8756.3073s
	iters: 200, epoch: 10 | loss: 0.7609624
	speed: 0.0139s/iter; left time: 251.8840s
Epoch: 10 cost time: 19.476080894470215
Epoch: 10, Steps: 202 | Train Loss: 0.7171575 Vali Loss: 0.7164721 Vali AUC: 0.4985106
EarlyStopping counter: 5 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7593912
	speed: 0.4799s/iter; left time: 8676.9171s
	iters: 200, epoch: 11 | loss: 0.7165208
	speed: 0.0137s/iter; left time: 246.6811s
Epoch: 11 cost time: 19.35388731956482
Epoch: 11, Steps: 202 | Train Loss: 0.7190332 Vali Loss: 0.7141341 Vali AUC: 0.4999462
Validation loss decreased (0.714674 --> 0.714134).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6313307
	speed: 0.4783s/iter; left time: 8552.3373s
	iters: 200, epoch: 12 | loss: 0.7206370
	speed: 0.0137s/iter; left time: 243.7721s
Epoch: 12 cost time: 19.373337745666504
Epoch: 12, Steps: 202 | Train Loss: 0.7215893 Vali Loss: 0.7139955 Vali AUC: 0.4996671
Validation loss decreased (0.714134 --> 0.713996).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6839603
	speed: 0.4782s/iter; left time: 8453.3003s
	iters: 200, epoch: 13 | loss: 0.7984135
	speed: 0.0137s/iter; left time: 240.0485s
Epoch: 13 cost time: 19.370476245880127
Epoch: 13, Steps: 202 | Train Loss: 0.7209054 Vali Loss: 0.7159367 Vali AUC: 0.4979419
EarlyStopping counter: 1 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7433257
	speed: 0.4797s/iter; left time: 8382.9705s
	iters: 200, epoch: 14 | loss: 0.6984751
	speed: 0.0135s/iter; left time: 234.3730s
Epoch: 14 cost time: 19.394948720932007
Epoch: 14, Steps: 202 | Train Loss: 0.7189011 Vali Loss: 0.7152827 Vali AUC: 0.4989961
EarlyStopping counter: 2 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7488803
	speed: 0.4792s/iter; left time: 8276.8473s
	iters: 200, epoch: 15 | loss: 0.7704294
	speed: 0.0136s/iter; left time: 234.2951s
Epoch: 15 cost time: 19.382312297821045
Epoch: 15, Steps: 202 | Train Loss: 0.7222954 Vali Loss: 0.7158528 Vali AUC: 0.4986649
EarlyStopping counter: 3 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6471915
	speed: 0.4803s/iter; left time: 8199.9144s
	iters: 200, epoch: 16 | loss: 0.6912901
	speed: 0.0137s/iter; left time: 232.6372s
Epoch: 16 cost time: 19.378957271575928
Epoch: 16, Steps: 202 | Train Loss: 0.7208044 Vali Loss: 0.7133491 Vali AUC: 0.4995821
Validation loss decreased (0.713996 --> 0.713349).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.7055508
	speed: 0.4807s/iter; left time: 8108.4961s
	iters: 200, epoch: 17 | loss: 0.6756143
	speed: 0.0138s/iter; left time: 230.9871s
Epoch: 17 cost time: 19.37795090675354
Epoch: 17, Steps: 202 | Train Loss: 0.7205045 Vali Loss: 0.7145474 Vali AUC: 0.4986008
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.7069873
	speed: 0.4792s/iter; left time: 7987.4831s
	iters: 200, epoch: 18 | loss: 0.7239484
	speed: 0.0138s/iter; left time: 228.3913s
Epoch: 18 cost time: 19.439138174057007
Epoch: 18, Steps: 202 | Train Loss: 0.7212714 Vali Loss: 0.7136336 Vali AUC: 0.5000035
EarlyStopping counter: 2 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6833793
	speed: 0.4805s/iter; left time: 7910.9557s
	iters: 200, epoch: 19 | loss: 0.7324653
	speed: 0.0138s/iter; left time: 226.4432s
Epoch: 19 cost time: 19.373669862747192
Epoch: 19, Steps: 202 | Train Loss: 0.7201363 Vali Loss: 0.7135338 Vali AUC: 0.4999688
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.7622210
	speed: 0.4809s/iter; left time: 7820.8858s
	iters: 200, epoch: 20 | loss: 0.6756099
	speed: 0.0137s/iter; left time: 220.9144s
Epoch: 20 cost time: 19.349054098129272
Epoch: 20, Steps: 202 | Train Loss: 0.7216481 Vali Loss: 0.7112844 Vali AUC: 0.5001613
Validation loss decreased (0.713349 --> 0.711284).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.7905360
	speed: 0.4814s/iter; left time: 7731.2379s
	iters: 200, epoch: 21 | loss: 0.6911806
	speed: 0.0137s/iter; left time: 218.2156s
Epoch: 21 cost time: 19.45573878288269
Epoch: 21, Steps: 202 | Train Loss: 0.7198327 Vali Loss: 0.7121743 Vali AUC: 0.5002237
EarlyStopping counter: 1 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7319533
	speed: 0.4797s/iter; left time: 7607.2950s
	iters: 200, epoch: 22 | loss: 0.7268258
	speed: 0.0138s/iter; left time: 217.1793s
Epoch: 22 cost time: 19.450396299362183
Epoch: 22, Steps: 202 | Train Loss: 0.7201268 Vali Loss: 0.7145690 Vali AUC: 0.4993325
EarlyStopping counter: 2 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6718878
	speed: 0.4803s/iter; left time: 7519.7382s
	iters: 200, epoch: 23 | loss: 0.6509813
	speed: 0.0137s/iter; left time: 212.9296s
Epoch: 23 cost time: 19.453824520111084
Epoch: 23, Steps: 202 | Train Loss: 0.7193244 Vali Loss: 0.7117684 Vali AUC: 0.4998370
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.7415070
	speed: 0.4802s/iter; left time: 7420.7902s
	iters: 200, epoch: 24 | loss: 0.7117147
	speed: 0.0137s/iter; left time: 209.6596s
Epoch: 24 cost time: 19.38232922554016
Epoch: 24, Steps: 202 | Train Loss: 0.7204385 Vali Loss: 0.7166180 Vali AUC: 0.4980893
EarlyStopping counter: 4 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.7527797
	speed: 0.4792s/iter; left time: 7309.7586s
	iters: 200, epoch: 25 | loss: 0.7476436
	speed: 0.0136s/iter; left time: 205.7572s
Epoch: 25 cost time: 19.41226029396057
Epoch: 25, Steps: 202 | Train Loss: 0.7215812 Vali Loss: 0.7161485 Vali AUC: 0.4986354
EarlyStopping counter: 5 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6740400
	speed: 0.4799s/iter; left time: 7223.4838s
	iters: 200, epoch: 26 | loss: 0.7440376
	speed: 0.0137s/iter; left time: 204.7039s
Epoch: 26 cost time: 19.42036509513855
Epoch: 26, Steps: 202 | Train Loss: 0.7201225 Vali Loss: 0.7164756 Vali AUC: 0.4977997
EarlyStopping counter: 6 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6759154
	speed: 0.4814s/iter; left time: 7148.7607s
	iters: 200, epoch: 27 | loss: 0.7303664
	speed: 0.0136s/iter; left time: 200.9277s
Epoch: 27 cost time: 19.524613857269287
Epoch: 27, Steps: 202 | Train Loss: 0.7200356 Vali Loss: 0.7146149 Vali AUC: 0.4994382
EarlyStopping counter: 7 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6938588
	speed: 0.4815s/iter; left time: 7052.5780s
	iters: 200, epoch: 28 | loss: 0.6546282
	speed: 0.0137s/iter; left time: 199.4408s
Epoch: 28 cost time: 19.406895399093628
Epoch: 28, Steps: 202 | Train Loss: 0.7172734 Vali Loss: 0.7127256 Vali AUC: 0.4993949
EarlyStopping counter: 8 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.7463045
	speed: 0.4795s/iter; left time: 6926.4842s
	iters: 200, epoch: 29 | loss: 0.6731152
	speed: 0.0139s/iter; left time: 198.6852s
Epoch: 29 cost time: 19.4523446559906
Epoch: 29, Steps: 202 | Train Loss: 0.7185994 Vali Loss: 0.7144055 Vali AUC: 0.4985141
EarlyStopping counter: 9 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.7136266
	speed: 0.4821s/iter; left time: 6865.8487s
	iters: 200, epoch: 30 | loss: 0.7678179
	speed: 0.0138s/iter; left time: 194.5993s
Epoch: 30 cost time: 19.418483018875122
Epoch: 30, Steps: 202 | Train Loss: 0.7201920 Vali Loss: 0.7158122 Vali AUC: 0.4980841
EarlyStopping counter: 10 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.7281238
	speed: 0.4803s/iter; left time: 6743.9333s
	iters: 200, epoch: 31 | loss: 0.7215292
	speed: 0.0137s/iter; left time: 191.1272s
Epoch: 31 cost time: 19.438886880874634
Epoch: 31, Steps: 202 | Train Loss: 0.7191659 Vali Loss: 0.7138774 Vali AUC: 0.4988764
EarlyStopping counter: 11 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6559459
	speed: 0.4799s/iter; left time: 6641.4586s
	iters: 200, epoch: 32 | loss: 0.7120854
	speed: 0.0137s/iter; left time: 188.7995s
Epoch: 32 cost time: 19.41437816619873
Epoch: 32, Steps: 202 | Train Loss: 0.7192509 Vali Loss: 0.7147707 Vali AUC: 0.4994677
EarlyStopping counter: 12 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.7245756
	speed: 0.4800s/iter; left time: 6545.9088s
	iters: 200, epoch: 33 | loss: 0.7220407
	speed: 0.0136s/iter; left time: 184.3116s
Epoch: 33 cost time: 19.402894258499146
Epoch: 33, Steps: 202 | Train Loss: 0.7185932 Vali Loss: 0.7142785 Vali AUC: 0.4996480
EarlyStopping counter: 13 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.7476184
	speed: 0.4805s/iter; left time: 6455.7064s
	iters: 200, epoch: 34 | loss: 0.7324917
	speed: 0.0137s/iter; left time: 183.3254s
Epoch: 34 cost time: 19.470094680786133
Epoch: 34, Steps: 202 | Train Loss: 0.7211403 Vali Loss: 0.7175447 Vali AUC: 0.4979609
EarlyStopping counter: 14 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.6958157
	speed: 0.4809s/iter; left time: 6363.8757s
	iters: 200, epoch: 35 | loss: 0.7317061
	speed: 0.0136s/iter; left time: 179.1485s
Epoch: 35 cost time: 19.409613370895386
Epoch: 35, Steps: 202 | Train Loss: 0.7199157 Vali Loss: 0.7117127 Vali AUC: 0.5009155
EarlyStopping counter: 15 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.7124545
	speed: 0.4802s/iter; left time: 6256.9249s
	iters: 200, epoch: 36 | loss: 0.6631999
	speed: 0.0135s/iter; left time: 175.1088s
Epoch: 36 cost time: 19.444207906723022
Epoch: 36, Steps: 202 | Train Loss: 0.7190109 Vali Loss: 0.7104926 Vali AUC: 0.5007508
Validation loss decreased (0.711284 --> 0.710493).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.7773864
	speed: 0.4834s/iter; left time: 6202.1722s
	iters: 200, epoch: 37 | loss: 0.7215976
	speed: 0.0138s/iter; left time: 175.0341s
Epoch: 37 cost time: 19.38664937019348
Epoch: 37, Steps: 202 | Train Loss: 0.7201596 Vali Loss: 0.7132842 Vali AUC: 0.5001994
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6402273
	speed: 0.4796s/iter; left time: 6056.3287s
	iters: 200, epoch: 38 | loss: 0.7267665
	speed: 0.0137s/iter; left time: 171.9927s
Epoch: 38 cost time: 19.516139268875122
Epoch: 38, Steps: 202 | Train Loss: 0.7208279 Vali Loss: 0.7173347 Vali AUC: 0.4976905
EarlyStopping counter: 2 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.7084484
	speed: 0.4822s/iter; left time: 5991.4285s
	iters: 200, epoch: 39 | loss: 0.6964209
	speed: 0.0137s/iter; left time: 169.2580s
Epoch: 39 cost time: 19.37199568748474
Epoch: 39, Steps: 202 | Train Loss: 0.7206918 Vali Loss: 0.7150684 Vali AUC: 0.4986684
EarlyStopping counter: 3 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7427205
	speed: 0.4809s/iter; left time: 5878.5846s
	iters: 200, epoch: 40 | loss: 0.7506110
	speed: 0.0138s/iter; left time: 166.9447s
Epoch: 40 cost time: 19.47083353996277
Epoch: 40, Steps: 202 | Train Loss: 0.7213623 Vali Loss: 0.7166331 Vali AUC: 0.4976072
EarlyStopping counter: 4 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.7534312
	speed: 0.4815s/iter; left time: 5788.2427s
	iters: 200, epoch: 41 | loss: 0.8098578
	speed: 0.0137s/iter; left time: 163.6329s
Epoch: 41 cost time: 19.425509452819824
Epoch: 41, Steps: 202 | Train Loss: 0.7213816 Vali Loss: 0.7161382 Vali AUC: 0.4992319
EarlyStopping counter: 5 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.7059215
	speed: 0.4811s/iter; left time: 5686.5160s
	iters: 200, epoch: 42 | loss: 0.7003198
	speed: 0.0136s/iter; left time: 159.7709s
Epoch: 42 cost time: 19.530633211135864
Epoch: 42, Steps: 202 | Train Loss: 0.7198989 Vali Loss: 0.7146092 Vali AUC: 0.4986961
EarlyStopping counter: 6 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.7734970
	speed: 0.4849s/iter; left time: 5633.4224s
	iters: 200, epoch: 43 | loss: 0.7062960
	speed: 0.0136s/iter; left time: 156.7823s
Epoch: 43 cost time: 19.477434873580933
Epoch: 43, Steps: 202 | Train Loss: 0.7190706 Vali Loss: 0.7147714 Vali AUC: 0.4994868
EarlyStopping counter: 7 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.7511212
	speed: 0.4813s/iter; left time: 5493.7416s
	iters: 200, epoch: 44 | loss: 0.7048230
	speed: 0.0137s/iter; left time: 154.4765s
Epoch: 44 cost time: 19.450123071670532
Epoch: 44, Steps: 202 | Train Loss: 0.7209292 Vali Loss: 0.7148177 Vali AUC: 0.4999081
EarlyStopping counter: 8 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.7069411
	speed: 0.4804s/iter; left time: 5386.6744s
	iters: 200, epoch: 45 | loss: 0.7233221
	speed: 0.0137s/iter; left time: 152.7505s
Epoch: 45 cost time: 19.43553638458252
Epoch: 45, Steps: 202 | Train Loss: 0.7188998 Vali Loss: 0.7148298 Vali AUC: 0.4991573
EarlyStopping counter: 9 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.7424483
	speed: 0.4809s/iter; left time: 5295.3021s
	iters: 200, epoch: 46 | loss: 0.7153441
	speed: 0.0138s/iter; left time: 150.4500s
Epoch: 46 cost time: 19.386845111846924
Epoch: 46, Steps: 202 | Train Loss: 0.7199965 Vali Loss: 0.7146686 Vali AUC: 0.4995735
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.7879992
	speed: 0.4805s/iter; left time: 5193.3370s
	iters: 200, epoch: 47 | loss: 0.6971698
	speed: 0.0137s/iter; left time: 146.6616s
Epoch: 47 cost time: 19.423202753067017
Epoch: 47, Steps: 202 | Train Loss: 0.7204349 Vali Loss: 0.7162414 Vali AUC: 0.4983823
EarlyStopping counter: 11 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.7545351
	speed: 0.4822s/iter; left time: 5115.0543s
	iters: 200, epoch: 48 | loss: 0.7576694
	speed: 0.0139s/iter; left time: 145.6303s
Epoch: 48 cost time: 19.44996929168701
Epoch: 48, Steps: 202 | Train Loss: 0.7208098 Vali Loss: 0.7168183 Vali AUC: 0.4979245
EarlyStopping counter: 12 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.7417130
	speed: 0.4824s/iter; left time: 5018.9953s
	iters: 200, epoch: 49 | loss: 0.7764846
	speed: 0.0137s/iter; left time: 140.9819s
Epoch: 49 cost time: 19.624667406082153
Epoch: 49, Steps: 202 | Train Loss: 0.7188982 Vali Loss: 0.7164136 Vali AUC: 0.4980372
EarlyStopping counter: 13 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.7534624
	speed: 0.4839s/iter; left time: 4937.3322s
	iters: 200, epoch: 50 | loss: 0.7149686
	speed: 0.0137s/iter; left time: 138.4595s
Epoch: 50 cost time: 19.525044679641724
Epoch: 50, Steps: 202 | Train Loss: 0.7185557 Vali Loss: 0.7155817 Vali AUC: 0.4994348
EarlyStopping counter: 14 out of 25
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.6820719
	speed: 0.4821s/iter; left time: 4821.3334s
	iters: 200, epoch: 51 | loss: 0.6891331
	speed: 0.0137s/iter; left time: 135.6546s
Epoch: 51 cost time: 19.519551515579224
Epoch: 51, Steps: 202 | Train Loss: 0.7200676 Vali Loss: 0.7139498 Vali AUC: 0.5006571
EarlyStopping counter: 15 out of 25
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.7520022
	speed: 0.4822s/iter; left time: 4724.6228s
	iters: 200, epoch: 52 | loss: 0.7186912
	speed: 0.0137s/iter; left time: 133.1409s
Epoch: 52 cost time: 19.44659447669983
Epoch: 52, Steps: 202 | Train Loss: 0.7196862 Vali Loss: 0.7159706 Vali AUC: 0.4989995
EarlyStopping counter: 16 out of 25
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.7497982
	speed: 0.4824s/iter; left time: 4629.1492s
	iters: 200, epoch: 53 | loss: 0.6741836
	speed: 0.0138s/iter; left time: 131.2566s
Epoch: 53 cost time: 19.481438398361206
Epoch: 53, Steps: 202 | Train Loss: 0.7196112 Vali Loss: 0.7158621 Vali AUC: 0.4984794
EarlyStopping counter: 17 out of 25
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.7309160
	speed: 0.4819s/iter; left time: 4527.7845s
	iters: 200, epoch: 54 | loss: 0.7061388
	speed: 0.0138s/iter; left time: 128.0204s
Epoch: 54 cost time: 19.4791476726532
Epoch: 54, Steps: 202 | Train Loss: 0.7221293 Vali Loss: 0.7134396 Vali AUC: 0.4997677
EarlyStopping counter: 18 out of 25
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.7791311
	speed: 0.4817s/iter; left time: 4428.1363s
	iters: 200, epoch: 55 | loss: 0.6981332
	speed: 0.0136s/iter; left time: 123.7855s
Epoch: 55 cost time: 19.436636209487915
Epoch: 55, Steps: 202 | Train Loss: 0.7199506 Vali Loss: 0.7144889 Vali AUC: 0.4994261
EarlyStopping counter: 19 out of 25
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.7406290
	speed: 0.4824s/iter; left time: 4337.3427s
	iters: 200, epoch: 56 | loss: 0.6845702
	speed: 0.0137s/iter; left time: 121.4558s
Epoch: 56 cost time: 19.46835970878601
Epoch: 56, Steps: 202 | Train Loss: 0.7195797 Vali Loss: 0.7149137 Vali AUC: 0.4989475
EarlyStopping counter: 20 out of 25
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.7327504
	speed: 0.4826s/iter; left time: 4241.5640s
	iters: 200, epoch: 57 | loss: 0.6914858
	speed: 0.0137s/iter; left time: 118.6580s
Epoch: 57 cost time: 19.42950201034546
Epoch: 57, Steps: 202 | Train Loss: 0.7186854 Vali Loss: 0.7147246 Vali AUC: 0.4998578
EarlyStopping counter: 21 out of 25
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.6938285
	speed: 0.4838s/iter; left time: 4154.2407s
	iters: 200, epoch: 58 | loss: 0.7248554
	speed: 0.0138s/iter; left time: 116.7511s
Epoch: 58 cost time: 19.44625210762024
Epoch: 58, Steps: 202 | Train Loss: 0.7194381 Vali Loss: 0.7156428 Vali AUC: 0.4982696
EarlyStopping counter: 22 out of 25
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.7265393
	speed: 0.4812s/iter; left time: 4035.1265s
	iters: 200, epoch: 59 | loss: 0.7318467
	speed: 0.0137s/iter; left time: 113.3526s
Epoch: 59 cost time: 19.468140840530396
Epoch: 59, Steps: 202 | Train Loss: 0.7184998 Vali Loss: 0.7144486 Vali AUC: 0.4996289
EarlyStopping counter: 23 out of 25
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.6921374
	speed: 0.4814s/iter; left time: 3939.1003s
	iters: 200, epoch: 60 | loss: 0.7111858
	speed: 0.0137s/iter; left time: 110.6660s
Epoch: 60 cost time: 19.39988923072815
Epoch: 60, Steps: 202 | Train Loss: 0.7202291 Vali Loss: 0.7112413 Vali AUC: 0.5011773
EarlyStopping counter: 24 out of 25
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.6851828
	speed: 0.4808s/iter; left time: 3837.3461s
	iters: 200, epoch: 61 | loss: 0.6867269
	speed: 0.0137s/iter; left time: 107.8162s
Epoch: 61 cost time: 19.429898738861084
Epoch: 61, Steps: 202 | Train Loss: 0.7213606 Vali Loss: 0.7125639 Vali AUC: 0.5007300
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1074
Accuracy: 0.5232774674115456, AUC: 0.5007507741816908, Sensitivity: 0.260707635009311, Specificity: 0.7858472998137802, PPV: 0.5490196078431373, NPV: 0.5152625152625152, F1: 0.3535353535353536
