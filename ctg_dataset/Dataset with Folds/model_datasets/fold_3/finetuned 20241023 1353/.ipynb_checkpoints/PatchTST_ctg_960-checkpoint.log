Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=0, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_3', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9678
Dataset loaded and preprocessed.
val set size: 1078
Dataset loaded and preprocessed.
test set size: 1078
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1078
loading model
Accuracy: 0.5445269016697588, AUC: 0.5371625459089017, Sensitivity: 0.2727272727272727, Specificity: 0.8163265306122449, PPV: 0.5975609756097561, NPV: 0.5288461538461539, F1: 0.3745222929936306
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.6990549
	speed: 0.0149s/iter; left time: 299.8605s
	iters: 200, epoch: 1 | loss: 0.6799978
	speed: 0.0148s/iter; left time: 296.9358s
Epoch: 1 cost time: 3.0034213066101074
Epoch: 1, Steps: 202 | Train Loss: 0.7054572 Vali Loss: 0.6938383 Vali AUC: 0.5393121
Validation loss decreased (inf --> 0.693838).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7096731
	speed: 0.0214s/iter; left time: 426.6994s
	iters: 200, epoch: 2 | loss: 0.6739879
	speed: 0.0148s/iter; left time: 293.2612s
Epoch: 2 cost time: 2.990374803543091
Epoch: 2, Steps: 202 | Train Loss: 0.7053557 Vali Loss: 0.6960760 Vali AUC: 0.5393018
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6790437
	speed: 0.0211s/iter; left time: 415.0158s
	iters: 200, epoch: 3 | loss: 0.6883141
	speed: 0.0148s/iter; left time: 290.7294s
Epoch: 3 cost time: 2.9939162731170654
Epoch: 3, Steps: 202 | Train Loss: 0.7047636 Vali Loss: 0.6941155 Vali AUC: 0.5393500
EarlyStopping counter: 2 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7472103
	speed: 0.0211s/iter; left time: 411.2672s
	iters: 200, epoch: 4 | loss: 0.7197046
	speed: 0.0148s/iter; left time: 287.5809s
Epoch: 4 cost time: 2.9948437213897705
Epoch: 4, Steps: 202 | Train Loss: 0.7057845 Vali Loss: 0.6940043 Vali AUC: 0.5389817
EarlyStopping counter: 3 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7391756
	speed: 0.0211s/iter; left time: 406.3275s
	iters: 200, epoch: 5 | loss: 0.6371924
	speed: 0.0148s/iter; left time: 284.6199s
Epoch: 5 cost time: 2.9938149452209473
Epoch: 5, Steps: 202 | Train Loss: 0.7034057 Vali Loss: 0.6940348 Vali AUC: 0.5401692
EarlyStopping counter: 4 out of 25
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6943125
	speed: 0.0211s/iter; left time: 401.9089s
	iters: 200, epoch: 6 | loss: 0.6941984
	speed: 0.0148s/iter; left time: 281.6776s
Epoch: 6 cost time: 2.992636203765869
Epoch: 6, Steps: 202 | Train Loss: 0.7037544 Vali Loss: 0.6937663 Vali AUC: 0.5389610
Validation loss decreased (0.693838 --> 0.693766).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7119362
	speed: 0.0215s/iter; left time: 405.3401s
	iters: 200, epoch: 7 | loss: 0.6942459
	speed: 0.0148s/iter; left time: 278.5490s
Epoch: 7 cost time: 2.993701934814453
Epoch: 7, Steps: 202 | Train Loss: 0.7034077 Vali Loss: 0.6944096 Vali AUC: 0.5393552
EarlyStopping counter: 1 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6897042
	speed: 0.0211s/iter; left time: 393.7954s
	iters: 200, epoch: 8 | loss: 0.6943499
	speed: 0.0148s/iter; left time: 275.6447s
Epoch: 8 cost time: 2.9942641258239746
Epoch: 8, Steps: 202 | Train Loss: 0.7038343 Vali Loss: 0.6947472 Vali AUC: 0.5398474
EarlyStopping counter: 2 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6804984
	speed: 0.0211s/iter; left time: 389.6328s
	iters: 200, epoch: 9 | loss: 0.6736700
	speed: 0.0148s/iter; left time: 272.7368s
Epoch: 9 cost time: 2.9954335689544678
Epoch: 9, Steps: 202 | Train Loss: 0.7036891 Vali Loss: 0.6957826 Vali AUC: 0.5396030
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6789383
	speed: 0.0211s/iter; left time: 385.2122s
	iters: 200, epoch: 10 | loss: 0.7390265
	speed: 0.0148s/iter; left time: 269.7587s
Epoch: 10 cost time: 2.994562864303589
Epoch: 10, Steps: 202 | Train Loss: 0.7029196 Vali Loss: 0.6935769 Vali AUC: 0.5392760
Validation loss decreased (0.693766 --> 0.693577).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7205626
	speed: 0.0215s/iter; left time: 388.1758s
	iters: 200, epoch: 11 | loss: 0.7054087
	speed: 0.0148s/iter; left time: 266.3791s
Epoch: 11 cost time: 2.99245285987854
Epoch: 11, Steps: 202 | Train Loss: 0.7024496 Vali Loss: 0.6935032 Vali AUC: 0.5404704
Validation loss decreased (0.693577 --> 0.693503).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7430367
	speed: 0.0215s/iter; left time: 383.7774s
	iters: 200, epoch: 12 | loss: 0.7031171
	speed: 0.0148s/iter; left time: 263.5157s
Epoch: 12 cost time: 2.9937028884887695
Epoch: 12, Steps: 202 | Train Loss: 0.7030126 Vali Loss: 0.6934873 Vali AUC: 0.5395944
Validation loss decreased (0.693503 --> 0.693487).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6985831
	speed: 0.0216s/iter; left time: 381.5585s
	iters: 200, epoch: 13 | loss: 0.7247657
	speed: 0.0150s/iter; left time: 262.8387s
Epoch: 13 cost time: 3.018188714981079
Epoch: 13, Steps: 202 | Train Loss: 0.7036632 Vali Loss: 0.6936008 Vali AUC: 0.5395651
EarlyStopping counter: 1 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7289542
	speed: 0.0212s/iter; left time: 370.2720s
	iters: 200, epoch: 14 | loss: 0.7448789
	speed: 0.0149s/iter; left time: 259.2554s
Epoch: 14 cost time: 3.010519027709961
Epoch: 14, Steps: 202 | Train Loss: 0.7027813 Vali Loss: 0.6931294 Vali AUC: 0.5403998
Validation loss decreased (0.693487 --> 0.693129).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6382600
	speed: 0.0215s/iter; left time: 372.2079s
	iters: 200, epoch: 15 | loss: 0.7084467
	speed: 0.0149s/iter; left time: 255.2371s
Epoch: 15 cost time: 3.0008203983306885
Epoch: 15, Steps: 202 | Train Loss: 0.7037439 Vali Loss: 0.6931699 Vali AUC: 0.5401658
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6948821
	speed: 0.0212s/iter; left time: 361.7221s
	iters: 200, epoch: 16 | loss: 0.6813706
	speed: 0.0150s/iter; left time: 253.7492s
Epoch: 16 cost time: 3.0150387287139893
Epoch: 16, Steps: 202 | Train Loss: 0.7031156 Vali Loss: 0.6939889 Vali AUC: 0.5401520
EarlyStopping counter: 2 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6634232
	speed: 0.0213s/iter; left time: 358.5383s
	iters: 200, epoch: 17 | loss: 0.6851432
	speed: 0.0149s/iter; left time: 250.3430s
Epoch: 17 cost time: 3.0183732509613037
Epoch: 17, Steps: 202 | Train Loss: 0.7037980 Vali Loss: 0.6937213 Vali AUC: 0.5402140
EarlyStopping counter: 3 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6863232
	speed: 0.0212s/iter; left time: 353.0693s
	iters: 200, epoch: 18 | loss: 0.7228055
	speed: 0.0149s/iter; left time: 246.0726s
Epoch: 18 cost time: 3.001737594604492
Epoch: 18, Steps: 202 | Train Loss: 0.7025540 Vali Loss: 0.6927321 Vali AUC: 0.5402122
Validation loss decreased (0.693129 --> 0.692732).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.7082473
	speed: 0.0215s/iter; left time: 353.6160s
	iters: 200, epoch: 19 | loss: 0.6965305
	speed: 0.0148s/iter; left time: 242.1727s
Epoch: 19 cost time: 2.9886698722839355
Epoch: 19, Steps: 202 | Train Loss: 0.7028839 Vali Loss: 0.6921972 Vali AUC: 0.5400694
Validation loss decreased (0.692732 --> 0.692197).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.7447939
	speed: 0.0215s/iter; left time: 349.0076s
	iters: 200, epoch: 20 | loss: 0.7051290
	speed: 0.0148s/iter; left time: 239.4394s
Epoch: 20 cost time: 2.990694999694824
Epoch: 20, Steps: 202 | Train Loss: 0.7044232 Vali Loss: 0.6941454 Vali AUC: 0.5397235
EarlyStopping counter: 1 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6706160
	speed: 0.0211s/iter; left time: 338.3402s
	iters: 200, epoch: 21 | loss: 0.7158405
	speed: 0.0148s/iter; left time: 236.7844s
Epoch: 21 cost time: 2.9916930198669434
Epoch: 21, Steps: 202 | Train Loss: 0.7019154 Vali Loss: 0.6931668 Vali AUC: 0.5402174
EarlyStopping counter: 2 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7358112
	speed: 0.0211s/iter; left time: 333.9767s
	iters: 200, epoch: 22 | loss: 0.7321391
	speed: 0.0148s/iter; left time: 233.9502s
Epoch: 22 cost time: 2.9917526245117188
Epoch: 22, Steps: 202 | Train Loss: 0.7008620 Vali Loss: 0.6923499 Vali AUC: 0.5405737
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.7063313
	speed: 0.0211s/iter; left time: 330.4964s
	iters: 200, epoch: 23 | loss: 0.7552093
	speed: 0.0148s/iter; left time: 230.2519s
Epoch: 23 cost time: 2.992300510406494
Epoch: 23, Steps: 202 | Train Loss: 0.7045546 Vali Loss: 0.6923488 Vali AUC: 0.5405014
EarlyStopping counter: 4 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6745349
	speed: 0.0210s/iter; left time: 325.2664s
	iters: 200, epoch: 24 | loss: 0.6629419
	speed: 0.0148s/iter; left time: 227.7487s
Epoch: 24 cost time: 2.990837335586548
Epoch: 24, Steps: 202 | Train Loss: 0.7009562 Vali Loss: 0.6933174 Vali AUC: 0.5404532
EarlyStopping counter: 5 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.7205476
	speed: 0.0211s/iter; left time: 322.0893s
	iters: 200, epoch: 25 | loss: 0.7160811
	speed: 0.0148s/iter; left time: 224.9933s
Epoch: 25 cost time: 2.998483180999756
Epoch: 25, Steps: 202 | Train Loss: 0.7012441 Vali Loss: 0.6920064 Vali AUC: 0.5407492
Validation loss decreased (0.692197 --> 0.692006).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6846454
	speed: 0.0214s/iter; left time: 322.8330s
	iters: 200, epoch: 26 | loss: 0.7050729
	speed: 0.0148s/iter; left time: 221.2883s
Epoch: 26 cost time: 2.9899611473083496
Epoch: 26, Steps: 202 | Train Loss: 0.7028112 Vali Loss: 0.6930050 Vali AUC: 0.5402398
EarlyStopping counter: 1 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6978971
	speed: 0.0211s/iter; left time: 312.8587s
	iters: 200, epoch: 27 | loss: 0.6524589
	speed: 0.0149s/iter; left time: 219.5673s
Epoch: 27 cost time: 2.9981441497802734
Epoch: 27, Steps: 202 | Train Loss: 0.7025159 Vali Loss: 0.6930774 Vali AUC: 0.5409540
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.7228858
	speed: 0.0211s/iter; left time: 309.4849s
	iters: 200, epoch: 28 | loss: 0.7371346
	speed: 0.0149s/iter; left time: 216.1026s
Epoch: 28 cost time: 2.9983487129211426
Epoch: 28, Steps: 202 | Train Loss: 0.7028214 Vali Loss: 0.6915984 Vali AUC: 0.5409988
Validation loss decreased (0.692006 --> 0.691598).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6908104
	speed: 0.0215s/iter; left time: 310.8879s
	iters: 200, epoch: 29 | loss: 0.6556323
	speed: 0.0149s/iter; left time: 213.5491s
Epoch: 29 cost time: 3.0032835006713867
Epoch: 29, Steps: 202 | Train Loss: 0.7039378 Vali Loss: 0.6928357 Vali AUC: 0.5406752
EarlyStopping counter: 1 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6883330
	speed: 0.0212s/iter; left time: 301.5979s
	iters: 200, epoch: 30 | loss: 0.7316562
	speed: 0.0148s/iter; left time: 210.0029s
Epoch: 30 cost time: 3.0008392333984375
Epoch: 30, Steps: 202 | Train Loss: 0.7013031 Vali Loss: 0.6922055 Vali AUC: 0.5396563
EarlyStopping counter: 2 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6888742
	speed: 0.0211s/iter; left time: 295.8974s
	iters: 200, epoch: 31 | loss: 0.6768639
	speed: 0.0147s/iter; left time: 205.5969s
Epoch: 31 cost time: 2.9808778762817383
Epoch: 31, Steps: 202 | Train Loss: 0.7023738 Vali Loss: 0.6917949 Vali AUC: 0.5399231
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6856121
	speed: 0.0211s/iter; left time: 292.0669s
	iters: 200, epoch: 32 | loss: 0.7011670
	speed: 0.0148s/iter; left time: 203.7101s
Epoch: 32 cost time: 2.9925172328948975
Epoch: 32, Steps: 202 | Train Loss: 0.7024189 Vali Loss: 0.6926062 Vali AUC: 0.5404119
EarlyStopping counter: 4 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6792659
	speed: 0.0211s/iter; left time: 288.3294s
	iters: 200, epoch: 33 | loss: 0.6727762
	speed: 0.0150s/iter; left time: 202.4633s
Epoch: 33 cost time: 3.0110466480255127
Epoch: 33, Steps: 202 | Train Loss: 0.7020743 Vali Loss: 0.6923464 Vali AUC: 0.5399799
EarlyStopping counter: 5 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.6923960
	speed: 0.0212s/iter; left time: 285.1631s
	iters: 200, epoch: 34 | loss: 0.6957808
	speed: 0.0149s/iter; left time: 198.4175s
Epoch: 34 cost time: 3.0071589946746826
Epoch: 34, Steps: 202 | Train Loss: 0.7030739 Vali Loss: 0.6921974 Vali AUC: 0.5418008
EarlyStopping counter: 6 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.6920450
	speed: 0.0212s/iter; left time: 280.2866s
	iters: 200, epoch: 35 | loss: 0.7125670
	speed: 0.0149s/iter; left time: 195.4617s
Epoch: 35 cost time: 3.0060014724731445
Epoch: 35, Steps: 202 | Train Loss: 0.7023879 Vali Loss: 0.6927155 Vali AUC: 0.5415340
EarlyStopping counter: 7 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6886225
	speed: 0.0211s/iter; left time: 274.8846s
	iters: 200, epoch: 36 | loss: 0.7113215
	speed: 0.0148s/iter; left time: 191.8991s
Epoch: 36 cost time: 2.9944581985473633
Epoch: 36, Steps: 202 | Train Loss: 0.7015691 Vali Loss: 0.6923336 Vali AUC: 0.5407303
EarlyStopping counter: 8 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.7362849
	speed: 0.0212s/iter; left time: 271.4552s
	iters: 200, epoch: 37 | loss: 0.7043025
	speed: 0.0148s/iter; left time: 188.9687s
Epoch: 37 cost time: 3.0001015663146973
Epoch: 37, Steps: 202 | Train Loss: 0.7019522 Vali Loss: 0.6928719 Vali AUC: 0.5393827
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6832924
	speed: 0.0212s/iter; left time: 267.3379s
	iters: 200, epoch: 38 | loss: 0.7214590
	speed: 0.0149s/iter; left time: 186.1169s
Epoch: 38 cost time: 3.0028140544891357
Epoch: 38, Steps: 202 | Train Loss: 0.7010215 Vali Loss: 0.6927458 Vali AUC: 0.5407802
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.7288963
	speed: 0.0211s/iter; left time: 262.6551s
	iters: 200, epoch: 39 | loss: 0.6913726
	speed: 0.0149s/iter; left time: 183.6695s
Epoch: 39 cost time: 3.0020792484283447
Epoch: 39, Steps: 202 | Train Loss: 0.7026365 Vali Loss: 0.6917885 Vali AUC: 0.5412345
EarlyStopping counter: 11 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7027538
	speed: 0.0212s/iter; left time: 258.9212s
	iters: 200, epoch: 40 | loss: 0.7027472
	speed: 0.0149s/iter; left time: 180.1832s
Epoch: 40 cost time: 3.0028586387634277
Epoch: 40, Steps: 202 | Train Loss: 0.7010905 Vali Loss: 0.6922623 Vali AUC: 0.5406683
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.6930455
	speed: 0.0211s/iter; left time: 253.4646s
	iters: 200, epoch: 41 | loss: 0.7100446
	speed: 0.0149s/iter; left time: 177.9847s
Epoch: 41 cost time: 3.002070903778076
Epoch: 41, Steps: 202 | Train Loss: 0.7025651 Vali Loss: 0.6918268 Vali AUC: 0.5395909
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.6863674
	speed: 0.0212s/iter; left time: 250.8310s
	iters: 200, epoch: 42 | loss: 0.7239560
	speed: 0.0147s/iter; left time: 172.1583s
Epoch: 42 cost time: 2.9865236282348633
Epoch: 42, Steps: 202 | Train Loss: 0.7010829 Vali Loss: 0.6925009 Vali AUC: 0.5407699
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.7066798
	speed: 0.0209s/iter; left time: 242.9901s
	iters: 200, epoch: 43 | loss: 0.7206348
	speed: 0.0149s/iter; left time: 171.7496s
Epoch: 43 cost time: 2.989804983139038
Epoch: 43, Steps: 202 | Train Loss: 0.7024165 Vali Loss: 0.6923908 Vali AUC: 0.5405048
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.6946603
	speed: 0.0211s/iter; left time: 240.6683s
	iters: 200, epoch: 44 | loss: 0.7556520
	speed: 0.0148s/iter; left time: 167.6758s
Epoch: 44 cost time: 2.9960243701934814
Epoch: 44, Steps: 202 | Train Loss: 0.7022414 Vali Loss: 0.6926615 Vali AUC: 0.5406666
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.6973113
	speed: 0.0211s/iter; left time: 236.8641s
	iters: 200, epoch: 45 | loss: 0.6937356
	speed: 0.0149s/iter; left time: 165.9870s
Epoch: 45 cost time: 3.013005495071411
Epoch: 45, Steps: 202 | Train Loss: 0.7006101 Vali Loss: 0.6941073 Vali AUC: 0.5411726
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.7178912
	speed: 0.0213s/iter; left time: 234.9406s
	iters: 200, epoch: 46 | loss: 0.7258900
	speed: 0.0149s/iter; left time: 162.2732s
Epoch: 46 cost time: 3.0209462642669678
Epoch: 46, Steps: 202 | Train Loss: 0.7031919 Vali Loss: 0.6931412 Vali AUC: 0.5410900
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.7135307
	speed: 0.0213s/iter; left time: 230.5597s
	iters: 200, epoch: 47 | loss: 0.7049091
	speed: 0.0158s/iter; left time: 168.7272s
Epoch: 47 cost time: 3.1089422702789307
Epoch: 47, Steps: 202 | Train Loss: 0.6996167 Vali Loss: 0.6921019 Vali AUC: 0.5405392
EarlyStopping counter: 19 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.6864265
	speed: 0.0227s/iter; left time: 240.5630s
	iters: 200, epoch: 48 | loss: 0.7150096
	speed: 0.0157s/iter; left time: 165.4668s
Epoch: 48 cost time: 3.200270891189575
Epoch: 48, Steps: 202 | Train Loss: 0.6989988 Vali Loss: 0.6936797 Vali AUC: 0.5400591
EarlyStopping counter: 20 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.6692467
	speed: 0.0227s/iter; left time: 236.2113s
	iters: 200, epoch: 49 | loss: 0.7261186
	speed: 0.0159s/iter; left time: 163.8222s
Epoch: 49 cost time: 3.2125775814056396
Epoch: 49, Steps: 202 | Train Loss: 0.7015680 Vali Loss: 0.6920885 Vali AUC: 0.5414428
EarlyStopping counter: 21 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.6925785
	speed: 0.0228s/iter; left time: 232.1856s
	iters: 200, epoch: 50 | loss: 0.6694188
	speed: 0.0160s/iter; left time: 162.1432s
Epoch: 50 cost time: 3.2433013916015625
Epoch: 50, Steps: 202 | Train Loss: 0.7013384 Vali Loss: 0.6929860 Vali AUC: 0.5404532
EarlyStopping counter: 22 out of 25
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.7329993
	speed: 0.0227s/iter; left time: 227.1763s
	iters: 200, epoch: 51 | loss: 0.6971998
	speed: 0.0160s/iter; left time: 158.5154s
Epoch: 51 cost time: 3.225315809249878
Epoch: 51, Steps: 202 | Train Loss: 0.7022009 Vali Loss: 0.6943706 Vali AUC: 0.5406752
EarlyStopping counter: 23 out of 25
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.6847903
	speed: 0.0228s/iter; left time: 222.9536s
	iters: 200, epoch: 52 | loss: 0.6879268
	speed: 0.0159s/iter; left time: 154.1810s
Epoch: 52 cost time: 3.2182059288024902
Epoch: 52, Steps: 202 | Train Loss: 0.7020274 Vali Loss: 0.6928314 Vali AUC: 0.5405564
EarlyStopping counter: 24 out of 25
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.6504657
	speed: 0.0228s/iter; left time: 218.8070s
	iters: 200, epoch: 53 | loss: 0.6612970
	speed: 0.0158s/iter; left time: 150.3651s
Epoch: 53 cost time: 3.2062580585479736
Epoch: 53, Steps: 202 | Train Loss: 0.7029490 Vali Loss: 0.6918218 Vali AUC: 0.5403809
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1078
Accuracy: 0.5445269016697588, AUC: 0.5409987574048003, Sensitivity: 0.3914656771799629, Specificity: 0.6975881261595547, PPV: 0.5641711229946524, NPV: 0.5340909090909091, F1: 0.4622124863088718
