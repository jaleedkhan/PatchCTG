Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_3', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9678
Dataset loaded and preprocessed.
val set size: 1078
Dataset loaded and preprocessed.
test set size: 1078
	iters: 100, epoch: 1 | loss: 0.7237954
	speed: 0.2106s/iter; left time: 4233.0333s
	iters: 200, epoch: 1 | loss: 0.6658796
	speed: 0.0316s/iter; left time: 631.4581s
Epoch: 1 cost time: 25.33174467086792
Epoch: 1, Steps: 202 | Train Loss: 0.7246589 Vali Loss: 0.7166411 Vali AUC: 0.5215303
Validation loss decreased (inf --> 0.716641).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7287601
	speed: 0.5574s/iter; left time: 11091.5978s
	iters: 200, epoch: 2 | loss: 0.6885144
	speed: 0.0315s/iter; left time: 624.2107s
Epoch: 2 cost time: 24.957007884979248
Epoch: 2, Steps: 202 | Train Loss: 0.7047231 Vali Loss: 0.6957303 Vali AUC: 0.5301011
Validation loss decreased (0.716641 --> 0.695730).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6845807
	speed: 0.5577s/iter; left time: 10984.8628s
	iters: 200, epoch: 3 | loss: 0.6873254
	speed: 0.0316s/iter; left time: 618.8548s
Epoch: 3 cost time: 25.02907967567444
Epoch: 3, Steps: 202 | Train Loss: 0.6974276 Vali Loss: 0.6916025 Vali AUC: 0.5343676
Validation loss decreased (0.695730 --> 0.691602).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6783152
	speed: 0.5592s/iter; left time: 10901.5282s
	iters: 200, epoch: 4 | loss: 0.7006292
	speed: 0.0316s/iter; left time: 612.1453s
Epoch: 4 cost time: 24.852789878845215
Epoch: 4, Steps: 202 | Train Loss: 0.6934613 Vali Loss: 0.6910430 Vali AUC: 0.5389111
Validation loss decreased (0.691602 --> 0.691043).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7318741
	speed: 0.5599s/iter; left time: 10802.2410s
	iters: 200, epoch: 5 | loss: 0.6596661
	speed: 0.0316s/iter; left time: 606.5860s
Epoch: 5 cost time: 25.055288553237915
Epoch: 5, Steps: 202 | Train Loss: 0.6919643 Vali Loss: 0.6952923 Vali AUC: 0.5416889
EarlyStopping counter: 1 out of 25
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6885940
	speed: 0.5575s/iter; left time: 10642.7492s
	iters: 200, epoch: 6 | loss: 0.7021715
	speed: 0.0316s/iter; left time: 600.3036s
Epoch: 6 cost time: 25.025489807128906
Epoch: 6, Steps: 202 | Train Loss: 0.6892857 Vali Loss: 0.6969014 Vali AUC: 0.5432946
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7383196
	speed: 0.5580s/iter; left time: 10539.2959s
	iters: 200, epoch: 7 | loss: 0.6778487
	speed: 0.0316s/iter; left time: 593.0039s
Epoch: 7 cost time: 24.942729949951172
Epoch: 7, Steps: 202 | Train Loss: 0.6884758 Vali Loss: 0.6963370 Vali AUC: 0.5456026
EarlyStopping counter: 3 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6649480
	speed: 0.5564s/iter; left time: 10398.1862s
	iters: 200, epoch: 8 | loss: 0.6679670
	speed: 0.0316s/iter; left time: 586.6622s
Epoch: 8 cost time: 24.818790435791016
Epoch: 8, Steps: 202 | Train Loss: 0.6887906 Vali Loss: 0.6886444 Vali AUC: 0.5506487
Validation loss decreased (0.691043 --> 0.688644).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6985724
	speed: 0.5580s/iter; left time: 10314.5071s
	iters: 200, epoch: 9 | loss: 0.6909415
	speed: 0.0316s/iter; left time: 580.2242s
Epoch: 9 cost time: 24.948839902877808
Epoch: 9, Steps: 202 | Train Loss: 0.6862159 Vali Loss: 0.6897560 Vali AUC: 0.5449572
EarlyStopping counter: 1 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6954848
	speed: 0.5574s/iter; left time: 10190.7485s
	iters: 200, epoch: 10 | loss: 0.7042279
	speed: 0.0316s/iter; left time: 573.6856s
Epoch: 10 cost time: 24.92055058479309
Epoch: 10, Steps: 202 | Train Loss: 0.6863854 Vali Loss: 0.6941673 Vali AUC: 0.5393896
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6921117
	speed: 0.5560s/iter; left time: 10052.6249s
	iters: 200, epoch: 11 | loss: 0.6658571
	speed: 0.0315s/iter; left time: 567.2183s
Epoch: 11 cost time: 24.86949896812439
Epoch: 11, Steps: 202 | Train Loss: 0.6869632 Vali Loss: 0.6921833 Vali AUC: 0.5414961
EarlyStopping counter: 3 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7050673
	speed: 0.5578s/iter; left time: 9973.5410s
	iters: 200, epoch: 12 | loss: 0.6827061
	speed: 0.0316s/iter; left time: 560.9778s
Epoch: 12 cost time: 25.03641676902771
Epoch: 12, Steps: 202 | Train Loss: 0.6836028 Vali Loss: 0.6906475 Vali AUC: 0.5454253
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7102728
	speed: 0.5584s/iter; left time: 9871.4563s
	iters: 200, epoch: 13 | loss: 0.6886907
	speed: 0.0316s/iter; left time: 555.1819s
Epoch: 13 cost time: 24.94643759727478
Epoch: 13, Steps: 202 | Train Loss: 0.6832604 Vali Loss: 0.6912935 Vali AUC: 0.5346034
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6842620
	speed: 0.5561s/iter; left time: 9718.6483s
	iters: 200, epoch: 14 | loss: 0.6913354
	speed: 0.0315s/iter; left time: 547.6080s
Epoch: 14 cost time: 24.887701988220215
Epoch: 14, Steps: 202 | Train Loss: 0.6833663 Vali Loss: 0.6917936 Vali AUC: 0.5372279
EarlyStopping counter: 6 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6750761
	speed: 0.5578s/iter; left time: 9635.0879s
	iters: 200, epoch: 15 | loss: 0.7150773
	speed: 0.0316s/iter; left time: 541.8213s
Epoch: 15 cost time: 24.96551251411438
Epoch: 15, Steps: 202 | Train Loss: 0.6836601 Vali Loss: 0.6898551 Vali AUC: 0.5372193
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6846921
	speed: 0.5578s/iter; left time: 9522.6355s
	iters: 200, epoch: 16 | loss: 0.6846888
	speed: 0.0316s/iter; left time: 535.5306s
Epoch: 16 cost time: 25.012710332870483
Epoch: 16, Steps: 202 | Train Loss: 0.6800110 Vali Loss: 0.6901134 Vali AUC: 0.5445682
EarlyStopping counter: 8 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6610174
	speed: 0.5571s/iter; left time: 9398.4701s
	iters: 200, epoch: 17 | loss: 0.6455433
	speed: 0.0315s/iter; left time: 528.9514s
Epoch: 17 cost time: 24.91525912284851
Epoch: 17, Steps: 202 | Train Loss: 0.6794181 Vali Loss: 0.6910193 Vali AUC: 0.5501564
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6788397
	speed: 0.5569s/iter; left time: 9282.1859s
	iters: 200, epoch: 18 | loss: 0.6753695
	speed: 0.0315s/iter; left time: 522.5498s
Epoch: 18 cost time: 24.92581009864807
Epoch: 18, Steps: 202 | Train Loss: 0.6749979 Vali Loss: 0.6898647 Vali AUC: 0.5442360
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6990665
	speed: 0.5560s/iter; left time: 9154.6767s
	iters: 200, epoch: 19 | loss: 0.6674852
	speed: 0.0316s/iter; left time: 516.4818s
Epoch: 19 cost time: 24.94974684715271
Epoch: 19, Steps: 202 | Train Loss: 0.6739729 Vali Loss: 0.6929039 Vali AUC: 0.5432877
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6612455
	speed: 0.5586s/iter; left time: 9083.8069s
	iters: 200, epoch: 20 | loss: 0.6659048
	speed: 0.0324s/iter; left time: 523.4167s
Epoch: 20 cost time: 25.03360366821289
Epoch: 20, Steps: 202 | Train Loss: 0.6740915 Vali Loss: 0.6916563 Vali AUC: 0.5532406
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6521119
	speed: 0.5571s/iter; left time: 8948.0683s
	iters: 200, epoch: 21 | loss: 0.6620283
	speed: 0.0316s/iter; left time: 504.2275s
Epoch: 21 cost time: 24.976808309555054
Epoch: 21, Steps: 202 | Train Loss: 0.6726931 Vali Loss: 0.6978248 Vali AUC: 0.5521976
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6743657
	speed: 0.5593s/iter; left time: 8870.0435s
	iters: 200, epoch: 22 | loss: 0.7289304
	speed: 0.0316s/iter; left time: 497.5343s
Epoch: 22 cost time: 24.974115133285522
Epoch: 22, Steps: 202 | Train Loss: 0.6725674 Vali Loss: 0.6947343 Vali AUC: 0.5448040
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6768306
	speed: 0.5557s/iter; left time: 8699.8136s
	iters: 200, epoch: 23 | loss: 0.6793423
	speed: 0.0316s/iter; left time: 491.6535s
Epoch: 23 cost time: 24.878116846084595
Epoch: 23, Steps: 202 | Train Loss: 0.6714901 Vali Loss: 0.6906785 Vali AUC: 0.5479931
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6563302
	speed: 0.5557s/iter; left time: 8589.0618s
	iters: 200, epoch: 24 | loss: 0.6649414
	speed: 0.0316s/iter; left time: 484.7363s
Epoch: 24 cost time: 24.894591093063354
Epoch: 24, Steps: 202 | Train Loss: 0.6693206 Vali Loss: 0.6931984 Vali AUC: 0.5525659
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6939546
	speed: 0.5573s/iter; left time: 8500.3494s
	iters: 200, epoch: 25 | loss: 0.6470758
	speed: 0.0316s/iter; left time: 478.3386s
Epoch: 25 cost time: 24.948338747024536
Epoch: 25, Steps: 202 | Train Loss: 0.6674959 Vali Loss: 0.7019825 Vali AUC: 0.5499602
EarlyStopping counter: 17 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6280950
	speed: 0.5589s/iter; left time: 8412.3645s
	iters: 200, epoch: 26 | loss: 0.6679474
	speed: 0.0316s/iter; left time: 471.8612s
Epoch: 26 cost time: 24.957682847976685
Epoch: 26, Steps: 202 | Train Loss: 0.6663911 Vali Loss: 0.6951918 Vali AUC: 0.5449038
EarlyStopping counter: 18 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6481085
	speed: 0.5574s/iter; left time: 8277.0430s
	iters: 200, epoch: 27 | loss: 0.6566142
	speed: 0.0316s/iter; left time: 465.7661s
Epoch: 27 cost time: 24.918079376220703
Epoch: 27, Steps: 202 | Train Loss: 0.6667862 Vali Loss: 0.6934607 Vali AUC: 0.5444013
EarlyStopping counter: 19 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6586260
	speed: 0.5604s/iter; left time: 8208.8180s
	iters: 200, epoch: 28 | loss: 0.6844013
	speed: 0.0316s/iter; left time: 459.2653s
Epoch: 28 cost time: 25.13429307937622
Epoch: 28, Steps: 202 | Train Loss: 0.6652329 Vali Loss: 0.6962143 Vali AUC: 0.5527724
EarlyStopping counter: 20 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6879079
	speed: 0.5609s/iter; left time: 8102.1038s
	iters: 200, epoch: 29 | loss: 0.6605858
	speed: 0.0316s/iter; left time: 452.9657s
Epoch: 29 cost time: 25.275693655014038
Epoch: 29, Steps: 202 | Train Loss: 0.6640626 Vali Loss: 0.6968473 Vali AUC: 0.5496401
EarlyStopping counter: 21 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6461932
	speed: 0.5589s/iter; left time: 7960.7948s
	iters: 200, epoch: 30 | loss: 0.6562842
	speed: 0.0316s/iter; left time: 446.9019s
Epoch: 30 cost time: 25.072474002838135
Epoch: 30, Steps: 202 | Train Loss: 0.6664624 Vali Loss: 0.6987907 Vali AUC: 0.5490429
EarlyStopping counter: 22 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6759518
	speed: 0.5592s/iter; left time: 7851.7679s
	iters: 200, epoch: 31 | loss: 0.6595517
	speed: 0.0316s/iter; left time: 439.9834s
Epoch: 31 cost time: 25.041523456573486
Epoch: 31, Steps: 202 | Train Loss: 0.6636303 Vali Loss: 0.6958324 Vali AUC: 0.5430881
EarlyStopping counter: 23 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6880369
	speed: 0.5596s/iter; left time: 7744.5113s
	iters: 200, epoch: 32 | loss: 0.6839644
	speed: 0.0316s/iter; left time: 433.5847s
Epoch: 32 cost time: 25.0140163898468
Epoch: 32, Steps: 202 | Train Loss: 0.6638744 Vali Loss: 0.6974706 Vali AUC: 0.5440037
EarlyStopping counter: 24 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6378961
	speed: 0.5598s/iter; left time: 7633.7948s
	iters: 200, epoch: 33 | loss: 0.5991578
	speed: 0.0316s/iter; left time: 427.5461s
Epoch: 33 cost time: 24.895131587982178
Epoch: 33, Steps: 202 | Train Loss: 0.6625425 Vali Loss: 0.6978214 Vali AUC: 0.5441362
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1078
Accuracy: 0.5538033395176253, AUC: 0.5506486622309574, Sensitivity: 0.274582560296846, Specificity: 0.8330241187384044, PPV: 0.6218487394957983, NPV: 0.5345238095238095, F1: 0.380952380952381
