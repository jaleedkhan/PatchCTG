Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=0, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_6', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9676
Dataset loaded and preprocessed.
val set size: 1080
Dataset loaded and preprocessed.
test set size: 1080
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1080
loading model
Accuracy: 0.5268518518518519, AUC: 0.5292901234567902, Sensitivity: 0.35185185185185186, Specificity: 0.7018518518518518, PPV: 0.5413105413105413, NPV: 0.5198902606310014, F1: 0.4264870931537598
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.6927952
	speed: 0.0150s/iter; left time: 300.8418s
	iters: 200, epoch: 1 | loss: 0.6870611
	speed: 0.0149s/iter; left time: 298.7605s
Epoch: 1 cost time: 3.01751446723938
Epoch: 1, Steps: 202 | Train Loss: 0.6976080 Vali Loss: 0.6978254 Vali AUC: 0.5315415
Validation loss decreased (inf --> 0.697825).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7221162
	speed: 0.0217s/iter; left time: 430.9191s
	iters: 200, epoch: 2 | loss: 0.6898777
	speed: 0.0149s/iter; left time: 295.6013s
Epoch: 2 cost time: 3.014132261276245
Epoch: 2, Steps: 202 | Train Loss: 0.6987536 Vali Loss: 0.6976613 Vali AUC: 0.5296914
Validation loss decreased (0.697825 --> 0.697661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6967899
	speed: 0.0216s/iter; left time: 425.2935s
	iters: 200, epoch: 3 | loss: 0.7008206
	speed: 0.0150s/iter; left time: 292.9837s
Epoch: 3 cost time: 3.0166337490081787
Epoch: 3, Steps: 202 | Train Loss: 0.6980131 Vali Loss: 0.6977365 Vali AUC: 0.5311728
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7050332
	speed: 0.0212s/iter; left time: 413.7347s
	iters: 200, epoch: 4 | loss: 0.7324960
	speed: 0.0150s/iter; left time: 289.9753s
Epoch: 4 cost time: 3.017591953277588
Epoch: 4, Steps: 202 | Train Loss: 0.6983708 Vali Loss: 0.6986489 Vali AUC: 0.5301783
EarlyStopping counter: 2 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7012602
	speed: 0.0212s/iter; left time: 408.5539s
	iters: 200, epoch: 5 | loss: 0.7102846
	speed: 0.0149s/iter; left time: 286.9027s
Epoch: 5 cost time: 3.0121614933013916
Epoch: 5, Steps: 202 | Train Loss: 0.6983021 Vali Loss: 0.6967730 Vali AUC: 0.5320199
Validation loss decreased (0.697661 --> 0.696773).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6753027
	speed: 0.0216s/iter; left time: 412.9527s
	iters: 200, epoch: 6 | loss: 0.6854557
	speed: 0.0158s/iter; left time: 299.4621s
Epoch: 6 cost time: 3.1016132831573486
Epoch: 6, Steps: 202 | Train Loss: 0.6967056 Vali Loss: 0.6975096 Vali AUC: 0.5307956
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7336038
	speed: 0.0228s/iter; left time: 430.8575s
	iters: 200, epoch: 7 | loss: 0.7051424
	speed: 0.0161s/iter; left time: 301.6024s
Epoch: 7 cost time: 3.232701063156128
Epoch: 7, Steps: 202 | Train Loss: 0.6986411 Vali Loss: 0.6971394 Vali AUC: 0.5306927
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6872115
	speed: 0.0229s/iter; left time: 427.5591s
	iters: 200, epoch: 8 | loss: 0.7146730
	speed: 0.0162s/iter; left time: 300.5226s
Epoch: 8 cost time: 3.255411386489868
Epoch: 8, Steps: 202 | Train Loss: 0.6986951 Vali Loss: 0.6966038 Vali AUC: 0.5307270
Validation loss decreased (0.696773 --> 0.696604).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7304158
	speed: 0.0234s/iter; left time: 431.9886s
	iters: 200, epoch: 9 | loss: 0.7079452
	speed: 0.0162s/iter; left time: 297.6303s
Epoch: 9 cost time: 3.2601261138916016
Epoch: 9, Steps: 202 | Train Loss: 0.6987973 Vali Loss: 0.6973131 Vali AUC: 0.5287586
EarlyStopping counter: 1 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6840145
	speed: 0.0232s/iter; left time: 423.5543s
	iters: 200, epoch: 10 | loss: 0.6893802
	speed: 0.0162s/iter; left time: 294.8406s
Epoch: 10 cost time: 3.284621238708496
Epoch: 10, Steps: 202 | Train Loss: 0.6964715 Vali Loss: 0.6967961 Vali AUC: 0.5316512
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6726069
	speed: 0.0232s/iter; left time: 418.7548s
	iters: 200, epoch: 11 | loss: 0.7007458
	speed: 0.0161s/iter; left time: 288.9480s
Epoch: 11 cost time: 3.265024423599243
Epoch: 11, Steps: 202 | Train Loss: 0.6981372 Vali Loss: 0.6977056 Vali AUC: 0.5320062
EarlyStopping counter: 3 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6817757
	speed: 0.0229s/iter; left time: 409.3647s
	iters: 200, epoch: 12 | loss: 0.7348067
	speed: 0.0163s/iter; left time: 289.3334s
Epoch: 12 cost time: 3.273632049560547
Epoch: 12, Steps: 202 | Train Loss: 0.6993436 Vali Loss: 0.6978335 Vali AUC: 0.5319136
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7063798
	speed: 0.0230s/iter; left time: 406.9861s
	iters: 200, epoch: 13 | loss: 0.7411908
	speed: 0.0161s/iter; left time: 283.8627s
Epoch: 13 cost time: 3.260767936706543
Epoch: 13, Steps: 202 | Train Loss: 0.6977177 Vali Loss: 0.6980123 Vali AUC: 0.5290809
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6790417
	speed: 0.0228s/iter; left time: 398.0169s
	iters: 200, epoch: 14 | loss: 0.7352329
	speed: 0.0159s/iter; left time: 275.7087s
Epoch: 14 cost time: 3.2119455337524414
Epoch: 14, Steps: 202 | Train Loss: 0.6984135 Vali Loss: 0.6971907 Vali AUC: 0.5294839
EarlyStopping counter: 6 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7122347
	speed: 0.0230s/iter; left time: 397.4912s
	iters: 200, epoch: 15 | loss: 0.6955566
	speed: 0.0164s/iter; left time: 282.2847s
Epoch: 15 cost time: 3.2992517948150635
Epoch: 15, Steps: 202 | Train Loss: 0.6979096 Vali Loss: 0.6975719 Vali AUC: 0.5307665
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6973379
	speed: 0.0233s/iter; left time: 397.0598s
	iters: 200, epoch: 16 | loss: 0.7123558
	speed: 0.0163s/iter; left time: 276.3947s
Epoch: 16 cost time: 3.2976815700531006
Epoch: 16, Steps: 202 | Train Loss: 0.6967186 Vali Loss: 0.6960634 Vali AUC: 0.5291890
Validation loss decreased (0.696604 --> 0.696063).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6721804
	speed: 0.0237s/iter; left time: 400.6280s
	iters: 200, epoch: 17 | loss: 0.6970674
	speed: 0.0165s/iter; left time: 276.5625s
Epoch: 17 cost time: 3.3327293395996094
Epoch: 17, Steps: 202 | Train Loss: 0.6985245 Vali Loss: 0.6974869 Vali AUC: 0.5316804
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.7089373
	speed: 0.0234s/iter; left time: 389.7072s
	iters: 200, epoch: 18 | loss: 0.6877331
	speed: 0.0165s/iter; left time: 274.1836s
Epoch: 18 cost time: 3.329305410385132
Epoch: 18, Steps: 202 | Train Loss: 0.6987072 Vali Loss: 0.6968364 Vali AUC: 0.5306756
EarlyStopping counter: 2 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6706864
	speed: 0.0233s/iter; left time: 383.3951s
	iters: 200, epoch: 19 | loss: 0.6818670
	speed: 0.0165s/iter; left time: 269.6611s
Epoch: 19 cost time: 3.312835693359375
Epoch: 19, Steps: 202 | Train Loss: 0.6977198 Vali Loss: 0.6976776 Vali AUC: 0.5307767
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.7127975
	speed: 0.0236s/iter; left time: 383.9672s
	iters: 200, epoch: 20 | loss: 0.6976189
	speed: 0.0165s/iter; left time: 266.5179s
Epoch: 20 cost time: 3.3379967212677
Epoch: 20, Steps: 202 | Train Loss: 0.6975877 Vali Loss: 0.6960172 Vali AUC: 0.5299726
Validation loss decreased (0.696063 --> 0.696017).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6979532
	speed: 0.0240s/iter; left time: 385.7955s
	iters: 200, epoch: 21 | loss: 0.6857077
	speed: 0.0164s/iter; left time: 261.8016s
Epoch: 21 cost time: 3.329773426055908
Epoch: 21, Steps: 202 | Train Loss: 0.6975555 Vali Loss: 0.6969759 Vali AUC: 0.5312654
EarlyStopping counter: 1 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7211802
	speed: 0.0236s/iter; left time: 374.5055s
	iters: 200, epoch: 22 | loss: 0.7083857
	speed: 0.0167s/iter; left time: 263.7843s
Epoch: 22 cost time: 3.37449312210083
Epoch: 22, Steps: 202 | Train Loss: 0.6978259 Vali Loss: 0.6971291 Vali AUC: 0.5313683
EarlyStopping counter: 2 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6777091
	speed: 0.0231s/iter; left time: 361.4236s
	iters: 200, epoch: 23 | loss: 0.7205188
	speed: 0.0165s/iter; left time: 257.3201s
Epoch: 23 cost time: 3.3131566047668457
Epoch: 23, Steps: 202 | Train Loss: 0.6981825 Vali Loss: 0.6961543 Vali AUC: 0.5304681
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.7138729
	speed: 0.0236s/iter; left time: 364.9581s
	iters: 200, epoch: 24 | loss: 0.6796058
	speed: 0.0166s/iter; left time: 255.5310s
Epoch: 24 cost time: 3.3543272018432617
Epoch: 24, Steps: 202 | Train Loss: 0.6970728 Vali Loss: 0.6959607 Vali AUC: 0.5292181
Validation loss decreased (0.696017 --> 0.695961).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6946872
	speed: 0.0239s/iter; left time: 364.7237s
	iters: 200, epoch: 25 | loss: 0.7007974
	speed: 0.0161s/iter; left time: 243.8548s
Epoch: 25 cost time: 3.2804207801818848
Epoch: 25, Steps: 202 | Train Loss: 0.6984313 Vali Loss: 0.6969640 Vali AUC: 0.5312020
EarlyStopping counter: 1 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.7015651
	speed: 0.0232s/iter; left time: 348.4407s
	iters: 200, epoch: 26 | loss: 0.7021939
	speed: 0.0162s/iter; left time: 242.1329s
Epoch: 26 cost time: 3.2754201889038086
Epoch: 26, Steps: 202 | Train Loss: 0.6977326 Vali Loss: 0.6978334 Vali AUC: 0.5310425
EarlyStopping counter: 2 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6714789
	speed: 0.0232s/iter; left time: 343.9284s
	iters: 200, epoch: 27 | loss: 0.7034950
	speed: 0.0162s/iter; left time: 238.9747s
Epoch: 27 cost time: 3.277308940887451
Epoch: 27, Steps: 202 | Train Loss: 0.6971623 Vali Loss: 0.6980408 Vali AUC: 0.5327058
EarlyStopping counter: 3 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6854589
	speed: 0.0229s/iter; left time: 335.9488s
	iters: 200, epoch: 28 | loss: 0.7042395
	speed: 0.0162s/iter; left time: 235.4961s
Epoch: 28 cost time: 3.2622251510620117
Epoch: 28, Steps: 202 | Train Loss: 0.6977298 Vali Loss: 0.6957408 Vali AUC: 0.5297668
Validation loss decreased (0.695961 --> 0.695741).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6716220
	speed: 0.0236s/iter; left time: 340.7930s
	iters: 200, epoch: 29 | loss: 0.7086662
	speed: 0.0162s/iter; left time: 232.0540s
Epoch: 29 cost time: 3.2853498458862305
Epoch: 29, Steps: 202 | Train Loss: 0.6971376 Vali Loss: 0.6973568 Vali AUC: 0.5302040
EarlyStopping counter: 1 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.7142355
	speed: 0.0230s/iter; left time: 328.0662s
	iters: 200, epoch: 30 | loss: 0.6801131
	speed: 0.0162s/iter; left time: 229.0197s
Epoch: 30 cost time: 3.264781951904297
Epoch: 30, Steps: 202 | Train Loss: 0.6979796 Vali Loss: 0.6966892 Vali AUC: 0.5305504
EarlyStopping counter: 2 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6976233
	speed: 0.0229s/iter; left time: 322.0239s
	iters: 200, epoch: 31 | loss: 0.6730893
	speed: 0.0161s/iter; left time: 224.2991s
Epoch: 31 cost time: 3.2490134239196777
Epoch: 31, Steps: 202 | Train Loss: 0.6980680 Vali Loss: 0.6968426 Vali AUC: 0.5303395
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.7348029
	speed: 0.0230s/iter; left time: 318.3726s
	iters: 200, epoch: 32 | loss: 0.6685948
	speed: 0.0162s/iter; left time: 222.8293s
Epoch: 32 cost time: 3.2650649547576904
Epoch: 32, Steps: 202 | Train Loss: 0.6983185 Vali Loss: 0.6962505 Vali AUC: 0.5310219
EarlyStopping counter: 4 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6882820
	speed: 0.0235s/iter; left time: 320.4903s
	iters: 200, epoch: 33 | loss: 0.7023214
	speed: 0.0166s/iter; left time: 224.7194s
Epoch: 33 cost time: 3.343930244445801
Epoch: 33, Steps: 202 | Train Loss: 0.6962233 Vali Loss: 0.6980854 Vali AUC: 0.5315038
EarlyStopping counter: 5 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.7101640
	speed: 0.0237s/iter; left time: 318.8932s
	iters: 200, epoch: 34 | loss: 0.7061536
	speed: 0.0167s/iter; left time: 222.7161s
Epoch: 34 cost time: 3.3693606853485107
Epoch: 34, Steps: 202 | Train Loss: 0.6977854 Vali Loss: 0.6969397 Vali AUC: 0.5292730
EarlyStopping counter: 6 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.6883537
	speed: 0.0236s/iter; left time: 311.7266s
	iters: 200, epoch: 35 | loss: 0.6930045
	speed: 0.0166s/iter; left time: 218.2253s
Epoch: 35 cost time: 3.3558313846588135
Epoch: 35, Steps: 202 | Train Loss: 0.6978333 Vali Loss: 0.6971985 Vali AUC: 0.5309088
EarlyStopping counter: 7 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.7159564
	speed: 0.0237s/iter; left time: 308.7073s
	iters: 200, epoch: 36 | loss: 0.6838803
	speed: 0.0165s/iter; left time: 213.5633s
Epoch: 36 cost time: 3.3417835235595703
Epoch: 36, Steps: 202 | Train Loss: 0.6970877 Vali Loss: 0.6969442 Vali AUC: 0.5314712
EarlyStopping counter: 8 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.6885113
	speed: 0.0238s/iter; left time: 305.5747s
	iters: 200, epoch: 37 | loss: 0.7027156
	speed: 0.0164s/iter; left time: 208.9985s
Epoch: 37 cost time: 3.355170249938965
Epoch: 37, Steps: 202 | Train Loss: 0.6976312 Vali Loss: 0.6972486 Vali AUC: 0.5317061
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6911979
	speed: 0.0230s/iter; left time: 290.3645s
	iters: 200, epoch: 38 | loss: 0.7018449
	speed: 0.0161s/iter; left time: 202.1081s
Epoch: 38 cost time: 3.2605807781219482
Epoch: 38, Steps: 202 | Train Loss: 0.6984515 Vali Loss: 0.6976529 Vali AUC: 0.5325874
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.7228426
	speed: 0.0232s/iter; left time: 288.6151s
	iters: 200, epoch: 39 | loss: 0.6995201
	speed: 0.0164s/iter; left time: 202.6547s
Epoch: 39 cost time: 3.3078694343566895
Epoch: 39, Steps: 202 | Train Loss: 0.6975286 Vali Loss: 0.6969368 Vali AUC: 0.5307167
EarlyStopping counter: 11 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7137351
	speed: 0.0231s/iter; left time: 282.3059s
	iters: 200, epoch: 40 | loss: 0.6918691
	speed: 0.0163s/iter; left time: 197.0458s
Epoch: 40 cost time: 3.2869460582733154
Epoch: 40, Steps: 202 | Train Loss: 0.6979242 Vali Loss: 0.6974094 Vali AUC: 0.5307939
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.6873564
	speed: 0.0230s/iter; left time: 276.6605s
	iters: 200, epoch: 41 | loss: 0.6653666
	speed: 0.0161s/iter; left time: 192.1062s
Epoch: 41 cost time: 3.2628049850463867
Epoch: 41, Steps: 202 | Train Loss: 0.6976839 Vali Loss: 0.6972005 Vali AUC: 0.5312380
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.7315027
	speed: 0.0230s/iter; left time: 272.3818s
	iters: 200, epoch: 42 | loss: 0.6918983
	speed: 0.0161s/iter; left time: 188.4408s
Epoch: 42 cost time: 3.260363817214966
Epoch: 42, Steps: 202 | Train Loss: 0.6976625 Vali Loss: 0.6977319 Vali AUC: 0.5306722
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.6843566
	speed: 0.0229s/iter; left time: 266.3947s
	iters: 200, epoch: 43 | loss: 0.6904612
	speed: 0.0162s/iter; left time: 186.6318s
Epoch: 43 cost time: 3.262038230895996
Epoch: 43, Steps: 202 | Train Loss: 0.6964997 Vali Loss: 0.6977743 Vali AUC: 0.5299314
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.6895524
	speed: 0.0230s/iter; left time: 262.9963s
	iters: 200, epoch: 44 | loss: 0.7129238
	speed: 0.0162s/iter; left time: 183.2191s
Epoch: 44 cost time: 3.2763237953186035
Epoch: 44, Steps: 202 | Train Loss: 0.6968599 Vali Loss: 0.6970964 Vali AUC: 0.5302932
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.6676707
	speed: 0.0232s/iter; left time: 259.7928s
	iters: 200, epoch: 45 | loss: 0.6797788
	speed: 0.0164s/iter; left time: 182.2212s
Epoch: 45 cost time: 3.303138494491577
Epoch: 45, Steps: 202 | Train Loss: 0.6961506 Vali Loss: 0.6983872 Vali AUC: 0.5297668
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.7034459
	speed: 0.0231s/iter; left time: 253.8413s
	iters: 200, epoch: 46 | loss: 0.7328094
	speed: 0.0163s/iter; left time: 177.8721s
Epoch: 46 cost time: 3.2795374393463135
Epoch: 46, Steps: 202 | Train Loss: 0.6976929 Vali Loss: 0.6962201 Vali AUC: 0.5310682
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.6643767
	speed: 0.0228s/iter; left time: 246.5601s
	iters: 200, epoch: 47 | loss: 0.7057815
	speed: 0.0161s/iter; left time: 172.3086s
Epoch: 47 cost time: 3.2418172359466553
Epoch: 47, Steps: 202 | Train Loss: 0.6986483 Vali Loss: 0.6969295 Vali AUC: 0.5307150
EarlyStopping counter: 19 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.7138036
	speed: 0.0231s/iter; left time: 244.6599s
	iters: 200, epoch: 48 | loss: 0.7137696
	speed: 0.0161s/iter; left time: 168.9995s
Epoch: 48 cost time: 3.2572085857391357
Epoch: 48, Steps: 202 | Train Loss: 0.6971356 Vali Loss: 0.6977304 Vali AUC: 0.5320473
EarlyStopping counter: 20 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.7219400
	speed: 0.0232s/iter; left time: 240.9356s
	iters: 200, epoch: 49 | loss: 0.6639529
	speed: 0.0167s/iter; left time: 172.2600s
Epoch: 49 cost time: 3.333153486251831
Epoch: 49, Steps: 202 | Train Loss: 0.6977397 Vali Loss: 0.6966322 Vali AUC: 0.5311248
EarlyStopping counter: 21 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.7095639
	speed: 0.0236s/iter; left time: 241.2412s
	iters: 200, epoch: 50 | loss: 0.7000219
	speed: 0.0164s/iter; left time: 166.0155s
Epoch: 50 cost time: 3.3358070850372314
Epoch: 50, Steps: 202 | Train Loss: 0.6979125 Vali Loss: 0.6975608 Vali AUC: 0.5310425
EarlyStopping counter: 22 out of 25
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.7480873
	speed: 0.0231s/iter; left time: 230.8465s
	iters: 200, epoch: 51 | loss: 0.6835586
	speed: 0.0161s/iter; left time: 159.8121s
Epoch: 51 cost time: 3.2670273780822754
Epoch: 51, Steps: 202 | Train Loss: 0.6984240 Vali Loss: 0.6973383 Vali AUC: 0.5305436
EarlyStopping counter: 23 out of 25
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.7072255
	speed: 0.0230s/iter; left time: 225.6020s
	iters: 200, epoch: 52 | loss: 0.7375947
	speed: 0.0161s/iter; left time: 156.5198s
Epoch: 52 cost time: 3.266725540161133
Epoch: 52, Steps: 202 | Train Loss: 0.6972810 Vali Loss: 0.6975067 Vali AUC: 0.5315398
EarlyStopping counter: 24 out of 25
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.6896658
	speed: 0.0230s/iter; left time: 220.8071s
	iters: 200, epoch: 53 | loss: 0.7240206
	speed: 0.0162s/iter; left time: 153.5165s
Epoch: 53 cost time: 3.260697364807129
Epoch: 53, Steps: 202 | Train Loss: 0.6967374 Vali Loss: 0.6966320 Vali AUC: 0.5307510
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1080
Accuracy: 0.5333333333333333, AUC: 0.5297668038408778, Sensitivity: 0.8703703703703703, Specificity: 0.1962962962962963, PPV: 0.5199115044247787, NPV: 0.6022727272727273, F1: 0.6509695290858726
