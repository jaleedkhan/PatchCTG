Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_6', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9676
Dataset loaded and preprocessed.
val set size: 1080
Dataset loaded and preprocessed.
test set size: 1080
	iters: 100, epoch: 1 | loss: 0.7261879
	speed: 0.2101s/iter; left time: 4222.7826s
	iters: 200, epoch: 1 | loss: 0.7054156
	speed: 0.0316s/iter; left time: 631.9900s
Epoch: 1 cost time: 25.443536043167114
Epoch: 1, Steps: 202 | Train Loss: 0.7247948 Vali Loss: 0.7151723 Vali AUC: 0.5052949
Validation loss decreased (inf --> 0.715172).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7483420
	speed: 0.5590s/iter; left time: 11124.3665s
	iters: 200, epoch: 2 | loss: 0.7117626
	speed: 0.0316s/iter; left time: 625.5022s
Epoch: 2 cost time: 24.95619249343872
Epoch: 2, Steps: 202 | Train Loss: 0.7039450 Vali Loss: 0.6967669 Vali AUC: 0.5329304
Validation loss decreased (0.715172 --> 0.696767).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6971302
	speed: 0.5578s/iter; left time: 10987.5655s
	iters: 200, epoch: 3 | loss: 0.6764021
	speed: 0.0315s/iter; left time: 617.0275s
Epoch: 3 cost time: 24.947314500808716
Epoch: 3, Steps: 202 | Train Loss: 0.6952064 Vali Loss: 0.6991823 Vali AUC: 0.5451800
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6764120
	speed: 0.5591s/iter; left time: 10899.4587s
	iters: 200, epoch: 4 | loss: 0.6988322
	speed: 0.0315s/iter; left time: 611.4144s
Epoch: 4 cost time: 25.132976531982422
Epoch: 4, Steps: 202 | Train Loss: 0.6899537 Vali Loss: 0.7010125 Vali AUC: 0.5136008
EarlyStopping counter: 2 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7119302
	speed: 0.5595s/iter; left time: 10795.0203s
	iters: 200, epoch: 5 | loss: 0.6749893
	speed: 0.0316s/iter; left time: 606.2838s
Epoch: 5 cost time: 25.040225744247437
Epoch: 5, Steps: 202 | Train Loss: 0.6901460 Vali Loss: 0.7001505 Vali AUC: 0.5345713
EarlyStopping counter: 3 out of 25
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6881638
	speed: 0.5596s/iter; left time: 10683.0909s
	iters: 200, epoch: 6 | loss: 0.6461122
	speed: 0.0316s/iter; left time: 599.7082s
Epoch: 6 cost time: 25.051159143447876
Epoch: 6, Steps: 202 | Train Loss: 0.6877018 Vali Loss: 0.6968754 Vali AUC: 0.5409516
EarlyStopping counter: 4 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6903216
	speed: 0.5577s/iter; left time: 10533.4831s
	iters: 200, epoch: 7 | loss: 0.6982419
	speed: 0.0316s/iter; left time: 593.3603s
Epoch: 7 cost time: 24.92114496231079
Epoch: 7, Steps: 202 | Train Loss: 0.6876595 Vali Loss: 0.6960720 Vali AUC: 0.5181173
Validation loss decreased (0.696767 --> 0.696072).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6524003
	speed: 0.5578s/iter; left time: 10423.8480s
	iters: 200, epoch: 8 | loss: 0.6732841
	speed: 0.0316s/iter; left time: 586.8657s
Epoch: 8 cost time: 24.888118267059326
Epoch: 8, Steps: 202 | Train Loss: 0.6840809 Vali Loss: 0.7060865 Vali AUC: 0.5187071
EarlyStopping counter: 1 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7342712
	speed: 0.5575s/iter; left time: 10305.8639s
	iters: 200, epoch: 9 | loss: 0.6944135
	speed: 0.0316s/iter; left time: 580.4824s
Epoch: 9 cost time: 25.115927934646606
Epoch: 9, Steps: 202 | Train Loss: 0.6853018 Vali Loss: 0.7031206 Vali AUC: 0.5311094
EarlyStopping counter: 2 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6863322
	speed: 0.5591s/iter; left time: 10221.6581s
	iters: 200, epoch: 10 | loss: 0.7124639
	speed: 0.0316s/iter; left time: 574.6269s
Epoch: 10 cost time: 24.955360412597656
Epoch: 10, Steps: 202 | Train Loss: 0.6853199 Vali Loss: 0.7020381 Vali AUC: 0.5416701
EarlyStopping counter: 3 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6633614
	speed: 0.5591s/iter; left time: 10108.4374s
	iters: 200, epoch: 11 | loss: 0.7074027
	speed: 0.0316s/iter; left time: 567.9217s
Epoch: 11 cost time: 25.032907724380493
Epoch: 11, Steps: 202 | Train Loss: 0.6840115 Vali Loss: 0.6951631 Vali AUC: 0.5219084
Validation loss decreased (0.696072 --> 0.695163).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6800373
	speed: 0.5614s/iter; left time: 10037.9526s
	iters: 200, epoch: 12 | loss: 0.7022023
	speed: 0.0316s/iter; left time: 561.7436s
Epoch: 12 cost time: 25.082590579986572
Epoch: 12, Steps: 202 | Train Loss: 0.6812603 Vali Loss: 0.7002222 Vali AUC: 0.5271742
EarlyStopping counter: 1 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6721529
	speed: 0.5620s/iter; left time: 9934.3752s
	iters: 200, epoch: 13 | loss: 0.6726257
	speed: 0.0316s/iter; left time: 554.7965s
Epoch: 13 cost time: 25.036999464035034
Epoch: 13, Steps: 202 | Train Loss: 0.6792110 Vali Loss: 0.6962011 Vali AUC: 0.5339575
EarlyStopping counter: 2 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6735582
	speed: 0.5612s/iter; left time: 9806.7994s
	iters: 200, epoch: 14 | loss: 0.7032468
	speed: 0.0315s/iter; left time: 547.8282s
Epoch: 14 cost time: 25.077040910720825
Epoch: 14, Steps: 202 | Train Loss: 0.6776574 Vali Loss: 0.6944873 Vali AUC: 0.5297068
Validation loss decreased (0.695163 --> 0.694487).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6763796
	speed: 0.5580s/iter; left time: 9639.1267s
	iters: 200, epoch: 15 | loss: 0.6412350
	speed: 0.0316s/iter; left time: 542.1501s
Epoch: 15 cost time: 24.98592519760132
Epoch: 15, Steps: 202 | Train Loss: 0.6767544 Vali Loss: 0.6997105 Vali AUC: 0.5390364
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6893278
	speed: 0.5565s/iter; left time: 9499.6145s
	iters: 200, epoch: 16 | loss: 0.6934749
	speed: 0.0316s/iter; left time: 536.4101s
Epoch: 16 cost time: 24.96896505355835
Epoch: 16, Steps: 202 | Train Loss: 0.6758787 Vali Loss: 0.7015404 Vali AUC: 0.5313957
EarlyStopping counter: 2 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6738091
	speed: 0.5591s/iter; left time: 9431.2365s
	iters: 200, epoch: 17 | loss: 0.6866681
	speed: 0.0316s/iter; left time: 529.9408s
Epoch: 17 cost time: 24.970553159713745
Epoch: 17, Steps: 202 | Train Loss: 0.6745125 Vali Loss: 0.7017702 Vali AUC: 0.5331653
EarlyStopping counter: 3 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6808426
	speed: 0.5585s/iter; left time: 9308.9057s
	iters: 200, epoch: 18 | loss: 0.6896643
	speed: 0.0316s/iter; left time: 523.2249s
Epoch: 18 cost time: 25.03265142440796
Epoch: 18, Steps: 202 | Train Loss: 0.6710997 Vali Loss: 0.7045171 Vali AUC: 0.5392661
EarlyStopping counter: 4 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6779315
	speed: 0.5614s/iter; left time: 9244.1458s
	iters: 200, epoch: 19 | loss: 0.6594649
	speed: 0.0316s/iter; left time: 517.2412s
Epoch: 19 cost time: 25.096819639205933
Epoch: 19, Steps: 202 | Train Loss: 0.6704324 Vali Loss: 0.7031771 Vali AUC: 0.5364918
EarlyStopping counter: 5 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6748240
	speed: 0.5608s/iter; left time: 9120.9268s
	iters: 200, epoch: 20 | loss: 0.6681417
	speed: 0.0316s/iter; left time: 510.5999s
Epoch: 20 cost time: 25.183353185653687
Epoch: 20, Steps: 202 | Train Loss: 0.6716857 Vali Loss: 0.7008168 Vali AUC: 0.5313014
EarlyStopping counter: 6 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6973674
	speed: 0.5614s/iter; left time: 9016.4705s
	iters: 200, epoch: 21 | loss: 0.6723549
	speed: 0.0316s/iter; left time: 504.1480s
Epoch: 21 cost time: 25.074763774871826
Epoch: 21, Steps: 202 | Train Loss: 0.6696984 Vali Loss: 0.7028454 Vali AUC: 0.5387311
EarlyStopping counter: 7 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7097870
	speed: 0.5602s/iter; left time: 8884.3865s
	iters: 200, epoch: 22 | loss: 0.6604539
	speed: 0.0316s/iter; left time: 497.8410s
Epoch: 22 cost time: 25.102943897247314
Epoch: 22, Steps: 202 | Train Loss: 0.6675939 Vali Loss: 0.7056065 Vali AUC: 0.5247582
EarlyStopping counter: 8 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6822376
	speed: 0.5573s/iter; left time: 8725.4630s
	iters: 200, epoch: 23 | loss: 0.6861285
	speed: 0.0316s/iter; left time: 491.0173s
Epoch: 23 cost time: 24.982842683792114
Epoch: 23, Steps: 202 | Train Loss: 0.6653611 Vali Loss: 0.7066581 Vali AUC: 0.5337654
EarlyStopping counter: 9 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6810374
	speed: 0.5576s/iter; left time: 8617.8660s
	iters: 200, epoch: 24 | loss: 0.6957644
	speed: 0.0316s/iter; left time: 484.9823s
Epoch: 24 cost time: 25.014435052871704
Epoch: 24, Steps: 202 | Train Loss: 0.6664422 Vali Loss: 0.7037019 Vali AUC: 0.5325240
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6873586
	speed: 0.5601s/iter; left time: 8542.4652s
	iters: 200, epoch: 25 | loss: 0.6768097
	speed: 0.0316s/iter; left time: 478.5378s
Epoch: 25 cost time: 24.992051362991333
Epoch: 25, Steps: 202 | Train Loss: 0.6658564 Vali Loss: 0.7049043 Vali AUC: 0.5346948
EarlyStopping counter: 11 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6662536
	speed: 0.5585s/iter; left time: 8405.3402s
	iters: 200, epoch: 26 | loss: 0.6653978
	speed: 0.0316s/iter; left time: 471.8710s
Epoch: 26 cost time: 24.97752594947815
Epoch: 26, Steps: 202 | Train Loss: 0.6639913 Vali Loss: 0.7047106 Vali AUC: 0.5373868
EarlyStopping counter: 12 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6443254
	speed: 0.5587s/iter; left time: 8296.6611s
	iters: 200, epoch: 27 | loss: 0.6863164
	speed: 0.0316s/iter; left time: 465.6183s
Epoch: 27 cost time: 24.95395278930664
Epoch: 27, Steps: 202 | Train Loss: 0.6639934 Vali Loss: 0.7037423 Vali AUC: 0.5301835
EarlyStopping counter: 13 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6462568
	speed: 0.5618s/iter; left time: 8229.1652s
	iters: 200, epoch: 28 | loss: 0.6678836
	speed: 0.0316s/iter; left time: 459.6130s
Epoch: 28 cost time: 25.23880910873413
Epoch: 28, Steps: 202 | Train Loss: 0.6625261 Vali Loss: 0.7038612 Vali AUC: 0.5303361
EarlyStopping counter: 14 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6503052
	speed: 0.5619s/iter; left time: 8117.0640s
	iters: 200, epoch: 29 | loss: 0.6472169
	speed: 0.0316s/iter; left time: 453.0268s
Epoch: 29 cost time: 25.053535223007202
Epoch: 29, Steps: 202 | Train Loss: 0.6624791 Vali Loss: 0.7042452 Vali AUC: 0.5305453
EarlyStopping counter: 15 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6809866
	speed: 0.5636s/iter; left time: 8027.7138s
	iters: 200, epoch: 30 | loss: 0.6411083
	speed: 0.0316s/iter; left time: 446.6057s
Epoch: 30 cost time: 25.31069016456604
Epoch: 30, Steps: 202 | Train Loss: 0.6630282 Vali Loss: 0.7047058 Vali AUC: 0.5305778
EarlyStopping counter: 16 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6584902
	speed: 0.5574s/iter; left time: 7826.0031s
	iters: 200, epoch: 31 | loss: 0.6625007
	speed: 0.0316s/iter; left time: 440.3763s
Epoch: 31 cost time: 25.06514596939087
Epoch: 31, Steps: 202 | Train Loss: 0.6608926 Vali Loss: 0.7057644 Vali AUC: 0.5292901
EarlyStopping counter: 17 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6993728
	speed: 0.5599s/iter; left time: 7748.5932s
	iters: 200, epoch: 32 | loss: 0.6401179
	speed: 0.0316s/iter; left time: 433.8857s
Epoch: 32 cost time: 25.162764310836792
Epoch: 32, Steps: 202 | Train Loss: 0.6607321 Vali Loss: 0.7043343 Vali AUC: 0.5284859
EarlyStopping counter: 18 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6848758
	speed: 0.5600s/iter; left time: 7636.7989s
	iters: 200, epoch: 33 | loss: 0.6682441
	speed: 0.0316s/iter; left time: 427.2164s
Epoch: 33 cost time: 25.025002479553223
Epoch: 33, Steps: 202 | Train Loss: 0.6612262 Vali Loss: 0.7056559 Vali AUC: 0.5345525
EarlyStopping counter: 19 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.6770322
	speed: 0.5598s/iter; left time: 7520.7974s
	iters: 200, epoch: 34 | loss: 0.6566783
	speed: 0.0316s/iter; left time: 420.9736s
Epoch: 34 cost time: 24.953762769699097
Epoch: 34, Steps: 202 | Train Loss: 0.6623778 Vali Loss: 0.7028355 Vali AUC: 0.5305316
EarlyStopping counter: 20 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.5943990
	speed: 0.5571s/iter; left time: 7372.1610s
	iters: 200, epoch: 35 | loss: 0.6513510
	speed: 0.0316s/iter; left time: 414.6857s
Epoch: 35 cost time: 24.931992530822754
Epoch: 35, Steps: 202 | Train Loss: 0.6591000 Vali Loss: 0.7060654 Vali AUC: 0.5306344
EarlyStopping counter: 21 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6840401
	speed: 0.5630s/iter; left time: 7336.9021s
	iters: 200, epoch: 36 | loss: 0.6638264
	speed: 0.0316s/iter; left time: 408.1672s
Epoch: 36 cost time: 25.333197593688965
Epoch: 36, Steps: 202 | Train Loss: 0.6594517 Vali Loss: 0.7040497 Vali AUC: 0.5265175
EarlyStopping counter: 22 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.6743011
	speed: 0.5612s/iter; left time: 7200.0211s
	iters: 200, epoch: 37 | loss: 0.6633867
	speed: 0.0316s/iter; left time: 401.8383s
Epoch: 37 cost time: 25.09076762199402
Epoch: 37, Steps: 202 | Train Loss: 0.6593115 Vali Loss: 0.7059535 Vali AUC: 0.5253206
EarlyStopping counter: 23 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6813380
	speed: 0.5606s/iter; left time: 7078.4788s
	iters: 200, epoch: 38 | loss: 0.6131077
	speed: 0.0316s/iter; left time: 395.7016s
Epoch: 38 cost time: 25.09744143486023
Epoch: 38, Steps: 202 | Train Loss: 0.6601970 Vali Loss: 0.7058987 Vali AUC: 0.5239660
EarlyStopping counter: 24 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.7016836
	speed: 0.5593s/iter; left time: 6949.7222s
	iters: 200, epoch: 39 | loss: 0.6811904
	speed: 0.0316s/iter; left time: 389.1672s
Epoch: 39 cost time: 25.050402879714966
Epoch: 39, Steps: 202 | Train Loss: 0.6602329 Vali Loss: 0.7054839 Vali AUC: 0.5266684
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1080
Accuracy: 0.5425925925925926, AUC: 0.5297067901234568, Sensitivity: 0.21481481481481482, Specificity: 0.8703703703703703, PPV: 0.6236559139784946, NPV: 0.5257270693512305, F1: 0.3195592286501378
