Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_9', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9666
Dataset loaded and preprocessed.
val set size: 1090
Dataset loaded and preprocessed.
test set size: 1090
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
All layers except the classification head are frozen for linear probing.
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1090
loading model
Accuracy: 0.5376146788990825, AUC: 0.5335796650113627, Sensitivity: 0.3321100917431193, Specificity: 0.7431192660550459, PPV: 0.5638629283489096, NPV: 0.5266579973992198, F1: 0.41801385681293307
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.7317690
	speed: 0.1691s/iter; left time: 3399.7287s
	iters: 200, epoch: 1 | loss: 0.7242576
	speed: 0.0137s/iter; left time: 273.7842s
Epoch: 1 cost time: 19.47665023803711
Epoch: 1, Steps: 202 | Train Loss: 0.7105378 Vali Loss: 0.6986579 Vali AUC: 0.5334096
Validation loss decreased (inf --> 0.698658).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7184622
	speed: 0.4793s/iter; left time: 9536.7008s
	iters: 200, epoch: 2 | loss: 0.7292496
	speed: 0.0136s/iter; left time: 268.9260s
Epoch: 2 cost time: 19.398850440979004
Epoch: 2, Steps: 202 | Train Loss: 0.7104314 Vali Loss: 0.6976082 Vali AUC: 0.5333171
Validation loss decreased (0.698658 --> 0.697608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6660888
	speed: 0.4792s/iter; left time: 9439.5546s
	iters: 200, epoch: 3 | loss: 0.7109914
	speed: 0.0138s/iter; left time: 270.1263s
Epoch: 3 cost time: 19.398235082626343
Epoch: 3, Steps: 202 | Train Loss: 0.7102936 Vali Loss: 0.6994753 Vali AUC: 0.5336167
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7422107
	speed: 0.4796s/iter; left time: 9349.6980s
	iters: 200, epoch: 4 | loss: 0.7040419
	speed: 0.0137s/iter; left time: 266.3340s
Epoch: 4 cost time: 19.469608306884766
Epoch: 4, Steps: 202 | Train Loss: 0.7084198 Vali Loss: 0.6987407 Vali AUC: 0.5322498
EarlyStopping counter: 2 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7650244
	speed: 0.4806s/iter; left time: 9272.4136s
	iters: 200, epoch: 5 | loss: 0.7875589
	speed: 0.0136s/iter; left time: 261.3433s
Epoch: 5 cost time: 19.433252811431885
Epoch: 5, Steps: 202 | Train Loss: 0.7107767 Vali Loss: 0.6974078 Vali AUC: 0.5345274
Validation loss decreased (0.697608 --> 0.697408).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6200843
	speed: 0.4794s/iter; left time: 9152.7265s
	iters: 200, epoch: 6 | loss: 0.6828436
	speed: 0.0136s/iter; left time: 259.1793s
Epoch: 6 cost time: 19.35157012939453
Epoch: 6, Steps: 202 | Train Loss: 0.7110005 Vali Loss: 0.6992187 Vali AUC: 0.5331588
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7662082
	speed: 0.4800s/iter; left time: 9065.9041s
	iters: 200, epoch: 7 | loss: 0.6869344
	speed: 0.0137s/iter; left time: 257.7255s
Epoch: 7 cost time: 19.432452917099
Epoch: 7, Steps: 202 | Train Loss: 0.7082488 Vali Loss: 0.6994361 Vali AUC: 0.5339887
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.7356844
	speed: 0.4799s/iter; left time: 8967.4242s
	iters: 200, epoch: 8 | loss: 0.6944094
	speed: 0.0137s/iter; left time: 254.6298s
Epoch: 8 cost time: 19.32871985435486
Epoch: 8, Steps: 202 | Train Loss: 0.7090552 Vali Loss: 0.6984684 Vali AUC: 0.5326555
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7419239
	speed: 0.4803s/iter; left time: 8878.9314s
	iters: 200, epoch: 9 | loss: 0.7126541
	speed: 0.0138s/iter; left time: 253.7027s
Epoch: 9 cost time: 19.411378622055054
Epoch: 9, Steps: 202 | Train Loss: 0.7085876 Vali Loss: 0.6980053 Vali AUC: 0.5329838
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7016940
	speed: 0.4786s/iter; left time: 8750.0624s
	iters: 200, epoch: 10 | loss: 0.7574880
	speed: 0.0136s/iter; left time: 247.1924s
Epoch: 10 cost time: 19.407370805740356
Epoch: 10, Steps: 202 | Train Loss: 0.7075510 Vali Loss: 0.6975350 Vali AUC: 0.5347782
EarlyStopping counter: 5 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7370371
	speed: 0.4795s/iter; left time: 8669.7970s
	iters: 200, epoch: 11 | loss: 0.6791317
	speed: 0.0137s/iter; left time: 245.8336s
Epoch: 11 cost time: 19.440577745437622
Epoch: 11, Steps: 202 | Train Loss: 0.7087892 Vali Loss: 0.6989127 Vali AUC: 0.5345829
EarlyStopping counter: 6 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7201702
	speed: 0.4810s/iter; left time: 8599.2237s
	iters: 200, epoch: 12 | loss: 0.6679219
	speed: 0.0136s/iter; left time: 241.4738s
Epoch: 12 cost time: 19.368650197982788
Epoch: 12, Steps: 202 | Train Loss: 0.7111522 Vali Loss: 0.6993159 Vali AUC: 0.5326286
EarlyStopping counter: 7 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6892659
	speed: 0.4792s/iter; left time: 8471.4361s
	iters: 200, epoch: 13 | loss: 0.6092514
	speed: 0.0137s/iter; left time: 240.5436s
Epoch: 13 cost time: 19.488364219665527
Epoch: 13, Steps: 202 | Train Loss: 0.7107444 Vali Loss: 0.6991589 Vali AUC: 0.5319434
EarlyStopping counter: 8 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7054001
	speed: 0.4801s/iter; left time: 8390.0929s
	iters: 200, epoch: 14 | loss: 0.7082750
	speed: 0.0136s/iter; left time: 237.1181s
Epoch: 14 cost time: 19.36304211616516
Epoch: 14, Steps: 202 | Train Loss: 0.7096905 Vali Loss: 0.6981919 Vali AUC: 0.5339029
EarlyStopping counter: 9 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6956953
	speed: 0.4793s/iter; left time: 8279.3469s
	iters: 200, epoch: 15 | loss: 0.7266132
	speed: 0.0135s/iter; left time: 232.2686s
Epoch: 15 cost time: 19.473498106002808
Epoch: 15, Steps: 202 | Train Loss: 0.7102288 Vali Loss: 0.6980065 Vali AUC: 0.5333743
EarlyStopping counter: 10 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6906424
	speed: 0.4818s/iter; left time: 8225.0821s
	iters: 200, epoch: 16 | loss: 0.7747313
	speed: 0.0137s/iter; left time: 232.6488s
Epoch: 16 cost time: 19.375213146209717
Epoch: 16, Steps: 202 | Train Loss: 0.7092290 Vali Loss: 0.6976032 Vali AUC: 0.5346334
EarlyStopping counter: 11 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.7356194
	speed: 0.4808s/iter; left time: 8110.7698s
	iters: 200, epoch: 17 | loss: 0.7232541
	speed: 0.0135s/iter; left time: 226.9946s
Epoch: 17 cost time: 19.478224515914917
Epoch: 17, Steps: 202 | Train Loss: 0.7099744 Vali Loss: 0.6976019 Vali AUC: 0.5335898
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.7037212
	speed: 0.4812s/iter; left time: 8019.9091s
	iters: 200, epoch: 18 | loss: 0.6993940
	speed: 0.0138s/iter; left time: 227.8326s
Epoch: 18 cost time: 19.434462785720825
Epoch: 18, Steps: 202 | Train Loss: 0.7087117 Vali Loss: 0.6977474 Vali AUC: 0.5324989
EarlyStopping counter: 13 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6926522
	speed: 0.4814s/iter; left time: 7925.6611s
	iters: 200, epoch: 19 | loss: 0.7199950
	speed: 0.0136s/iter; left time: 222.8496s
Epoch: 19 cost time: 19.390116214752197
Epoch: 19, Steps: 202 | Train Loss: 0.7080155 Vali Loss: 0.6977639 Vali AUC: 0.5327919
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6904345
	speed: 0.4808s/iter; left time: 7820.0317s
	iters: 200, epoch: 20 | loss: 0.6852685
	speed: 0.0136s/iter; left time: 219.1990s
Epoch: 20 cost time: 19.40752077102661
Epoch: 20, Steps: 202 | Train Loss: 0.7107859 Vali Loss: 0.6989301 Vali AUC: 0.5327632
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6688608
	speed: 0.4820s/iter; left time: 7741.5295s
	iters: 200, epoch: 21 | loss: 0.7448155
	speed: 0.0136s/iter; left time: 217.8062s
Epoch: 21 cost time: 19.404637575149536
Epoch: 21, Steps: 202 | Train Loss: 0.7086200 Vali Loss: 0.6990441 Vali AUC: 0.5329703
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7341840
	speed: 0.4792s/iter; left time: 7599.6640s
	iters: 200, epoch: 22 | loss: 0.6775762
	speed: 0.0136s/iter; left time: 214.1467s
Epoch: 22 cost time: 19.384637594223022
Epoch: 22, Steps: 202 | Train Loss: 0.7076644 Vali Loss: 0.7002486 Vali AUC: 0.5333861
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.7049117
	speed: 0.4819s/iter; left time: 7545.4111s
	iters: 200, epoch: 23 | loss: 0.6861750
	speed: 0.0137s/iter; left time: 212.6131s
Epoch: 23 cost time: 19.391477584838867
Epoch: 23, Steps: 202 | Train Loss: 0.7074062 Vali Loss: 0.6984065 Vali AUC: 0.5330494
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6993093
	speed: 0.4820s/iter; left time: 7448.7753s
	iters: 200, epoch: 24 | loss: 0.7120411
	speed: 0.0136s/iter; left time: 209.4850s
Epoch: 24 cost time: 19.417926788330078
Epoch: 24, Steps: 202 | Train Loss: 0.7102425 Vali Loss: 0.6980869 Vali AUC: 0.5334753
EarlyStopping counter: 19 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.7120866
	speed: 0.4832s/iter; left time: 7370.1750s
	iters: 200, epoch: 25 | loss: 0.7060589
	speed: 0.0137s/iter; left time: 207.4889s
Epoch: 25 cost time: 19.487704515457153
Epoch: 25, Steps: 202 | Train Loss: 0.7081319 Vali Loss: 0.6968947 Vali AUC: 0.5345021
Validation loss decreased (0.697408 --> 0.696895).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6840217
	speed: 0.4821s/iter; left time: 7256.3010s
	iters: 200, epoch: 26 | loss: 0.6863341
	speed: 0.0136s/iter; left time: 203.9995s
Epoch: 26 cost time: 19.471245288848877
Epoch: 26, Steps: 202 | Train Loss: 0.7102839 Vali Loss: 0.6972634 Vali AUC: 0.5338759
EarlyStopping counter: 1 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.7216822
	speed: 0.4815s/iter; left time: 7149.2525s
	iters: 200, epoch: 27 | loss: 0.6879791
	speed: 0.0136s/iter; left time: 201.0953s
Epoch: 27 cost time: 19.48136043548584
Epoch: 27, Steps: 202 | Train Loss: 0.7098431 Vali Loss: 0.6984991 Vali AUC: 0.5336234
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.7267998
	speed: 0.4830s/iter; left time: 7075.0519s
	iters: 200, epoch: 28 | loss: 0.6853032
	speed: 0.0136s/iter; left time: 198.3563s
Epoch: 28 cost time: 19.445703506469727
Epoch: 28, Steps: 202 | Train Loss: 0.7095043 Vali Loss: 0.6985693 Vali AUC: 0.5333743
EarlyStopping counter: 3 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.7327628
	speed: 0.4816s/iter; left time: 6956.9148s
	iters: 200, epoch: 29 | loss: 0.6432536
	speed: 0.0137s/iter; left time: 196.2625s
Epoch: 29 cost time: 19.451584577560425
Epoch: 29, Steps: 202 | Train Loss: 0.7090200 Vali Loss: 0.6994973 Vali AUC: 0.5343035
EarlyStopping counter: 4 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.7293460
	speed: 0.4829s/iter; left time: 6878.3893s
	iters: 200, epoch: 30 | loss: 0.7635540
	speed: 0.0138s/iter; left time: 195.2115s
Epoch: 30 cost time: 19.436739206314087
Epoch: 30, Steps: 202 | Train Loss: 0.7095646 Vali Loss: 0.6973998 Vali AUC: 0.5330578
EarlyStopping counter: 5 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.7223934
	speed: 0.4813s/iter; left time: 6757.8067s
	iters: 200, epoch: 31 | loss: 0.7312977
	speed: 0.0137s/iter; left time: 190.5373s
Epoch: 31 cost time: 19.433292388916016
Epoch: 31, Steps: 202 | Train Loss: 0.7090129 Vali Loss: 0.6971184 Vali AUC: 0.5325865
EarlyStopping counter: 6 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.7112498
	speed: 0.4821s/iter; left time: 6672.2385s
	iters: 200, epoch: 32 | loss: 0.7698040
	speed: 0.0135s/iter; left time: 186.0509s
Epoch: 32 cost time: 19.540788888931274
Epoch: 32, Steps: 202 | Train Loss: 0.7086836 Vali Loss: 0.6983468 Vali AUC: 0.5342025
EarlyStopping counter: 7 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.7086854
	speed: 0.4828s/iter; left time: 6583.3484s
	iters: 200, epoch: 33 | loss: 0.7162169
	speed: 0.0137s/iter; left time: 185.7431s
Epoch: 33 cost time: 19.46647548675537
Epoch: 33, Steps: 202 | Train Loss: 0.7082020 Vali Loss: 0.6977384 Vali AUC: 0.5329030
EarlyStopping counter: 8 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.7495734
	speed: 0.4820s/iter; left time: 6475.1856s
	iters: 200, epoch: 34 | loss: 0.7157547
	speed: 0.0136s/iter; left time: 181.9445s
Epoch: 34 cost time: 19.470935821533203
Epoch: 34, Steps: 202 | Train Loss: 0.7105699 Vali Loss: 0.6981828 Vali AUC: 0.5349129
EarlyStopping counter: 9 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.7207040
	speed: 0.4823s/iter; left time: 6382.7016s
	iters: 200, epoch: 35 | loss: 0.7441692
	speed: 0.0135s/iter; left time: 177.6645s
Epoch: 35 cost time: 19.46340823173523
Epoch: 35, Steps: 202 | Train Loss: 0.7093908 Vali Loss: 0.6987122 Vali AUC: 0.5324569
EarlyStopping counter: 10 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6779250
	speed: 0.4840s/iter; left time: 6307.5272s
	iters: 200, epoch: 36 | loss: 0.7053791
	speed: 0.0136s/iter; left time: 175.7290s
Epoch: 36 cost time: 19.476903200149536
Epoch: 36, Steps: 202 | Train Loss: 0.7078237 Vali Loss: 0.6999008 Vali AUC: 0.5332615
EarlyStopping counter: 11 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.7016538
	speed: 0.4835s/iter; left time: 6202.6142s
	iters: 200, epoch: 37 | loss: 0.7136438
	speed: 0.0136s/iter; left time: 173.6683s
Epoch: 37 cost time: 19.438904762268066
Epoch: 37, Steps: 202 | Train Loss: 0.7105344 Vali Loss: 0.6989323 Vali AUC: 0.5324720
EarlyStopping counter: 12 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.7341172
	speed: 0.4842s/iter; left time: 6114.5807s
	iters: 200, epoch: 38 | loss: 0.7053305
	speed: 0.0136s/iter; left time: 170.9612s
Epoch: 38 cost time: 19.46645712852478
Epoch: 38, Steps: 202 | Train Loss: 0.7099728 Vali Loss: 0.6977700 Vali AUC: 0.5330309
EarlyStopping counter: 13 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.6710383
	speed: 0.4840s/iter; left time: 6013.7646s
	iters: 200, epoch: 39 | loss: 0.7415618
	speed: 0.0137s/iter; left time: 168.5960s
Epoch: 39 cost time: 19.519615411758423
Epoch: 39, Steps: 202 | Train Loss: 0.7102183 Vali Loss: 0.6985254 Vali AUC: 0.5327212
EarlyStopping counter: 14 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.7019007
	speed: 0.4837s/iter; left time: 5912.1510s
	iters: 200, epoch: 40 | loss: 0.7110722
	speed: 0.0137s/iter; left time: 166.0696s
Epoch: 40 cost time: 19.516013145446777
Epoch: 40, Steps: 202 | Train Loss: 0.7096102 Vali Loss: 0.6994951 Vali AUC: 0.5335628
EarlyStopping counter: 15 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.7845761
	speed: 0.4830s/iter; left time: 5806.4440s
	iters: 200, epoch: 41 | loss: 0.7588016
	speed: 0.0137s/iter; left time: 163.5067s
Epoch: 41 cost time: 19.478347301483154
Epoch: 41, Steps: 202 | Train Loss: 0.7087751 Vali Loss: 0.6988102 Vali AUC: 0.5332228
EarlyStopping counter: 16 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.7267681
	speed: 0.4833s/iter; left time: 5711.7960s
	iters: 200, epoch: 42 | loss: 0.7792399
	speed: 0.0136s/iter; left time: 159.3838s
Epoch: 42 cost time: 19.49591374397278
Epoch: 42, Steps: 202 | Train Loss: 0.7092641 Vali Loss: 0.6997890 Vali AUC: 0.5326639
EarlyStopping counter: 17 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.6656537
	speed: 0.4838s/iter; left time: 5620.5484s
	iters: 200, epoch: 43 | loss: 0.6524391
	speed: 0.0136s/iter; left time: 156.2101s
Epoch: 43 cost time: 19.516115427017212
Epoch: 43, Steps: 202 | Train Loss: 0.7083818 Vali Loss: 0.6973206 Vali AUC: 0.5344988
EarlyStopping counter: 18 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.6906673
	speed: 0.4835s/iter; left time: 5519.5297s
	iters: 200, epoch: 44 | loss: 0.7323567
	speed: 0.0137s/iter; left time: 154.5919s
Epoch: 44 cost time: 19.63202142715454
Epoch: 44, Steps: 202 | Train Loss: 0.7068182 Vali Loss: 0.6983105 Vali AUC: 0.5340914
EarlyStopping counter: 19 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.6651787
	speed: 0.4843s/iter; left time: 5430.3847s
	iters: 200, epoch: 45 | loss: 0.6861182
	speed: 0.0136s/iter; left time: 151.5634s
Epoch: 45 cost time: 19.50648522377014
Epoch: 45, Steps: 202 | Train Loss: 0.7092307 Vali Loss: 0.6972678 Vali AUC: 0.5339163
EarlyStopping counter: 20 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.6384690
	speed: 0.4828s/iter; left time: 5316.4950s
	iters: 200, epoch: 46 | loss: 0.7828152
	speed: 0.0137s/iter; left time: 149.8309s
Epoch: 46 cost time: 19.512914657592773
Epoch: 46, Steps: 202 | Train Loss: 0.7077203 Vali Loss: 0.6991192 Vali AUC: 0.5342227
EarlyStopping counter: 21 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.7258438
	speed: 0.4830s/iter; left time: 5220.3310s
	iters: 200, epoch: 47 | loss: 0.6567978
	speed: 0.0138s/iter; left time: 147.7395s
Epoch: 47 cost time: 19.570900917053223
Epoch: 47, Steps: 202 | Train Loss: 0.7107642 Vali Loss: 0.6974154 Vali AUC: 0.5352933
EarlyStopping counter: 22 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.6715555
	speed: 0.4834s/iter; left time: 5127.1159s
	iters: 200, epoch: 48 | loss: 0.6718251
	speed: 0.0138s/iter; left time: 145.1476s
Epoch: 48 cost time: 19.59733247756958
Epoch: 48, Steps: 202 | Train Loss: 0.7101316 Vali Loss: 0.6974981 Vali AUC: 0.5347799
EarlyStopping counter: 23 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.7700555
	speed: 0.4839s/iter; left time: 5034.8054s
	iters: 200, epoch: 49 | loss: 0.7256390
	speed: 0.0137s/iter; left time: 141.0370s
Epoch: 49 cost time: 19.554163932800293
Epoch: 49, Steps: 202 | Train Loss: 0.7090671 Vali Loss: 0.6978318 Vali AUC: 0.5352967
EarlyStopping counter: 24 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.7219822
	speed: 0.4859s/iter; left time: 4957.2455s
	iters: 200, epoch: 50 | loss: 0.7011940
	speed: 0.0135s/iter; left time: 136.2076s
Epoch: 50 cost time: 19.60169243812561
Epoch: 50, Steps: 202 | Train Loss: 0.7091541 Vali Loss: 0.6995764 Vali AUC: 0.5322178
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1090
Accuracy: 0.536697247706422, AUC: 0.5345021462839827, Sensitivity: 0.326605504587156, Specificity: 0.7467889908256881, PPV: 0.5632911392405063, NPV: 0.5258397932816538, F1: 0.413472706155633
