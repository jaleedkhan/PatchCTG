Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_9', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9666
Dataset loaded and preprocessed.
val set size: 1090
Dataset loaded and preprocessed.
test set size: 1090
	iters: 100, epoch: 1 | loss: 0.7255247
	speed: 0.2116s/iter; left time: 4253.6772s
	iters: 200, epoch: 1 | loss: 0.7248105
	speed: 0.0316s/iter; left time: 631.8186s
Epoch: 1 cost time: 25.486624002456665
Epoch: 1, Steps: 202 | Train Loss: 0.7246581 Vali Loss: 0.7194755 Vali AUC: 0.4870499
Validation loss decreased (inf --> 0.719475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7380027
	speed: 0.5624s/iter; left time: 11192.1902s
	iters: 200, epoch: 2 | loss: 0.6947848
	speed: 0.0316s/iter; left time: 624.7719s
Epoch: 2 cost time: 25.08229684829712
Epoch: 2, Steps: 202 | Train Loss: 0.7042038 Vali Loss: 0.6990111 Vali AUC: 0.5283192
Validation loss decreased (0.719475 --> 0.699011).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6857668
	speed: 0.5607s/iter; left time: 11043.7291s
	iters: 200, epoch: 3 | loss: 0.7155914
	speed: 0.0315s/iter; left time: 616.3497s
Epoch: 3 cost time: 24.973237991333008
Epoch: 3, Steps: 202 | Train Loss: 0.6963626 Vali Loss: 0.6991588 Vali AUC: 0.5650484
EarlyStopping counter: 1 out of 25
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7200369
	speed: 0.5594s/iter; left time: 10905.0265s
	iters: 200, epoch: 4 | loss: 0.6813158
	speed: 0.0316s/iter; left time: 612.7254s
Epoch: 4 cost time: 25.009244441986084
Epoch: 4, Steps: 202 | Train Loss: 0.6933266 Vali Loss: 0.6972963 Vali AUC: 0.5188233
Validation loss decreased (0.699011 --> 0.697296).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7085294
	speed: 0.5583s/iter; left time: 10771.0543s
	iters: 200, epoch: 5 | loss: 0.6839373
	speed: 0.0315s/iter; left time: 604.5964s
Epoch: 5 cost time: 24.885611534118652
Epoch: 5, Steps: 202 | Train Loss: 0.6900802 Vali Loss: 0.7070545 Vali AUC: 0.5443397
EarlyStopping counter: 1 out of 25
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6592613
	speed: 0.5558s/iter; left time: 10610.5835s
	iters: 200, epoch: 6 | loss: 0.6819834
	speed: 0.0316s/iter; left time: 599.2176s
Epoch: 6 cost time: 24.936023235321045
Epoch: 6, Steps: 202 | Train Loss: 0.6896646 Vali Loss: 0.7040595 Vali AUC: 0.5572814
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7013187
	speed: 0.5596s/iter; left time: 10569.7718s
	iters: 200, epoch: 7 | loss: 0.6925382
	speed: 0.0315s/iter; left time: 592.7346s
Epoch: 7 cost time: 24.990829467773438
Epoch: 7, Steps: 202 | Train Loss: 0.6861783 Vali Loss: 0.7073754 Vali AUC: 0.5485245
EarlyStopping counter: 3 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6944625
	speed: 0.5585s/iter; left time: 10436.5893s
	iters: 200, epoch: 8 | loss: 0.6806612
	speed: 0.0315s/iter; left time: 586.2655s
Epoch: 8 cost time: 24.958534479141235
Epoch: 8, Steps: 202 | Train Loss: 0.6867770 Vali Loss: 0.7047932 Vali AUC: 0.5461257
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6986302
	speed: 0.5602s/iter; left time: 10355.4671s
	iters: 200, epoch: 9 | loss: 0.6823883
	speed: 0.0315s/iter; left time: 579.9705s
Epoch: 9 cost time: 25.21663498878479
Epoch: 9, Steps: 202 | Train Loss: 0.6862542 Vali Loss: 0.7013232 Vali AUC: 0.5087013
EarlyStopping counter: 5 out of 25
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6849534
	speed: 0.5626s/iter; left time: 10285.5550s
	iters: 200, epoch: 10 | loss: 0.6774320
	speed: 0.0315s/iter; left time: 573.5027s
Epoch: 10 cost time: 25.278846263885498
Epoch: 10, Steps: 202 | Train Loss: 0.6839263 Vali Loss: 0.6969956 Vali AUC: 0.5152546
Validation loss decreased (0.697296 --> 0.696996).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.7132740
	speed: 0.5635s/iter; left time: 10188.0938s
	iters: 200, epoch: 11 | loss: 0.6667258
	speed: 0.0316s/iter; left time: 567.8983s
Epoch: 11 cost time: 25.07362461090088
Epoch: 11, Steps: 202 | Train Loss: 0.6844513 Vali Loss: 0.6993207 Vali AUC: 0.5298611
EarlyStopping counter: 1 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6913260
	speed: 0.5578s/iter; left time: 9972.9035s
	iters: 200, epoch: 12 | loss: 0.6828091
	speed: 0.0316s/iter; left time: 561.4946s
Epoch: 12 cost time: 24.98553991317749
Epoch: 12, Steps: 202 | Train Loss: 0.6837189 Vali Loss: 0.6960123 Vali AUC: 0.5442488
Validation loss decreased (0.696996 --> 0.696012).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6610246
	speed: 0.5603s/iter; left time: 9904.9655s
	iters: 200, epoch: 13 | loss: 0.6309860
	speed: 0.0315s/iter; left time: 554.0346s
Epoch: 13 cost time: 25.000866413116455
Epoch: 13, Steps: 202 | Train Loss: 0.6821596 Vali Loss: 0.6996385 Vali AUC: 0.5441461
EarlyStopping counter: 1 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7038925
	speed: 0.5585s/iter; left time: 9760.1883s
	iters: 200, epoch: 14 | loss: 0.6773773
	speed: 0.0315s/iter; left time: 547.8971s
Epoch: 14 cost time: 24.971872329711914
Epoch: 14, Steps: 202 | Train Loss: 0.6805004 Vali Loss: 0.7010719 Vali AUC: 0.5467200
EarlyStopping counter: 2 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6881809
	speed: 0.5584s/iter; left time: 9644.5670s
	iters: 200, epoch: 15 | loss: 0.6560687
	speed: 0.0315s/iter; left time: 541.0058s
Epoch: 15 cost time: 25.000836849212646
Epoch: 15, Steps: 202 | Train Loss: 0.6777689 Vali Loss: 0.7023540 Vali AUC: 0.5493494
EarlyStopping counter: 3 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6832922
	speed: 0.5599s/iter; left time: 9557.2413s
	iters: 200, epoch: 16 | loss: 0.6955837
	speed: 0.0316s/iter; left time: 535.5194s
Epoch: 16 cost time: 25.02383804321289
Epoch: 16, Steps: 202 | Train Loss: 0.6764620 Vali Loss: 0.6988619 Vali AUC: 0.5424813
EarlyStopping counter: 4 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6921893
	speed: 0.5614s/iter; left time: 9470.3941s
	iters: 200, epoch: 17 | loss: 0.7050089
	speed: 0.0315s/iter; left time: 528.7878s
Epoch: 17 cost time: 25.24018907546997
Epoch: 17, Steps: 202 | Train Loss: 0.6746033 Vali Loss: 0.7031143 Vali AUC: 0.5489117
EarlyStopping counter: 5 out of 25
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6948665
	speed: 0.5614s/iter; left time: 9356.7713s
	iters: 200, epoch: 18 | loss: 0.6407481
	speed: 0.0315s/iter; left time: 522.6192s
Epoch: 18 cost time: 25.167226791381836
Epoch: 18, Steps: 202 | Train Loss: 0.6730450 Vali Loss: 0.6992749 Vali AUC: 0.5495548
EarlyStopping counter: 6 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6343740
	speed: 0.5642s/iter; left time: 9290.2663s
	iters: 200, epoch: 19 | loss: 0.6738306
	speed: 0.0315s/iter; left time: 515.9342s
Epoch: 19 cost time: 25.075951099395752
Epoch: 19, Steps: 202 | Train Loss: 0.6709357 Vali Loss: 0.6990929 Vali AUC: 0.5551974
EarlyStopping counter: 7 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6336077
	speed: 0.5608s/iter; left time: 9120.5625s
	iters: 200, epoch: 20 | loss: 0.6608880
	speed: 0.0316s/iter; left time: 510.0655s
Epoch: 20 cost time: 24.93649959564209
Epoch: 20, Steps: 202 | Train Loss: 0.6686859 Vali Loss: 0.6977635 Vali AUC: 0.5294891
EarlyStopping counter: 8 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6553102
	speed: 0.5586s/iter; left time: 8971.5659s
	iters: 200, epoch: 21 | loss: 0.7015067
	speed: 0.0315s/iter; left time: 503.4529s
Epoch: 21 cost time: 24.91538095474243
Epoch: 21, Steps: 202 | Train Loss: 0.6695363 Vali Loss: 0.7020485 Vali AUC: 0.5472671
EarlyStopping counter: 9 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6834660
	speed: 0.5587s/iter; left time: 8860.3276s
	iters: 200, epoch: 22 | loss: 0.6527237
	speed: 0.0315s/iter; left time: 496.0638s
Epoch: 22 cost time: 25.031164407730103
Epoch: 22, Steps: 202 | Train Loss: 0.6667244 Vali Loss: 0.7026693 Vali AUC: 0.5488528
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6493309
	speed: 0.5587s/iter; left time: 8747.8023s
	iters: 200, epoch: 23 | loss: 0.6397562
	speed: 0.0316s/iter; left time: 490.8607s
Epoch: 23 cost time: 24.99030375480652
Epoch: 23, Steps: 202 | Train Loss: 0.6668629 Vali Loss: 0.7090149 Vali AUC: 0.5592021
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6705140
	speed: 0.5568s/iter; left time: 8605.6937s
	iters: 200, epoch: 24 | loss: 0.6957087
	speed: 0.0315s/iter; left time: 484.3997s
Epoch: 24 cost time: 24.966634511947632
Epoch: 24, Steps: 202 | Train Loss: 0.6703848 Vali Loss: 0.6989475 Vali AUC: 0.5370625
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6724383
	speed: 0.5620s/iter; left time: 8572.7698s
	iters: 200, epoch: 25 | loss: 0.6533850
	speed: 0.0315s/iter; left time: 477.8987s
Epoch: 25 cost time: 24.98362421989441
Epoch: 25, Steps: 202 | Train Loss: 0.6649333 Vali Loss: 0.7013842 Vali AUC: 0.5405151
EarlyStopping counter: 13 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6612882
	speed: 0.5603s/iter; left time: 8433.5676s
	iters: 200, epoch: 26 | loss: 0.6378304
	speed: 0.0316s/iter; left time: 471.7137s
Epoch: 26 cost time: 25.108025074005127
Epoch: 26, Steps: 202 | Train Loss: 0.6629111 Vali Loss: 0.7005810 Vali AUC: 0.5465752
EarlyStopping counter: 14 out of 25
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6699302
	speed: 0.5623s/iter; left time: 8349.6848s
	iters: 200, epoch: 27 | loss: 0.6316843
	speed: 0.0315s/iter; left time: 464.3301s
Epoch: 27 cost time: 25.22890043258667
Epoch: 27, Steps: 202 | Train Loss: 0.6633224 Vali Loss: 0.7019206 Vali AUC: 0.5407811
EarlyStopping counter: 15 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6917127
	speed: 0.5619s/iter; left time: 8229.7696s
	iters: 200, epoch: 28 | loss: 0.6672206
	speed: 0.0316s/iter; left time: 459.1084s
Epoch: 28 cost time: 25.044341802597046
Epoch: 28, Steps: 202 | Train Loss: 0.6624169 Vali Loss: 0.7004730 Vali AUC: 0.5440316
EarlyStopping counter: 16 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6526185
	speed: 0.5625s/iter; left time: 8126.0214s
	iters: 200, epoch: 29 | loss: 0.6241484
	speed: 0.0316s/iter; left time: 452.8985s
Epoch: 29 cost time: 25.05610990524292
Epoch: 29, Steps: 202 | Train Loss: 0.6629894 Vali Loss: 0.7005996 Vali AUC: 0.5404495
EarlyStopping counter: 17 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6644124
	speed: 0.5621s/iter; left time: 8005.6433s
	iters: 200, epoch: 30 | loss: 0.7002671
	speed: 0.0316s/iter; left time: 446.3369s
Epoch: 30 cost time: 25.090356826782227
Epoch: 30, Steps: 202 | Train Loss: 0.6619878 Vali Loss: 0.7018224 Vali AUC: 0.5294841
EarlyStopping counter: 18 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6191594
	speed: 0.5605s/iter; left time: 7870.3106s
	iters: 200, epoch: 31 | loss: 0.6948602
	speed: 0.0316s/iter; left time: 440.2434s
Epoch: 31 cost time: 25.03703999519348
Epoch: 31, Steps: 202 | Train Loss: 0.6611401 Vali Loss: 0.6991281 Vali AUC: 0.5329972
EarlyStopping counter: 19 out of 25
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6866282
	speed: 0.5627s/iter; left time: 7786.7842s
	iters: 200, epoch: 32 | loss: 0.6884279
	speed: 0.0316s/iter; left time: 433.5196s
Epoch: 32 cost time: 25.104113340377808
Epoch: 32, Steps: 202 | Train Loss: 0.6610541 Vali Loss: 0.7012429 Vali AUC: 0.5416665
EarlyStopping counter: 20 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6841938
	speed: 0.5620s/iter; left time: 7663.4560s
	iters: 200, epoch: 33 | loss: 0.6856374
	speed: 0.0316s/iter; left time: 427.4465s
Epoch: 33 cost time: 25.057936906814575
Epoch: 33, Steps: 202 | Train Loss: 0.6593605 Vali Loss: 0.6985216 Vali AUC: 0.5357344
EarlyStopping counter: 21 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.7110982
	speed: 0.5634s/iter; left time: 7569.0250s
	iters: 200, epoch: 34 | loss: 0.6440369
	speed: 0.0326s/iter; left time: 434.9415s
Epoch: 34 cost time: 25.18648862838745
Epoch: 34, Steps: 202 | Train Loss: 0.6596105 Vali Loss: 0.6993593 Vali AUC: 0.5402340
EarlyStopping counter: 22 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.6924412
	speed: 0.5616s/iter; left time: 7431.1176s
	iters: 200, epoch: 35 | loss: 0.6838326
	speed: 0.0322s/iter; left time: 423.2525s
Epoch: 35 cost time: 25.097693920135498
Epoch: 35, Steps: 202 | Train Loss: 0.6585521 Vali Loss: 0.7022978 Vali AUC: 0.5439290
EarlyStopping counter: 23 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6753690
	speed: 0.5593s/iter; left time: 7288.5001s
	iters: 200, epoch: 36 | loss: 0.6467818
	speed: 0.0316s/iter; left time: 408.2374s
Epoch: 36 cost time: 25.157628059387207
Epoch: 36, Steps: 202 | Train Loss: 0.6584213 Vali Loss: 0.7015034 Vali AUC: 0.5442623
EarlyStopping counter: 24 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.6641191
	speed: 0.5620s/iter; left time: 7209.8163s
	iters: 200, epoch: 37 | loss: 0.6802449
	speed: 0.0315s/iter; left time: 401.4364s
Epoch: 37 cost time: 25.08321976661682
Epoch: 37, Steps: 202 | Train Loss: 0.6593412 Vali Loss: 0.6984624 Vali AUC: 0.5390001
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1090
Accuracy: 0.5440366972477064, AUC: 0.5442488006060096, Sensitivity: 0.22935779816513763, Specificity: 0.8587155963302753, PPV: 0.6188118811881188, NPV: 0.527027027027027, F1: 0.33467202141900937
