Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dec_in=2, decomposition=0, des='Exp', devices='0,1,2', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=4, num_classes=2, num_workers=0, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_dataset_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_dataset_path='../ctg_dataset/Dataset with Folds/model_datasets/fold_9', train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 9666
Dataset loaded and preprocessed.
val set size: 1090
Dataset loaded and preprocessed.
test set size: 1090
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 1090
loading model
Accuracy: 0.5348623853211009, AUC: 0.525004629239963, Sensitivity: 0.3321100917431193, Specificity: 0.7376146788990826, PPV: 0.558641975308642, NPV: 0.5248041775456919, F1: 0.4165707710011508
Trainable parameters after freezing layers: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.6982188
	speed: 0.0151s/iter; left time: 302.7754s
	iters: 200, epoch: 1 | loss: 0.6841811
	speed: 0.0150s/iter; left time: 300.0692s
Epoch: 1 cost time: 3.032794952392578
Epoch: 1, Steps: 202 | Train Loss: 0.6961801 Vali Loss: 0.6966909 Vali AUC: 0.5245703
Validation loss decreased (inf --> 0.696691).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7007699
	speed: 0.0219s/iter; left time: 435.0475s
	iters: 200, epoch: 2 | loss: 0.6882639
	speed: 0.0150s/iter; left time: 296.5563s
Epoch: 2 cost time: 3.0370025634765625
Epoch: 2, Steps: 202 | Train Loss: 0.6972074 Vali Loss: 0.6964064 Vali AUC: 0.5253144
Validation loss decreased (0.696691 --> 0.696406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6750726
	speed: 0.0218s/iter; left time: 429.3086s
	iters: 200, epoch: 3 | loss: 0.6804530
	speed: 0.0151s/iter; left time: 295.3562s
Epoch: 3 cost time: 3.037461519241333
Epoch: 3, Steps: 202 | Train Loss: 0.6970058 Vali Loss: 0.6961812 Vali AUC: 0.5245131
Validation loss decreased (0.696406 --> 0.696181).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7378844
	speed: 0.0218s/iter; left time: 424.6333s
	iters: 200, epoch: 4 | loss: 0.6779141
	speed: 0.0150s/iter; left time: 291.8394s
Epoch: 4 cost time: 3.0371317863464355
Epoch: 4, Steps: 202 | Train Loss: 0.6957458 Vali Loss: 0.6967245 Vali AUC: 0.5250753
EarlyStopping counter: 1 out of 25
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7159383
	speed: 0.0214s/iter; left time: 413.4688s
	iters: 200, epoch: 5 | loss: 0.7056386
	speed: 0.0150s/iter; left time: 288.1881s
Epoch: 5 cost time: 3.0330135822296143
Epoch: 5, Steps: 202 | Train Loss: 0.6956402 Vali Loss: 0.6956539 Vali AUC: 0.5244559
Validation loss decreased (0.696181 --> 0.695654).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6544291
	speed: 0.0218s/iter; left time: 415.7237s
	iters: 200, epoch: 6 | loss: 0.6748009
	speed: 0.0149s/iter; left time: 283.5763s
Epoch: 6 cost time: 3.0228374004364014
Epoch: 6, Steps: 202 | Train Loss: 0.6960621 Vali Loss: 0.6962323 Vali AUC: 0.5248632
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7282852
	speed: 0.0213s/iter; left time: 402.8133s
	iters: 200, epoch: 7 | loss: 0.6977841
	speed: 0.0151s/iter; left time: 283.3941s
Epoch: 7 cost time: 3.035762071609497
Epoch: 7, Steps: 202 | Train Loss: 0.6957075 Vali Loss: 0.6958462 Vali AUC: 0.5231799
EarlyStopping counter: 2 out of 25
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6883585
	speed: 0.0213s/iter; left time: 397.6623s
	iters: 200, epoch: 8 | loss: 0.7077789
	speed: 0.0151s/iter; left time: 280.5988s
Epoch: 8 cost time: 3.030809164047241
Epoch: 8, Steps: 202 | Train Loss: 0.6957607 Vali Loss: 0.6959346 Vali AUC: 0.5239912
EarlyStopping counter: 3 out of 25
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.7131683
	speed: 0.0213s/iter; left time: 393.0135s
	iters: 200, epoch: 9 | loss: 0.6913866
	speed: 0.0149s/iter; left time: 274.2936s
Epoch: 9 cost time: 3.0110204219818115
Epoch: 9, Steps: 202 | Train Loss: 0.6954400 Vali Loss: 0.6949879 Vali AUC: 0.5236849
Validation loss decreased (0.695654 --> 0.694988).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6960270
	speed: 0.0218s/iter; left time: 398.1322s
	iters: 200, epoch: 10 | loss: 0.6931070
	speed: 0.0150s/iter; left time: 271.8566s
Epoch: 10 cost time: 3.020763397216797
Epoch: 10, Steps: 202 | Train Loss: 0.6956917 Vali Loss: 0.6954479 Vali AUC: 0.5230839
EarlyStopping counter: 1 out of 25
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6928989
	speed: 0.0214s/iter; left time: 386.3631s
	iters: 200, epoch: 11 | loss: 0.6809654
	speed: 0.0150s/iter; left time: 269.8708s
Epoch: 11 cost time: 3.024661064147949
Epoch: 11, Steps: 202 | Train Loss: 0.6953063 Vali Loss: 0.6955216 Vali AUC: 0.5234559
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6897811
	speed: 0.0213s/iter; left time: 379.9983s
	iters: 200, epoch: 12 | loss: 0.6886042
	speed: 0.0149s/iter; left time: 265.2419s
Epoch: 12 cost time: 3.007936954498291
Epoch: 12, Steps: 202 | Train Loss: 0.6961402 Vali Loss: 0.6955339 Vali AUC: 0.5239845
EarlyStopping counter: 3 out of 25
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6847953
	speed: 0.0212s/iter; left time: 374.3218s
	iters: 200, epoch: 13 | loss: 0.6775886
	speed: 0.0149s/iter; left time: 262.6970s
Epoch: 13 cost time: 3.0060067176818848
Epoch: 13, Steps: 202 | Train Loss: 0.6952666 Vali Loss: 0.6955733 Vali AUC: 0.5232624
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7068982
	speed: 0.0212s/iter; left time: 370.1213s
	iters: 200, epoch: 14 | loss: 0.6907670
	speed: 0.0184s/iter; left time: 318.9009s
Epoch: 14 cost time: 3.348740816116333
Epoch: 14, Steps: 202 | Train Loss: 0.6960143 Vali Loss: 0.6952894 Vali AUC: 0.5228365
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6781446
	speed: 0.0212s/iter; left time: 365.3408s
	iters: 200, epoch: 15 | loss: 0.7028884
	speed: 0.0150s/iter; left time: 257.4789s
Epoch: 15 cost time: 3.0090808868408203
Epoch: 15, Steps: 202 | Train Loss: 0.6952998 Vali Loss: 0.6955969 Vali AUC: 0.5244323
EarlyStopping counter: 6 out of 25
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.7044164
	speed: 0.0212s/iter; left time: 361.0909s
	iters: 200, epoch: 16 | loss: 0.7094400
	speed: 0.0148s/iter; left time: 251.9810s
Epoch: 16 cost time: 2.9954302310943604
Epoch: 16, Steps: 202 | Train Loss: 0.6956199 Vali Loss: 0.6953875 Vali AUC: 0.5243902
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.7197686
	speed: 0.0234s/iter; left time: 395.0345s
	iters: 200, epoch: 17 | loss: 0.7146968
	speed: 0.0150s/iter; left time: 251.0016s
Epoch: 17 cost time: 3.0337913036346436
Epoch: 17, Steps: 202 | Train Loss: 0.6953704 Vali Loss: 0.6947468 Vali AUC: 0.5245434
Validation loss decreased (0.694988 --> 0.694747).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6911883
	speed: 0.0216s/iter; left time: 359.7695s
	iters: 200, epoch: 18 | loss: 0.6854237
	speed: 0.0163s/iter; left time: 270.8687s
Epoch: 18 cost time: 3.1486809253692627
Epoch: 18, Steps: 202 | Train Loss: 0.6946659 Vali Loss: 0.6950329 Vali AUC: 0.5242707
EarlyStopping counter: 1 out of 25
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.7007929
	speed: 0.0214s/iter; left time: 352.4861s
	iters: 200, epoch: 19 | loss: 0.7058200
	speed: 0.0150s/iter; left time: 245.8814s
Epoch: 19 cost time: 3.03173828125
Epoch: 19, Steps: 202 | Train Loss: 0.6946258 Vali Loss: 0.6947768 Vali AUC: 0.5243111
EarlyStopping counter: 2 out of 25
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6704699
	speed: 0.0214s/iter; left time: 347.7099s
	iters: 200, epoch: 20 | loss: 0.6972787
	speed: 0.0150s/iter; left time: 242.0795s
Epoch: 20 cost time: 3.023880958557129
Epoch: 20, Steps: 202 | Train Loss: 0.6954989 Vali Loss: 0.6954212 Vali AUC: 0.5250955
EarlyStopping counter: 3 out of 25
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6814237
	speed: 0.0214s/iter; left time: 344.2448s
	iters: 200, epoch: 21 | loss: 0.7266120
	speed: 0.0150s/iter; left time: 239.0602s
Epoch: 21 cost time: 3.0299601554870605
Epoch: 21, Steps: 202 | Train Loss: 0.6950320 Vali Loss: 0.6949798 Vali AUC: 0.5243532
EarlyStopping counter: 4 out of 25
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6875486
	speed: 0.0240s/iter; left time: 380.5390s
	iters: 200, epoch: 22 | loss: 0.6806294
	speed: 0.0150s/iter; left time: 236.8615s
Epoch: 22 cost time: 3.291508436203003
Epoch: 22, Steps: 202 | Train Loss: 0.6950751 Vali Loss: 0.6954114 Vali AUC: 0.5233953
EarlyStopping counter: 5 out of 25
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6814384
	speed: 0.0212s/iter; left time: 331.2641s
	iters: 200, epoch: 23 | loss: 0.7022871
	speed: 0.0160s/iter; left time: 248.9657s
Epoch: 23 cost time: 3.1115031242370605
Epoch: 23, Steps: 202 | Train Loss: 0.6945071 Vali Loss: 0.6947100 Vali AUC: 0.5247420
Validation loss decreased (0.694747 --> 0.694710).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.6845120
	speed: 0.0218s/iter; left time: 336.3818s
	iters: 200, epoch: 24 | loss: 0.7228702
	speed: 0.0150s/iter; left time: 230.6933s
Epoch: 24 cost time: 3.0289251804351807
Epoch: 24, Steps: 202 | Train Loss: 0.6958833 Vali Loss: 0.6948321 Vali AUC: 0.5241394
EarlyStopping counter: 1 out of 25
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.6819355
	speed: 0.0215s/iter; left time: 327.7910s
	iters: 200, epoch: 25 | loss: 0.6981110
	speed: 0.0150s/iter; left time: 227.3568s
Epoch: 25 cost time: 3.034640312194824
Epoch: 25, Steps: 202 | Train Loss: 0.6953956 Vali Loss: 0.6949343 Vali AUC: 0.5246882
EarlyStopping counter: 2 out of 25
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6744062
	speed: 0.0213s/iter; left time: 320.7897s
	iters: 200, epoch: 26 | loss: 0.6778750
	speed: 0.0149s/iter; left time: 223.2393s
Epoch: 26 cost time: 3.0142159461975098
Epoch: 26, Steps: 202 | Train Loss: 0.6949255 Vali Loss: 0.6945159 Vali AUC: 0.5228230
Validation loss decreased (0.694710 --> 0.694516).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6870356
	speed: 0.0218s/iter; left time: 323.9652s
	iters: 200, epoch: 27 | loss: 0.6746883
	speed: 0.0150s/iter; left time: 220.5856s
Epoch: 27 cost time: 3.029510021209717
Epoch: 27, Steps: 202 | Train Loss: 0.6954935 Vali Loss: 0.6947590 Vali AUC: 0.5248531
EarlyStopping counter: 1 out of 25
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6939758
	speed: 0.0214s/iter; left time: 313.8860s
	iters: 200, epoch: 28 | loss: 0.6794174
	speed: 0.0150s/iter; left time: 217.6604s
Epoch: 28 cost time: 3.029494047164917
Epoch: 28, Steps: 202 | Train Loss: 0.6949362 Vali Loss: 0.6947564 Vali AUC: 0.5243481
EarlyStopping counter: 2 out of 25
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.7117647
	speed: 0.0214s/iter; left time: 308.7983s
	iters: 200, epoch: 29 | loss: 0.6869117
	speed: 0.0151s/iter; left time: 217.2893s
Epoch: 29 cost time: 3.042837381362915
Epoch: 29, Steps: 202 | Train Loss: 0.6954769 Vali Loss: 0.6953813 Vali AUC: 0.5234526
EarlyStopping counter: 3 out of 25
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6920022
	speed: 0.0214s/iter; left time: 304.5467s
	iters: 200, epoch: 30 | loss: 0.7197858
	speed: 0.0150s/iter; left time: 211.7518s
Epoch: 30 cost time: 3.0250394344329834
Epoch: 30, Steps: 202 | Train Loss: 0.6955371 Vali Loss: 0.6947574 Vali AUC: 0.5244862
EarlyStopping counter: 4 out of 25
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.7031664
	speed: 0.0213s/iter; left time: 299.4348s
	iters: 200, epoch: 31 | loss: 0.7020420
	speed: 0.0150s/iter; left time: 209.4182s
Epoch: 31 cost time: 3.026432752609253
Epoch: 31, Steps: 202 | Train Loss: 0.6957345 Vali Loss: 0.6944618 Vali AUC: 0.5243717
Validation loss decreased (0.694516 --> 0.694462).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6941880
	speed: 0.0217s/iter; left time: 299.8778s
	iters: 200, epoch: 32 | loss: 0.7133944
	speed: 0.0150s/iter; left time: 206.7030s
Epoch: 32 cost time: 3.024395227432251
Epoch: 32, Steps: 202 | Train Loss: 0.6953931 Vali Loss: 0.6947364 Vali AUC: 0.5250518
EarlyStopping counter: 1 out of 25
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.7060443
	speed: 0.0213s/iter; left time: 290.2405s
	iters: 200, epoch: 33 | loss: 0.7007833
	speed: 0.0150s/iter; left time: 202.5005s
Epoch: 33 cost time: 3.0163142681121826
Epoch: 33, Steps: 202 | Train Loss: 0.6952891 Vali Loss: 0.6947028 Vali AUC: 0.5242959
EarlyStopping counter: 2 out of 25
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.7124698
	speed: 0.0214s/iter; left time: 287.5301s
	iters: 200, epoch: 34 | loss: 0.6910002
	speed: 0.0150s/iter; left time: 200.1646s
Epoch: 34 cost time: 3.0301380157470703
Epoch: 34, Steps: 202 | Train Loss: 0.6960864 Vali Loss: 0.6945959 Vali AUC: 0.5240417
EarlyStopping counter: 3 out of 25
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.7011836
	speed: 0.0214s/iter; left time: 282.7563s
	iters: 200, epoch: 35 | loss: 0.7136894
	speed: 0.0149s/iter; left time: 196.0833s
Epoch: 35 cost time: 3.019153356552124
Epoch: 35, Steps: 202 | Train Loss: 0.6948846 Vali Loss: 0.6947646 Vali AUC: 0.5246680
EarlyStopping counter: 4 out of 25
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.6706397
	speed: 0.0214s/iter; left time: 279.0027s
	iters: 200, epoch: 36 | loss: 0.6943735
	speed: 0.0149s/iter; left time: 193.1117s
Epoch: 36 cost time: 3.025153875350952
Epoch: 36, Steps: 202 | Train Loss: 0.6945933 Vali Loss: 0.6957951 Vali AUC: 0.5242774
EarlyStopping counter: 5 out of 25
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.7104515
	speed: 0.0214s/iter; left time: 274.2109s
	iters: 200, epoch: 37 | loss: 0.6923412
	speed: 0.0150s/iter; left time: 191.1609s
Epoch: 37 cost time: 3.029855966567993
Epoch: 37, Steps: 202 | Train Loss: 0.6955264 Vali Loss: 0.6950778 Vali AUC: 0.5249019
EarlyStopping counter: 6 out of 25
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.7035099
	speed: 0.0213s/iter; left time: 269.4194s
	iters: 200, epoch: 38 | loss: 0.6797115
	speed: 0.0150s/iter; left time: 187.8433s
Epoch: 38 cost time: 3.0240111351013184
Epoch: 38, Steps: 202 | Train Loss: 0.6939342 Vali Loss: 0.6951277 Vali AUC: 0.5254793
EarlyStopping counter: 7 out of 25
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.6782452
	speed: 0.0214s/iter; left time: 265.3728s
	iters: 200, epoch: 39 | loss: 0.6833301
	speed: 0.0149s/iter; left time: 184.0964s
Epoch: 39 cost time: 3.018373727798462
Epoch: 39, Steps: 202 | Train Loss: 0.6955259 Vali Loss: 0.6953958 Vali AUC: 0.5238667
EarlyStopping counter: 8 out of 25
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.6953820
	speed: 0.0214s/iter; left time: 261.3493s
	iters: 200, epoch: 40 | loss: 0.7093008
	speed: 0.0150s/iter; left time: 182.1519s
Epoch: 40 cost time: 3.0315911769866943
Epoch: 40, Steps: 202 | Train Loss: 0.6962983 Vali Loss: 0.6959124 Vali AUC: 0.5234610
EarlyStopping counter: 9 out of 25
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.7579386
	speed: 0.0213s/iter; left time: 256.2785s
	iters: 200, epoch: 41 | loss: 0.7235772
	speed: 0.0151s/iter; left time: 180.1340s
Epoch: 41 cost time: 3.0330679416656494
Epoch: 41, Steps: 202 | Train Loss: 0.6951832 Vali Loss: 0.6953897 Vali AUC: 0.5236647
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.7008052
	speed: 0.0213s/iter; left time: 251.6569s
	iters: 200, epoch: 42 | loss: 0.7275995
	speed: 0.0149s/iter; left time: 174.9097s
Epoch: 42 cost time: 3.0144898891448975
Epoch: 42, Steps: 202 | Train Loss: 0.6946246 Vali Loss: 0.6952188 Vali AUC: 0.5237657
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.6930710
	speed: 0.0213s/iter; left time: 247.5293s
	iters: 200, epoch: 43 | loss: 0.6894794
	speed: 0.0149s/iter; left time: 171.8210s
Epoch: 43 cost time: 3.013566017150879
Epoch: 43, Steps: 202 | Train Loss: 0.6946518 Vali Loss: 0.6944664 Vali AUC: 0.5240098
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.7056898
	speed: 0.0214s/iter; left time: 243.7721s
	iters: 200, epoch: 44 | loss: 0.7042300
	speed: 0.0150s/iter; left time: 169.2695s
Epoch: 44 cost time: 3.021226406097412
Epoch: 44, Steps: 202 | Train Loss: 0.6949108 Vali Loss: 0.6952312 Vali AUC: 0.5242993
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.6676314
	speed: 0.0213s/iter; left time: 239.1341s
	iters: 200, epoch: 45 | loss: 0.6737389
	speed: 0.0150s/iter; left time: 166.2608s
Epoch: 45 cost time: 3.0198445320129395
Epoch: 45, Steps: 202 | Train Loss: 0.6946794 Vali Loss: 0.6948598 Vali AUC: 0.5242842
EarlyStopping counter: 14 out of 25
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.6580104
	speed: 0.0213s/iter; left time: 234.7813s
	iters: 200, epoch: 46 | loss: 0.7403656
	speed: 0.0149s/iter; left time: 163.0524s
Epoch: 46 cost time: 3.01662540435791
Epoch: 46, Steps: 202 | Train Loss: 0.6940797 Vali Loss: 0.6955981 Vali AUC: 0.5232842
EarlyStopping counter: 15 out of 25
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.7091147
	speed: 0.0213s/iter; left time: 230.4026s
	iters: 200, epoch: 47 | loss: 0.6696755
	speed: 0.0149s/iter; left time: 159.8979s
Epoch: 47 cost time: 3.015148401260376
Epoch: 47, Steps: 202 | Train Loss: 0.6948814 Vali Loss: 0.6949314 Vali AUC: 0.5238027
EarlyStopping counter: 16 out of 25
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.6899346
	speed: 0.0212s/iter; left time: 225.2226s
	iters: 200, epoch: 48 | loss: 0.6772978
	speed: 0.0149s/iter; left time: 156.4460s
Epoch: 48 cost time: 3.0026469230651855
Epoch: 48, Steps: 202 | Train Loss: 0.6948829 Vali Loss: 0.6948894 Vali AUC: 0.5246898
EarlyStopping counter: 17 out of 25
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.7170925
	speed: 0.0214s/iter; left time: 222.4218s
	iters: 200, epoch: 49 | loss: 0.6746410
	speed: 0.0149s/iter; left time: 153.6856s
Epoch: 49 cost time: 3.0156331062316895
Epoch: 49, Steps: 202 | Train Loss: 0.6945049 Vali Loss: 0.6946081 Vali AUC: 0.5247252
EarlyStopping counter: 18 out of 25
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.7121795
	speed: 0.0212s/iter; left time: 216.2138s
	iters: 200, epoch: 50 | loss: 0.6940758
	speed: 0.0149s/iter; left time: 150.6330s
Epoch: 50 cost time: 3.0041749477386475
Epoch: 50, Steps: 202 | Train Loss: 0.6954222 Vali Loss: 0.6948072 Vali AUC: 0.5237387
EarlyStopping counter: 19 out of 25
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.7170334
	speed: 0.0212s/iter; left time: 212.1848s
	iters: 200, epoch: 51 | loss: 0.6963398
	speed: 0.0155s/iter; left time: 153.6294s
Epoch: 51 cost time: 3.0729877948760986
Epoch: 51, Steps: 202 | Train Loss: 0.6956899 Vali Loss: 0.6952642 Vali AUC: 0.5243161
EarlyStopping counter: 20 out of 25
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.6982883
	speed: 0.0233s/iter; left time: 228.3965s
	iters: 200, epoch: 52 | loss: 0.6890180
	speed: 0.0149s/iter; left time: 144.7207s
Epoch: 52 cost time: 3.020955801010132
Epoch: 52, Steps: 202 | Train Loss: 0.6960368 Vali Loss: 0.6945486 Vali AUC: 0.5235334
EarlyStopping counter: 21 out of 25
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.7096440
	speed: 0.0212s/iter; left time: 203.5497s
	iters: 200, epoch: 53 | loss: 0.6868654
	speed: 0.0172s/iter; left time: 163.1638s
Epoch: 53 cost time: 3.234011173248291
Epoch: 53, Steps: 202 | Train Loss: 0.6937693 Vali Loss: 0.6952786 Vali AUC: 0.5241023
EarlyStopping counter: 22 out of 25
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.6708626
	speed: 0.0213s/iter; left time: 200.4695s
	iters: 200, epoch: 54 | loss: 0.6889744
	speed: 0.0149s/iter; left time: 138.1089s
Epoch: 54 cost time: 3.005434274673462
Epoch: 54, Steps: 202 | Train Loss: 0.6952268 Vali Loss: 0.6947976 Vali AUC: 0.5241831
EarlyStopping counter: 23 out of 25
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.6797112
	speed: 0.0221s/iter; left time: 202.8327s
	iters: 200, epoch: 55 | loss: 0.6876191
	speed: 0.0150s/iter; left time: 136.0661s
Epoch: 55 cost time: 3.0912387371063232
Epoch: 55, Steps: 202 | Train Loss: 0.6957653 Vali Loss: 0.6939114 Vali AUC: 0.5240064
Validation loss decreased (0.694462 --> 0.693911).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.7128412
	speed: 0.0220s/iter; left time: 197.6123s
	iters: 200, epoch: 56 | loss: 0.6838545
	speed: 0.0151s/iter; left time: 134.2304s
Epoch: 56 cost time: 3.051896095275879
Epoch: 56, Steps: 202 | Train Loss: 0.6949461 Vali Loss: 0.6950226 Vali AUC: 0.5237825
EarlyStopping counter: 1 out of 25
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.6831853
	speed: 0.0215s/iter; left time: 189.2890s
	iters: 200, epoch: 57 | loss: 0.7071227
	speed: 0.0151s/iter; left time: 131.2801s
Epoch: 57 cost time: 3.048956871032715
Epoch: 57, Steps: 202 | Train Loss: 0.6947584 Vali Loss: 0.6953060 Vali AUC: 0.5240586
EarlyStopping counter: 2 out of 25
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.7178483
	speed: 0.0214s/iter; left time: 184.1906s
	iters: 200, epoch: 58 | loss: 0.7098087
	speed: 0.0150s/iter; left time: 127.3005s
Epoch: 58 cost time: 3.0316593647003174
Epoch: 58, Steps: 202 | Train Loss: 0.6951586 Vali Loss: 0.6951333 Vali AUC: 0.5240518
EarlyStopping counter: 3 out of 25
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.7003239
	speed: 0.0214s/iter; left time: 179.3657s
	iters: 200, epoch: 59 | loss: 0.6895530
	speed: 0.0149s/iter; left time: 123.5706s
Epoch: 59 cost time: 3.022364377975464
Epoch: 59, Steps: 202 | Train Loss: 0.6951062 Vali Loss: 0.6947268 Vali AUC: 0.5234593
EarlyStopping counter: 4 out of 25
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.6575503
	speed: 0.0227s/iter; left time: 185.8565s
	iters: 200, epoch: 60 | loss: 0.6803219
	speed: 0.0151s/iter; left time: 121.7181s
Epoch: 60 cost time: 3.165696382522583
Epoch: 60, Steps: 202 | Train Loss: 0.6952480 Vali Loss: 0.6944111 Vali AUC: 0.5235435
EarlyStopping counter: 5 out of 25
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.6728184
	speed: 0.0213s/iter; left time: 169.9691s
	iters: 200, epoch: 61 | loss: 0.6883416
	speed: 0.0150s/iter; left time: 118.0230s
Epoch: 61 cost time: 3.018310785293579
Epoch: 61, Steps: 202 | Train Loss: 0.6955367 Vali Loss: 0.6945730 Vali AUC: 0.5231614
EarlyStopping counter: 6 out of 25
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.6806622
	speed: 0.0214s/iter; left time: 166.5729s
	iters: 200, epoch: 62 | loss: 0.7091922
	speed: 0.0151s/iter; left time: 115.7669s
Epoch: 62 cost time: 3.039872646331787
Epoch: 62, Steps: 202 | Train Loss: 0.6953850 Vali Loss: 0.6950536 Vali AUC: 0.5236445
EarlyStopping counter: 7 out of 25
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.6833307
	speed: 0.0215s/iter; left time: 162.9601s
	iters: 200, epoch: 63 | loss: 0.7178461
	speed: 0.0151s/iter; left time: 113.0147s
Epoch: 63 cost time: 3.048238515853882
Epoch: 63, Steps: 202 | Train Loss: 0.6956572 Vali Loss: 0.6950309 Vali AUC: 0.5243650
EarlyStopping counter: 8 out of 25
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.7029006
	speed: 0.0215s/iter; left time: 158.4225s
	iters: 200, epoch: 64 | loss: 0.7028737
	speed: 0.0150s/iter; left time: 108.9873s
Epoch: 64 cost time: 3.032147169113159
Epoch: 64, Steps: 202 | Train Loss: 0.6955244 Vali Loss: 0.6947442 Vali AUC: 0.5239374
EarlyStopping counter: 9 out of 25
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.7331542
	speed: 0.0213s/iter; left time: 152.9881s
	iters: 200, epoch: 65 | loss: 0.6891704
	speed: 0.0150s/iter; left time: 106.3957s
Epoch: 65 cost time: 3.0277340412139893
Epoch: 65, Steps: 202 | Train Loss: 0.6948847 Vali Loss: 0.6948808 Vali AUC: 0.5239374
EarlyStopping counter: 10 out of 25
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.6724719
	speed: 0.0214s/iter; left time: 148.8508s
	iters: 200, epoch: 66 | loss: 0.6728827
	speed: 0.0151s/iter; left time: 103.4309s
Epoch: 66 cost time: 3.0314128398895264
Epoch: 66, Steps: 202 | Train Loss: 0.6964355 Vali Loss: 0.6947350 Vali AUC: 0.5237438
EarlyStopping counter: 11 out of 25
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.6808264
	speed: 0.0213s/iter; left time: 144.2056s
	iters: 200, epoch: 67 | loss: 0.6873316
	speed: 0.0150s/iter; left time: 99.8266s
Epoch: 67 cost time: 3.018120288848877
Epoch: 67, Steps: 202 | Train Loss: 0.6944941 Vali Loss: 0.6950222 Vali AUC: 0.5229627
EarlyStopping counter: 12 out of 25
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.6757087
	speed: 0.0215s/iter; left time: 141.0762s
	iters: 200, epoch: 68 | loss: 0.6873130
	speed: 0.0151s/iter; left time: 97.7482s
Epoch: 68 cost time: 3.046612024307251
Epoch: 68, Steps: 202 | Train Loss: 0.6945423 Vali Loss: 0.6948078 Vali AUC: 0.5241394
EarlyStopping counter: 13 out of 25
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.7026906
	speed: 0.0214s/iter; left time: 136.1287s
	iters: 200, epoch: 69 | loss: 0.7065732
	speed: 0.0150s/iter; left time: 94.1880s
Epoch: 69 cost time: 3.0325968265533447
Epoch: 69, Steps: 202 | Train Loss: 0.6952054 Vali Loss: 0.6950918 Vali AUC: 0.5244660
EarlyStopping counter: 14 out of 25
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.7083885
	speed: 0.0215s/iter; left time: 132.3493s
	iters: 200, epoch: 70 | loss: 0.7337130
	speed: 0.0150s/iter; left time: 90.7319s
Epoch: 70 cost time: 3.0284957885742188
Epoch: 70, Steps: 202 | Train Loss: 0.6949118 Vali Loss: 0.6948597 Vali AUC: 0.5242673
EarlyStopping counter: 15 out of 25
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.6942579
	speed: 0.0215s/iter; left time: 127.9971s
	iters: 200, epoch: 71 | loss: 0.6843400
	speed: 0.0149s/iter; left time: 87.6193s
Epoch: 71 cost time: 3.0304760932922363
Epoch: 71, Steps: 202 | Train Loss: 0.6944737 Vali Loss: 0.6944599 Vali AUC: 0.5244828
EarlyStopping counter: 16 out of 25
Updating learning rate to 7.735540101454298e-08
	iters: 100, epoch: 72 | loss: 0.6912074
	speed: 0.0214s/iter; left time: 123.5106s
	iters: 200, epoch: 72 | loss: 0.6803593
	speed: 0.0150s/iter; left time: 84.6336s
Epoch: 72 cost time: 3.0284085273742676
Epoch: 72, Steps: 202 | Train Loss: 0.6956311 Vali Loss: 0.6950864 Vali AUC: 0.5248952
EarlyStopping counter: 17 out of 25
Updating learning rate to 6.961986091308869e-08
	iters: 100, epoch: 73 | loss: 0.6952024
	speed: 0.0213s/iter; left time: 118.4728s
	iters: 200, epoch: 73 | loss: 0.6823723
	speed: 0.0150s/iter; left time: 81.7517s
Epoch: 73 cost time: 3.021717071533203
Epoch: 73, Steps: 202 | Train Loss: 0.6942604 Vali Loss: 0.6954656 Vali AUC: 0.5233852
EarlyStopping counter: 18 out of 25
Updating learning rate to 6.265787482177981e-08
	iters: 100, epoch: 74 | loss: 0.6793835
	speed: 0.0213s/iter; left time: 114.0697s
	iters: 200, epoch: 74 | loss: 0.6754688
	speed: 0.0150s/iter; left time: 78.6221s
Epoch: 74 cost time: 3.0185694694519043
Epoch: 74, Steps: 202 | Train Loss: 0.6954415 Vali Loss: 0.6952054 Vali AUC: 0.5242808
EarlyStopping counter: 19 out of 25
Updating learning rate to 5.639208733960184e-08
	iters: 100, epoch: 75 | loss: 0.6873320
	speed: 0.0214s/iter; left time: 110.1296s
	iters: 200, epoch: 75 | loss: 0.7049408
	speed: 0.0149s/iter; left time: 75.5205s
Epoch: 75 cost time: 3.01674222946167
Epoch: 75, Steps: 202 | Train Loss: 0.6963001 Vali Loss: 0.6951682 Vali AUC: 0.5229795
EarlyStopping counter: 20 out of 25
Updating learning rate to 5.075287860564165e-08
	iters: 100, epoch: 76 | loss: 0.7093808
	speed: 0.0213s/iter; left time: 105.4748s
	iters: 200, epoch: 76 | loss: 0.6802711
	speed: 0.0150s/iter; left time: 72.5444s
Epoch: 76 cost time: 3.0168919563293457
Epoch: 76, Steps: 202 | Train Loss: 0.6948844 Vali Loss: 0.6949002 Vali AUC: 0.5239508
EarlyStopping counter: 21 out of 25
Updating learning rate to 4.567759074507749e-08
	iters: 100, epoch: 77 | loss: 0.7062958
	speed: 0.0213s/iter; left time: 101.1359s
	iters: 200, epoch: 77 | loss: 0.7195296
	speed: 0.0149s/iter; left time: 69.4492s
Epoch: 77 cost time: 3.0143377780914307
Epoch: 77, Steps: 202 | Train Loss: 0.6948365 Vali Loss: 0.6948466 Vali AUC: 0.5246107
EarlyStopping counter: 22 out of 25
Updating learning rate to 4.1109831670569744e-08
	iters: 100, epoch: 78 | loss: 0.6932370
	speed: 0.0213s/iter; left time: 96.8553s
	iters: 200, epoch: 78 | loss: 0.7040435
	speed: 0.0149s/iter; left time: 66.4654s
Epoch: 78 cost time: 3.015455961227417
Epoch: 78, Steps: 202 | Train Loss: 0.6947697 Vali Loss: 0.6958412 Vali AUC: 0.5244390
EarlyStopping counter: 23 out of 25
Updating learning rate to 3.6998848503512764e-08
	iters: 100, epoch: 79 | loss: 0.6911035
	speed: 0.0213s/iter; left time: 92.5142s
	iters: 200, epoch: 79 | loss: 0.7049073
	speed: 0.0149s/iter; left time: 63.4025s
Epoch: 79 cost time: 3.0142009258270264
Epoch: 79, Steps: 202 | Train Loss: 0.6956179 Vali Loss: 0.6947342 Vali AUC: 0.5253110
EarlyStopping counter: 24 out of 25
Updating learning rate to 3.3298963653161496e-08
	iters: 100, epoch: 80 | loss: 0.6836429
	speed: 0.0213s/iter; left time: 88.2291s
	iters: 200, epoch: 80 | loss: 0.6853760
	speed: 0.0149s/iter; left time: 60.3593s
Epoch: 80 cost time: 3.0138282775878906
Epoch: 80, Steps: 202 | Train Loss: 0.6940222 Vali Loss: 0.6952449 Vali AUC: 0.5241057
EarlyStopping counter: 25 out of 25
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 1090
Accuracy: 0.5339449541284403, AUC: 0.5240063967679488, Sensitivity: 0.3229357798165138, Specificity: 0.744954128440367, PPV: 0.5587301587301587, NPV: 0.5238709677419355, F1: 0.40930232558139534
