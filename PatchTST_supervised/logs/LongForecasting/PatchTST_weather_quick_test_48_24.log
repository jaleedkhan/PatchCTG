Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=8, c_out=7, checkpoints='./checkpoints/', d_ff=64, d_layers=1, d_model=32, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.1, e_layers=1, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.1, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='weather_quick_test_48_24', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=4, patience=1, pct_start=0.3, pred_len=24, random_seed=2021, revin=1, root_path='./dataset/weather/', seq_len=48, stride=2, subtract_last=0, target='OT', test_flop=False, train_epochs=1, use_amp=False, use_gpu=False, use_multi_gpu=False)
Use CPU
>>>>>>>start training : weather_quick_test_48_24_PatchTST_custom_ftM_sl48_ll48_pl24_dm32_nh4_el1_dl1_df64_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36816
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.3585793
	speed: 0.0242s/iter; left time: 109.0134s
	iters: 200, epoch: 1 | loss: 0.3936895
	speed: 0.0209s/iter; left time: 92.0685s
	iters: 300, epoch: 1 | loss: 0.5610700
	speed: 0.0193s/iter; left time: 83.1148s
	iters: 400, epoch: 1 | loss: 0.6072474
	speed: 0.0169s/iter; left time: 70.9993s
	iters: 500, epoch: 1 | loss: 0.7040648
	speed: 0.0171s/iter; left time: 70.1027s
	iters: 600, epoch: 1 | loss: 0.7261629
	speed: 0.0171s/iter; left time: 68.3039s
	iters: 700, epoch: 1 | loss: 0.4695016
	speed: 0.0179s/iter; left time: 69.7207s
	iters: 800, epoch: 1 | loss: 0.2402541
	speed: 0.0167s/iter; left time: 63.5799s
	iters: 900, epoch: 1 | loss: 2.3032768
	speed: 0.0166s/iter; left time: 61.5190s
	iters: 1000, epoch: 1 | loss: 0.5053053
	speed: 0.0162s/iter; left time: 58.4117s
	iters: 1100, epoch: 1 | loss: 0.2723399
	speed: 0.0159s/iter; left time: 55.6319s
	iters: 1200, epoch: 1 | loss: 0.3902872
	speed: 0.0163s/iter; left time: 55.3920s
	iters: 1300, epoch: 1 | loss: 0.3328434
	speed: 0.0166s/iter; left time: 54.6833s
	iters: 1400, epoch: 1 | loss: 0.4065500
	speed: 0.0165s/iter; left time: 52.9063s
	iters: 1500, epoch: 1 | loss: 0.2630463
	speed: 0.0161s/iter; left time: 49.9852s
	iters: 1600, epoch: 1 | loss: 0.2948745
	speed: 0.0165s/iter; left time: 49.4490s
	iters: 1700, epoch: 1 | loss: 0.5089489
	speed: 0.0156s/iter; left time: 45.2445s
	iters: 1800, epoch: 1 | loss: 0.3682336
	speed: 0.0166s/iter; left time: 46.4569s
	iters: 1900, epoch: 1 | loss: 0.2554444
	speed: 0.0165s/iter; left time: 44.4780s
	iters: 2000, epoch: 1 | loss: 0.7543341
	speed: 0.0162s/iter; left time: 42.2596s
	iters: 2100, epoch: 1 | loss: 0.6074027
	speed: 0.0165s/iter; left time: 41.2057s
	iters: 2200, epoch: 1 | loss: 0.5479980
	speed: 0.0162s/iter; left time: 39.0364s
	iters: 2300, epoch: 1 | loss: 0.4629761
	speed: 0.0158s/iter; left time: 36.3166s
	iters: 2400, epoch: 1 | loss: 0.5058280
	speed: 0.0160s/iter; left time: 35.3414s
	iters: 2500, epoch: 1 | loss: 0.1757609
	speed: 0.0165s/iter; left time: 34.6498s
	iters: 2600, epoch: 1 | loss: 0.3275348
	speed: 0.0169s/iter; left time: 33.7849s
	iters: 2700, epoch: 1 | loss: 0.3877724
	speed: 0.0160s/iter; left time: 30.5297s
	iters: 2800, epoch: 1 | loss: 0.4802722
	speed: 0.0162s/iter; left time: 29.2402s
	iters: 2900, epoch: 1 | loss: 0.4118945
	speed: 0.0169s/iter; left time: 28.8178s
	iters: 3000, epoch: 1 | loss: 0.2735800
	speed: 0.0206s/iter; left time: 33.0493s
	iters: 3100, epoch: 1 | loss: 0.2792638
	speed: 0.0201s/iter; left time: 30.1542s
	iters: 3200, epoch: 1 | loss: 0.2165971
	speed: 0.0213s/iter; left time: 29.8299s
	iters: 3300, epoch: 1 | loss: 0.3264163
	speed: 0.0177s/iter; left time: 23.0748s
	iters: 3400, epoch: 1 | loss: 0.4700756
	speed: 0.0160s/iter; left time: 19.2948s
	iters: 3500, epoch: 1 | loss: 0.2755162
	speed: 0.0165s/iter; left time: 18.2352s
	iters: 3600, epoch: 1 | loss: 0.3465722
	speed: 0.0193s/iter; left time: 19.3650s
	iters: 3700, epoch: 1 | loss: 0.3523376
	speed: 0.0207s/iter; left time: 18.7315s
	iters: 3800, epoch: 1 | loss: 0.4202603
	speed: 0.0208s/iter; left time: 16.6785s
	iters: 3900, epoch: 1 | loss: 0.2384946
	speed: 0.0203s/iter; left time: 14.2987s
	iters: 4000, epoch: 1 | loss: 2.6661975
	speed: 0.0196s/iter; left time: 11.7974s
	iters: 4100, epoch: 1 | loss: 0.2858635
	speed: 0.0199s/iter; left time: 10.0230s
	iters: 4200, epoch: 1 | loss: 0.3486850
	speed: 0.0193s/iter; left time: 7.7968s
	iters: 4300, epoch: 1 | loss: 0.2084623
	speed: 0.0199s/iter; left time: 6.0297s
	iters: 4400, epoch: 1 | loss: 0.3170950
	speed: 0.0193s/iter; left time: 3.9098s
	iters: 4500, epoch: 1 | loss: 0.4112671
	speed: 0.0191s/iter; left time: 1.9688s
	iters: 4600, epoch: 1 | loss: 0.2262856
	speed: 0.0190s/iter; left time: 0.0571s
Epoch: 1 cost time: 82.27851057052612
Epoch: 1, Steps: 4602 | Train Loss: 0.5897830 Vali Loss: 0.4319603 Test Loss: 0.1364214
Validation loss decreased (inf --> 0.431960).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : weather_quick_test_48_24_PatchTST_custom_ftM_sl48_ll48_pl24_dm32_nh4_el1_dl1_df64_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.13642147183418274, mae:0.16481135785579681, rse:0.487060010433197
