Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=32, c_out=1, checkpoints='./checkpoints/ctg', d_ff=320, d_layers=1, d_model=256, data='CTG', data_path='X.npy', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=4, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.1, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=25, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=16, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=15, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=50, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm256_nh16_el4_df320_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train set size: 16471
val set size: 4118
Dataset saved to ./jResults/20240917 1633
test set size: 4118
	iters: 100, epoch: 1 | loss: 0.6613337
	speed: 0.1908s/iter; left time: 4893.6136s
	iters: 200, epoch: 1 | loss: 0.7858240
	speed: 0.0185s/iter; left time: 472.1667s
	iters: 300, epoch: 1 | loss: 0.7207150
	speed: 0.0185s/iter; left time: 470.3565s
	iters: 400, epoch: 1 | loss: 0.6572087
	speed: 0.0185s/iter; left time: 468.3735s
	iters: 500, epoch: 1 | loss: 0.7507768
	speed: 0.0184s/iter; left time: 464.3352s
Epoch: 1 cost time: 27.787920236587524
Epoch: 1, Steps: 515 | Train Loss: 0.7118911 Vali Loss: 0.6970103 Vali AUC: 0.6424723
Validation loss decreased (inf --> 0.697010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6394548
	speed: 0.5242s/iter; left time: 13176.3252s
	iters: 200, epoch: 2 | loss: 0.6872576
	speed: 0.0185s/iter; left time: 462.2775s
	iters: 300, epoch: 2 | loss: 0.6452697
	speed: 0.0185s/iter; left time: 460.4742s
	iters: 400, epoch: 2 | loss: 0.6758032
	speed: 0.0185s/iter; left time: 458.4489s
	iters: 500, epoch: 2 | loss: 0.6285452
	speed: 0.0184s/iter; left time: 454.9215s
Epoch: 2 cost time: 27.351433277130127
Epoch: 2, Steps: 515 | Train Loss: 0.6746676 Vali Loss: 0.6452906 Vali AUC: 0.7559356
Validation loss decreased (0.697010 --> 0.645291).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6707050
	speed: 0.5239s/iter; left time: 12900.1068s
	iters: 200, epoch: 3 | loss: 0.6353731
	speed: 0.0185s/iter; left time: 453.2148s
	iters: 300, epoch: 3 | loss: 0.6289512
	speed: 0.0185s/iter; left time: 451.4241s
	iters: 400, epoch: 3 | loss: 0.6784767
	speed: 0.0185s/iter; left time: 449.4884s
	iters: 500, epoch: 3 | loss: 0.6002178
	speed: 0.0184s/iter; left time: 445.7175s
Epoch: 3 cost time: 27.439719676971436
Epoch: 3, Steps: 515 | Train Loss: 0.6516724 Vali Loss: 0.6436734 Vali AUC: 0.7546572
Validation loss decreased (0.645291 --> 0.643673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6049454
	speed: 0.5264s/iter; left time: 12690.3941s
	iters: 200, epoch: 4 | loss: 0.5888166
	speed: 0.0185s/iter; left time: 443.7268s
	iters: 300, epoch: 4 | loss: 0.6319882
	speed: 0.0185s/iter; left time: 441.8049s
	iters: 400, epoch: 4 | loss: 0.6501237
	speed: 0.0185s/iter; left time: 439.9577s
	iters: 500, epoch: 4 | loss: 0.6300182
	speed: 0.0184s/iter; left time: 436.1526s
Epoch: 4 cost time: 27.466119050979614
Epoch: 4, Steps: 515 | Train Loss: 0.6456407 Vali Loss: 0.6389347 Vali AUC: 0.7746364
Validation loss decreased (0.643673 --> 0.638935).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6647277
	speed: 0.5242s/iter; left time: 12366.3121s
	iters: 200, epoch: 5 | loss: 0.6643958
	speed: 0.0185s/iter; left time: 434.2420s
	iters: 300, epoch: 5 | loss: 0.6048827
	speed: 0.0185s/iter; left time: 432.5143s
	iters: 400, epoch: 5 | loss: 0.6451315
	speed: 0.0185s/iter; left time: 430.7680s
	iters: 500, epoch: 5 | loss: 0.6446614
	speed: 0.0184s/iter; left time: 426.8540s
Epoch: 5 cost time: 27.39414882659912
Epoch: 5, Steps: 515 | Train Loss: 0.6387040 Vali Loss: 0.6350933 Vali AUC: 0.7758551
Validation loss decreased (0.638935 --> 0.635093).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5985847
	speed: 0.5239s/iter; left time: 12089.2501s
	iters: 200, epoch: 6 | loss: 0.6361696
	speed: 0.0185s/iter; left time: 424.6908s
	iters: 300, epoch: 6 | loss: 0.6911689
	speed: 0.0185s/iter; left time: 422.8345s
	iters: 400, epoch: 6 | loss: 0.5818866
	speed: 0.0185s/iter; left time: 421.1229s
	iters: 500, epoch: 6 | loss: 0.5297076
	speed: 0.0184s/iter; left time: 417.2681s
Epoch: 6 cost time: 27.329236030578613
Epoch: 6, Steps: 515 | Train Loss: 0.6372397 Vali Loss: 0.6336565 Vali AUC: 0.7815912
Validation loss decreased (0.635093 --> 0.633656).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6574011
	speed: 0.5232s/iter; left time: 11804.2027s
	iters: 200, epoch: 7 | loss: 0.5784543
	speed: 0.0185s/iter; left time: 415.4292s
	iters: 300, epoch: 7 | loss: 0.6462065
	speed: 0.0185s/iter; left time: 413.4486s
	iters: 400, epoch: 7 | loss: 0.6562120
	speed: 0.0185s/iter; left time: 411.6909s
	iters: 500, epoch: 7 | loss: 0.6451331
	speed: 0.0184s/iter; left time: 407.9331s
Epoch: 7 cost time: 27.32128095626831
Epoch: 7, Steps: 515 | Train Loss: 0.6346385 Vali Loss: 0.6327678 Vali AUC: 0.7832480
Validation loss decreased (0.633656 --> 0.632768).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5651140
	speed: 0.5245s/iter; left time: 11564.1800s
	iters: 200, epoch: 8 | loss: 0.6798011
	speed: 0.0185s/iter; left time: 406.0426s
	iters: 300, epoch: 8 | loss: 0.6234010
	speed: 0.0185s/iter; left time: 404.1268s
	iters: 400, epoch: 8 | loss: 0.6010607
	speed: 0.0185s/iter; left time: 402.5710s
	iters: 500, epoch: 8 | loss: 0.5937197
	speed: 0.0184s/iter; left time: 398.8384s
Epoch: 8 cost time: 27.34419894218445
Epoch: 8, Steps: 515 | Train Loss: 0.6324701 Vali Loss: 0.6323505 Vali AUC: 0.7826322
Validation loss decreased (0.632768 --> 0.632350).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6605167
	speed: 0.5232s/iter; left time: 11264.0670s
	iters: 200, epoch: 9 | loss: 0.5665159
	speed: 0.0185s/iter; left time: 395.5482s
	iters: 300, epoch: 9 | loss: 0.5771435
	speed: 0.0185s/iter; left time: 394.9779s
	iters: 400, epoch: 9 | loss: 0.6357512
	speed: 0.0185s/iter; left time: 392.7699s
	iters: 500, epoch: 9 | loss: 0.5737193
	speed: 0.0184s/iter; left time: 389.0064s
Epoch: 9 cost time: 27.270756006240845
Epoch: 9, Steps: 515 | Train Loss: 0.6313294 Vali Loss: 0.6313844 Vali AUC: 0.7816097
Validation loss decreased (0.632350 --> 0.631384).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6359584
	speed: 0.5215s/iter; left time: 10960.5135s
	iters: 200, epoch: 10 | loss: 0.6165817
	speed: 0.0184s/iter; left time: 384.9904s
	iters: 300, epoch: 10 | loss: 0.6111571
	speed: 0.0184s/iter; left time: 383.6980s
	iters: 400, epoch: 10 | loss: 0.6092013
	speed: 0.0184s/iter; left time: 381.4621s
	iters: 500, epoch: 10 | loss: 0.5891421
	speed: 0.0183s/iter; left time: 377.7169s
Epoch: 10 cost time: 27.307425498962402
Epoch: 10, Steps: 515 | Train Loss: 0.6281694 Vali Loss: 0.6320413 Vali AUC: 0.7851465
EarlyStopping counter: 1 out of 15
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6361447
	speed: 0.5212s/iter; left time: 10684.9958s
	iters: 200, epoch: 11 | loss: 0.6870247
	speed: 0.0185s/iter; left time: 376.6485s
	iters: 300, epoch: 11 | loss: 0.6525846
	speed: 0.0185s/iter; left time: 374.7036s
	iters: 400, epoch: 11 | loss: 0.5992354
	speed: 0.0185s/iter; left time: 373.1211s
	iters: 500, epoch: 11 | loss: 0.5502841
	speed: 0.0184s/iter; left time: 369.3449s
Epoch: 11 cost time: 27.228992223739624
Epoch: 11, Steps: 515 | Train Loss: 0.6264398 Vali Loss: 0.6313937 Vali AUC: 0.7815377
EarlyStopping counter: 2 out of 15
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6759825
	speed: 0.5212s/iter; left time: 10417.7013s
	iters: 200, epoch: 12 | loss: 0.6067195
	speed: 0.0185s/iter; left time: 366.9280s
	iters: 300, epoch: 12 | loss: 0.6290535
	speed: 0.0185s/iter; left time: 365.3115s
	iters: 400, epoch: 12 | loss: 0.5869346
	speed: 0.0184s/iter; left time: 363.1431s
	iters: 500, epoch: 12 | loss: 0.7022791
	speed: 0.0184s/iter; left time: 359.8494s
Epoch: 12 cost time: 27.315925121307373
Epoch: 12, Steps: 515 | Train Loss: 0.6256809 Vali Loss: 0.6304112 Vali AUC: 0.7855863
Validation loss decreased (0.631384 --> 0.630411).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6437137
	speed: 0.5238s/iter; left time: 10198.8102s
	iters: 200, epoch: 13 | loss: 0.5932374
	speed: 0.0184s/iter; left time: 357.0047s
	iters: 300, epoch: 13 | loss: 0.5858531
	speed: 0.0184s/iter; left time: 355.3590s
	iters: 400, epoch: 13 | loss: 0.6818626
	speed: 0.0184s/iter; left time: 353.4201s
	iters: 500, epoch: 13 | loss: 0.6348569
	speed: 0.0184s/iter; left time: 350.0543s
Epoch: 13 cost time: 27.254737854003906
Epoch: 13, Steps: 515 | Train Loss: 0.6263000 Vali Loss: 0.6302288 Vali AUC: 0.7842118
Validation loss decreased (0.630411 --> 0.630229).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6424596
	speed: 0.5220s/iter; left time: 9894.3799s
	iters: 200, epoch: 14 | loss: 0.6710720
	speed: 0.0184s/iter; left time: 347.7810s
	iters: 300, epoch: 14 | loss: 0.6877601
	speed: 0.0184s/iter; left time: 345.9366s
	iters: 400, epoch: 14 | loss: 0.6470226
	speed: 0.0184s/iter; left time: 344.0710s
	iters: 500, epoch: 14 | loss: 0.6667050
	speed: 0.0184s/iter; left time: 341.0265s
Epoch: 14 cost time: 27.273778915405273
Epoch: 14, Steps: 515 | Train Loss: 0.6244626 Vali Loss: 0.6293955 Vali AUC: 0.7863150
Validation loss decreased (0.630229 --> 0.629395).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6759354
	speed: 0.5216s/iter; left time: 9617.9239s
	iters: 200, epoch: 15 | loss: 0.6997673
	speed: 0.0184s/iter; left time: 337.9848s
	iters: 300, epoch: 15 | loss: 0.6064802
	speed: 0.0185s/iter; left time: 336.8082s
	iters: 400, epoch: 15 | loss: 0.6590958
	speed: 0.0185s/iter; left time: 335.0614s
	iters: 500, epoch: 15 | loss: 0.7075281
	speed: 0.0184s/iter; left time: 331.7168s
Epoch: 15 cost time: 27.238526582717896
Epoch: 15, Steps: 515 | Train Loss: 0.6220654 Vali Loss: 0.6317281 Vali AUC: 0.7839738
EarlyStopping counter: 1 out of 15
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6229730
	speed: 0.5221s/iter; left time: 9358.3030s
	iters: 200, epoch: 16 | loss: 0.5504138
	speed: 0.0185s/iter; left time: 329.1822s
	iters: 300, epoch: 16 | loss: 0.6297299
	speed: 0.0185s/iter; left time: 327.5419s
	iters: 400, epoch: 16 | loss: 0.5088999
	speed: 0.0185s/iter; left time: 325.6455s
	iters: 500, epoch: 16 | loss: 0.5829920
	speed: 0.0184s/iter; left time: 322.2339s
Epoch: 16 cost time: 27.27549958229065
Epoch: 16, Steps: 515 | Train Loss: 0.6224512 Vali Loss: 0.6317850 Vali AUC: 0.7824019
EarlyStopping counter: 2 out of 15
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6158794
	speed: 0.5235s/iter; left time: 9115.2255s
	iters: 200, epoch: 17 | loss: 0.6082280
	speed: 0.0184s/iter; left time: 319.1821s
	iters: 300, epoch: 17 | loss: 0.6256053
	speed: 0.0184s/iter; left time: 316.9137s
	iters: 400, epoch: 17 | loss: 0.6990009
	speed: 0.0185s/iter; left time: 316.1978s
	iters: 500, epoch: 17 | loss: 0.6197129
	speed: 0.0184s/iter; left time: 313.3829s
Epoch: 17 cost time: 27.213333129882812
Epoch: 17, Steps: 515 | Train Loss: 0.6218378 Vali Loss: 0.6297667 Vali AUC: 0.7867487
EarlyStopping counter: 3 out of 15
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.5901688
	speed: 0.5219s/iter; left time: 8817.8008s
	iters: 200, epoch: 18 | loss: 0.6037278
	speed: 0.0184s/iter; left time: 309.4890s
	iters: 300, epoch: 18 | loss: 0.6171293
	speed: 0.0185s/iter; left time: 308.2380s
	iters: 400, epoch: 18 | loss: 0.6122221
	speed: 0.0185s/iter; left time: 306.4793s
	iters: 500, epoch: 18 | loss: 0.6053067
	speed: 0.0184s/iter; left time: 303.0606s
Epoch: 18 cost time: 27.25092315673828
Epoch: 18, Steps: 515 | Train Loss: 0.6207055 Vali Loss: 0.6299374 Vali AUC: 0.7860697
EarlyStopping counter: 4 out of 15
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6057416
	speed: 0.5230s/iter; left time: 8567.2904s
	iters: 200, epoch: 19 | loss: 0.6204771
	speed: 0.0185s/iter; left time: 300.6415s
	iters: 300, epoch: 19 | loss: 0.6316700
	speed: 0.0185s/iter; left time: 298.7706s
	iters: 400, epoch: 19 | loss: 0.6457369
	speed: 0.0185s/iter; left time: 296.9565s
	iters: 500, epoch: 19 | loss: 0.6399552
	speed: 0.0184s/iter; left time: 293.7842s
Epoch: 19 cost time: 27.304971933364868
Epoch: 19, Steps: 515 | Train Loss: 0.6211883 Vali Loss: 0.6286077 Vali AUC: 0.7875983
Validation loss decreased (0.629395 --> 0.628608).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6364406
	speed: 0.5221s/iter; left time: 8283.5729s
	iters: 200, epoch: 20 | loss: 0.5921963
	speed: 0.0185s/iter; left time: 291.0208s
	iters: 300, epoch: 20 | loss: 0.6286716
	speed: 0.0184s/iter; left time: 289.0106s
	iters: 400, epoch: 20 | loss: 0.5618790
	speed: 0.0185s/iter; left time: 287.3524s
	iters: 500, epoch: 20 | loss: 0.6264828
	speed: 0.0184s/iter; left time: 284.2714s
Epoch: 20 cost time: 27.302366256713867
Epoch: 20, Steps: 515 | Train Loss: 0.6211583 Vali Loss: 0.6286573 Vali AUC: 0.7871200
EarlyStopping counter: 1 out of 15
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6304892
	speed: 0.5234s/iter; left time: 8034.4165s
	iters: 200, epoch: 21 | loss: 0.5898207
	speed: 0.0185s/iter; left time: 281.5271s
	iters: 300, epoch: 21 | loss: 0.6337054
	speed: 0.0185s/iter; left time: 279.7782s
	iters: 400, epoch: 21 | loss: 0.6565331
	speed: 0.0185s/iter; left time: 277.9884s
	iters: 500, epoch: 21 | loss: 0.6067060
	speed: 0.0184s/iter; left time: 274.8427s
Epoch: 21 cost time: 27.245860815048218
Epoch: 21, Steps: 515 | Train Loss: 0.6198361 Vali Loss: 0.6298424 Vali AUC: 0.7866092
EarlyStopping counter: 2 out of 15
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6644576
	speed: 0.5219s/iter; left time: 7742.8532s
	iters: 200, epoch: 22 | loss: 0.6303428
	speed: 0.0184s/iter; left time: 271.6559s
	iters: 300, epoch: 22 | loss: 0.6836795
	speed: 0.0185s/iter; left time: 270.0356s
	iters: 400, epoch: 22 | loss: 0.6284502
	speed: 0.0185s/iter; left time: 268.3376s
	iters: 500, epoch: 22 | loss: 0.6102229
	speed: 0.0184s/iter; left time: 265.1024s
Epoch: 22 cost time: 27.272230863571167
Epoch: 22, Steps: 515 | Train Loss: 0.6180824 Vali Loss: 0.6297006 Vali AUC: 0.7859230
EarlyStopping counter: 3 out of 15
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6543170
	speed: 0.5230s/iter; left time: 7490.2483s
	iters: 200, epoch: 23 | loss: 0.6285225
	speed: 0.0184s/iter; left time: 262.3352s
	iters: 300, epoch: 23 | loss: 0.5779740
	speed: 0.0185s/iter; left time: 260.5569s
	iters: 400, epoch: 23 | loss: 0.6714262
	speed: 0.0185s/iter; left time: 258.7750s
	iters: 500, epoch: 23 | loss: 0.6088325
	speed: 0.0184s/iter; left time: 255.6404s
Epoch: 23 cost time: 27.337027072906494
Epoch: 23, Steps: 515 | Train Loss: 0.6184148 Vali Loss: 0.6291198 Vali AUC: 0.7867553
EarlyStopping counter: 4 out of 15
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5932897
	speed: 0.5245s/iter; left time: 7241.5638s
	iters: 200, epoch: 24 | loss: 0.5935719
	speed: 0.0185s/iter; left time: 253.1452s
	iters: 300, epoch: 24 | loss: 0.6183870
	speed: 0.0185s/iter; left time: 251.3176s
	iters: 400, epoch: 24 | loss: 0.5889953
	speed: 0.0185s/iter; left time: 249.4356s
	iters: 500, epoch: 24 | loss: 0.5659803
	speed: 0.0184s/iter; left time: 246.5779s
Epoch: 24 cost time: 27.319247245788574
Epoch: 24, Steps: 515 | Train Loss: 0.6176159 Vali Loss: 0.6287848 Vali AUC: 0.7871212
EarlyStopping counter: 5 out of 15
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.5950334
	speed: 0.5223s/iter; left time: 6942.0487s
	iters: 200, epoch: 25 | loss: 0.6507558
	speed: 0.0185s/iter; left time: 243.4961s
	iters: 300, epoch: 25 | loss: 0.6215605
	speed: 0.0185s/iter; left time: 241.6981s
	iters: 400, epoch: 25 | loss: 0.6336707
	speed: 0.0185s/iter; left time: 239.8801s
	iters: 500, epoch: 25 | loss: 0.6260391
	speed: 0.0184s/iter; left time: 236.9891s
Epoch: 25 cost time: 27.239904165267944
Epoch: 25, Steps: 515 | Train Loss: 0.6182715 Vali Loss: 0.6296950 Vali AUC: 0.7874666
EarlyStopping counter: 6 out of 15
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6555524
	speed: 0.5229s/iter; left time: 6680.4344s
	iters: 200, epoch: 26 | loss: 0.6325173
	speed: 0.0185s/iter; left time: 234.1553s
	iters: 300, epoch: 26 | loss: 0.6159849
	speed: 0.0185s/iter; left time: 232.5800s
	iters: 400, epoch: 26 | loss: 0.5978632
	speed: 0.0185s/iter; left time: 230.6211s
	iters: 500, epoch: 26 | loss: 0.6229036
	speed: 0.0184s/iter; left time: 227.7935s
Epoch: 26 cost time: 27.356090784072876
Epoch: 26, Steps: 515 | Train Loss: 0.6176932 Vali Loss: 0.6300735 Vali AUC: 0.7862843
EarlyStopping counter: 7 out of 15
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6234966
	speed: 0.5225s/iter; left time: 6406.8200s
	iters: 200, epoch: 27 | loss: 0.6102017
	speed: 0.0184s/iter; left time: 224.1429s
	iters: 300, epoch: 27 | loss: 0.6301373
	speed: 0.0184s/iter; left time: 222.3389s
	iters: 400, epoch: 27 | loss: 0.6324513
	speed: 0.0184s/iter; left time: 220.2573s
	iters: 500, epoch: 27 | loss: 0.7163126
	speed: 0.0184s/iter; left time: 217.7424s
Epoch: 27 cost time: 27.279409170150757
Epoch: 27, Steps: 515 | Train Loss: 0.6171681 Vali Loss: 0.6294739 Vali AUC: 0.7868534
EarlyStopping counter: 8 out of 15
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6321590
	speed: 0.5227s/iter; left time: 6139.7235s
	iters: 200, epoch: 28 | loss: 0.6338749
	speed: 0.0185s/iter; left time: 215.0653s
	iters: 300, epoch: 28 | loss: 0.6689905
	speed: 0.0185s/iter; left time: 213.1378s
	iters: 400, epoch: 28 | loss: 0.5965157
	speed: 0.0185s/iter; left time: 211.3460s
	iters: 500, epoch: 28 | loss: 0.5932481
	speed: 0.0184s/iter; left time: 208.5328s
Epoch: 28 cost time: 27.371243000030518
Epoch: 28, Steps: 515 | Train Loss: 0.6169788 Vali Loss: 0.6296059 Vali AUC: 0.7876450
EarlyStopping counter: 9 out of 15
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.5558531
	speed: 0.5239s/iter; left time: 5883.5975s
	iters: 200, epoch: 29 | loss: 0.6091934
	speed: 0.0184s/iter; left time: 205.2817s
	iters: 300, epoch: 29 | loss: 0.5658431
	speed: 0.0185s/iter; left time: 203.8340s
	iters: 400, epoch: 29 | loss: 0.6176929
	speed: 0.0185s/iter; left time: 201.9847s
	iters: 500, epoch: 29 | loss: 0.6828692
	speed: 0.0184s/iter; left time: 199.2269s
Epoch: 29 cost time: 27.276934146881104
Epoch: 29, Steps: 515 | Train Loss: 0.6170811 Vali Loss: 0.6288459 Vali AUC: 0.7878395
EarlyStopping counter: 10 out of 15
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6294287
	speed: 0.5227s/iter; left time: 5601.7870s
	iters: 200, epoch: 30 | loss: 0.6467135
	speed: 0.0185s/iter; left time: 196.3956s
	iters: 300, epoch: 30 | loss: 0.6414518
	speed: 0.0185s/iter; left time: 194.2912s
	iters: 400, epoch: 30 | loss: 0.5968971
	speed: 0.0185s/iter; left time: 192.3254s
	iters: 500, epoch: 30 | loss: 0.6331021
	speed: 0.0184s/iter; left time: 189.5186s
Epoch: 30 cost time: 27.306565761566162
Epoch: 30, Steps: 515 | Train Loss: 0.6168319 Vali Loss: 0.6295890 Vali AUC: 0.7873598
EarlyStopping counter: 11 out of 15
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6658028
	speed: 0.5229s/iter; left time: 5334.2637s
	iters: 200, epoch: 31 | loss: 0.5864879
	speed: 0.0185s/iter; left time: 186.7696s
	iters: 300, epoch: 31 | loss: 0.6049908
	speed: 0.0185s/iter; left time: 185.0102s
	iters: 400, epoch: 31 | loss: 0.5939100
	speed: 0.0185s/iter; left time: 183.1324s
	iters: 500, epoch: 31 | loss: 0.6647686
	speed: 0.0184s/iter; left time: 180.3390s
Epoch: 31 cost time: 27.331498861312866
Epoch: 31, Steps: 515 | Train Loss: 0.6171445 Vali Loss: 0.6290812 Vali AUC: 0.7873846
EarlyStopping counter: 12 out of 15
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6555040
	speed: 0.5231s/iter; left time: 5067.0796s
	iters: 200, epoch: 32 | loss: 0.5706397
	speed: 0.0185s/iter; left time: 177.2766s
	iters: 300, epoch: 32 | loss: 0.6307371
	speed: 0.0185s/iter; left time: 175.1840s
	iters: 400, epoch: 32 | loss: 0.6150471
	speed: 0.0185s/iter; left time: 173.2752s
	iters: 500, epoch: 32 | loss: 0.5957330
	speed: 0.0184s/iter; left time: 170.7479s
Epoch: 32 cost time: 27.269691944122314
Epoch: 32, Steps: 515 | Train Loss: 0.6150099 Vali Loss: 0.6293600 Vali AUC: 0.7876474
EarlyStopping counter: 13 out of 15
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6493844
	speed: 0.5226s/iter; left time: 4792.9061s
	iters: 200, epoch: 33 | loss: 0.6830905
	speed: 0.0185s/iter; left time: 167.5911s
	iters: 300, epoch: 33 | loss: 0.6001199
	speed: 0.0185s/iter; left time: 165.9855s
	iters: 400, epoch: 33 | loss: 0.7129437
	speed: 0.0185s/iter; left time: 164.0849s
	iters: 500, epoch: 33 | loss: 0.6712892
	speed: 0.0184s/iter; left time: 161.5101s
Epoch: 33 cost time: 27.306052684783936
Epoch: 33, Steps: 515 | Train Loss: 0.6152786 Vali Loss: 0.6295857 Vali AUC: 0.7878504
EarlyStopping counter: 14 out of 15
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.5565479
	speed: 0.5253s/iter; left time: 4547.0465s
	iters: 200, epoch: 34 | loss: 0.6212324
	speed: 0.0185s/iter; left time: 158.1071s
	iters: 300, epoch: 34 | loss: 0.5855254
	speed: 0.0185s/iter; left time: 156.3204s
	iters: 400, epoch: 34 | loss: 0.5922659
	speed: 0.0185s/iter; left time: 154.3544s
	iters: 500, epoch: 34 | loss: 0.5919684
	speed: 0.0184s/iter; left time: 152.0013s
Epoch: 34 cost time: 27.33263874053955
Epoch: 34, Steps: 515 | Train Loss: 0.6152175 Vali Loss: 0.6296420 Vali AUC: 0.7878717
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm256_nh16_el4_df320_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset saved to ./jResults/20240917 1707
test set size: 4118
accuracy:0.7309373482272948, precision:0.8483535528596187, recall:0.5120292887029289, f1:0.6386170906718851, auc:0.787598343430052
