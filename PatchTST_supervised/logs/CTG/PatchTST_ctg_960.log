Args in experiment:
Namespace(activation='relu', affine=0, batch_size=48, c_out=1, checkpoints='./checkpoints/ctg', d_ff=128, d_layers=1, d_model=512, data='CTG', dataset_path='../ctg_dataset/Old Dataset (Cases Diff 0-2)', dec_in=2, decomposition=0, des='Exp', devices='0,1,2', distil=True, do_predict=False, dropout=0.1, e_layers=6, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.4, features='M', freq='h', gpu=0, head_dropout=0.2, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=15, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', model_to_test=None, moving_avg=25, n_heads=4, num_classes=2, num_workers=0, output_attention=False, padding_patch='end', patch_len=16, patience=25, pct_start=0.3, pre_train_model_path='../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209', random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=16, subtract_last=0, target='OT', test_flop=False, train_epochs=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
Dataset loaded and preprocessed.
train set size: 12448
Dataset loaded and preprocessed.
val set size: 3107
Dataset loaded and preprocessed.
test set size: 3107
Loading pre-trained model from ../ctg_dataset/Old Dataset (Cases Diff 3-7)/trained 20241019 0209/checkpoint.pth for fine-tuning...
Testing the pretrained model on the new dataset before fine-tuning...
Dataset loaded and preprocessed.
test set size: 3107
Loading model from: ./checkpoints/ctg/ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp/checkpoint.pth for testing
Accuracy: 0.6639845510138397, AUC: 0.7171064792162748, Sensitivity: 0.667384284176534, Specificity: 0.662534435261708, PPV: 0.4575645756457565, NPV: 0.8236301369863014, F1: 0.5429071803852888
Trainable parameters: ['classification_head.weight', 'classification_head.bias']
	iters: 100, epoch: 1 | loss: 0.7004375
	speed: 0.0148s/iter; left time: 2.3900s
	iters: 200, epoch: 1 | loss: 0.6787777
	speed: 0.0148s/iter; left time: 0.9045s
Epoch: 1 cost time: 3.8532042503356934
Epoch: 1, Steps: 260 | Train Loss: 0.6832197 Vali Loss: 0.6776361 Vali AUC: 0.7184819
Validation loss decreased (inf --> 0.677636).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm512_nh4_el6_df128_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset loaded and preprocessed.
test set size: 3107
Accuracy: 0.6565819118120373, AUC: 0.7184819127768536, Sensitivity: 0.6953713670613563, Specificity: 0.6400367309458218, PPV: 0.45174825174825173, NPV: 0.8312462731067383, F1: 0.5476896990250106
