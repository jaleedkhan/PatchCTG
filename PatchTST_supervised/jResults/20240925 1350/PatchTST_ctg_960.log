Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=32, c_out=1, checkpoints='./checkpoints/ctg', d_ff=640, d_layers=1, d_model=128, data='CTG', data_path='X.npy', dec_in=2, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=4, embed='timeF', embed_type=0, enc_in=2, factor=1, fc_dropout=0.1, features='M', freq='h', gpu=0, head_dropout=0.1, individual=0, is_optuna=False, is_training=1, itr=1, kernel_size=25, learning_rate=0.0001, loss='cross_entropy', lradj='type3', model='PatchTST', model_id='ctg_960', moving_avg=25, n_heads=8, num_classes=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=8, patience=15, pct_start=0.3, random_seed=2021, revin=1, root_path='./dataset/', seq_len=960, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=50, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ctg_960_PatchTST_CTG_sl960_nc2_dm128_nh8_el4_df640_fc1_Exp>>>>>>>>>>>>>>>>>>>>>>>>>>
train set size: 16471
val set size: 4118
Dataset saved to ./jResults/20240925 1303
test set size: 4118
	iters: 100, epoch: 1 | loss: 0.7060109
	speed: 0.1867s/iter; left time: 4789.9769s
	iters: 200, epoch: 1 | loss: 0.7771786
	speed: 0.0118s/iter; left time: 302.1719s
	iters: 300, epoch: 1 | loss: 0.7152211
	speed: 0.0118s/iter; left time: 301.0317s
	iters: 400, epoch: 1 | loss: 0.6858300
	speed: 0.0118s/iter; left time: 299.5579s
	iters: 500, epoch: 1 | loss: 0.7881079
	speed: 0.0118s/iter; left time: 297.3077s
Epoch: 1 cost time: 24.612632751464844
Epoch: 1, Steps: 515 | Train Loss: 0.7226460 Vali Loss: 0.6991741 Vali AUC: 0.6376120
Validation loss decreased (inf --> 0.699174).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6684085
	speed: 0.5155s/iter; left time: 12956.4061s
	iters: 200, epoch: 2 | loss: 0.6730120
	speed: 0.0118s/iter; left time: 294.9685s
	iters: 300, epoch: 2 | loss: 0.6408871
	speed: 0.0118s/iter; left time: 293.5182s
	iters: 400, epoch: 2 | loss: 0.7121570
	speed: 0.0118s/iter; left time: 292.6613s
	iters: 500, epoch: 2 | loss: 0.6261973
	speed: 0.0117s/iter; left time: 289.7921s
Epoch: 2 cost time: 24.065155029296875
Epoch: 2, Steps: 515 | Train Loss: 0.6767952 Vali Loss: 0.6545400 Vali AUC: 0.7433653
Validation loss decreased (0.699174 --> 0.654540).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7022533
	speed: 0.5147s/iter; left time: 12671.7656s
	iters: 200, epoch: 3 | loss: 0.6564012
	speed: 0.0118s/iter; left time: 289.7809s
	iters: 300, epoch: 3 | loss: 0.6402479
	speed: 0.0118s/iter; left time: 288.3107s
	iters: 400, epoch: 3 | loss: 0.6572834
	speed: 0.0118s/iter; left time: 286.7192s
	iters: 500, epoch: 3 | loss: 0.5831641
	speed: 0.0117s/iter; left time: 284.4065s
Epoch: 3 cost time: 24.02325749397278
Epoch: 3, Steps: 515 | Train Loss: 0.6520226 Vali Loss: 0.6450014 Vali AUC: 0.7442143
Validation loss decreased (0.654540 --> 0.645001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6184345
	speed: 0.5131s/iter; left time: 12369.1784s
	iters: 200, epoch: 4 | loss: 0.5705311
	speed: 0.0119s/iter; left time: 284.5818s
	iters: 300, epoch: 4 | loss: 0.6646470
	speed: 0.0118s/iter; left time: 281.7029s
	iters: 400, epoch: 4 | loss: 0.6656551
	speed: 0.0118s/iter; left time: 280.5015s
	iters: 500, epoch: 4 | loss: 0.6056506
	speed: 0.0117s/iter; left time: 277.8934s
Epoch: 4 cost time: 23.995847940444946
Epoch: 4, Steps: 515 | Train Loss: 0.6460649 Vali Loss: 0.6395782 Vali AUC: 0.7597375
Validation loss decreased (0.645001 --> 0.639578).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6744453
	speed: 0.5144s/iter; left time: 12135.4391s
	iters: 200, epoch: 5 | loss: 0.7035620
	speed: 0.0118s/iter; left time: 277.3725s
	iters: 300, epoch: 5 | loss: 0.5688358
	speed: 0.0118s/iter; left time: 276.5070s
	iters: 400, epoch: 5 | loss: 0.6400605
	speed: 0.0118s/iter; left time: 275.2230s
	iters: 500, epoch: 5 | loss: 0.6312672
	speed: 0.0118s/iter; left time: 273.1023s
Epoch: 5 cost time: 24.045740842819214
Epoch: 5, Steps: 515 | Train Loss: 0.6426725 Vali Loss: 0.6408267 Vali AUC: 0.7752760
EarlyStopping counter: 1 out of 15
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.6103332
	speed: 0.5150s/iter; left time: 11883.0001s
	iters: 200, epoch: 6 | loss: 0.6360263
	speed: 0.0118s/iter; left time: 270.8657s
	iters: 300, epoch: 6 | loss: 0.6672442
	speed: 0.0118s/iter; left time: 269.7313s
	iters: 400, epoch: 6 | loss: 0.5941843
	speed: 0.0118s/iter; left time: 268.5460s
	iters: 500, epoch: 6 | loss: 0.5732356
	speed: 0.0118s/iter; left time: 266.5294s
Epoch: 6 cost time: 24.088775634765625
Epoch: 6, Steps: 515 | Train Loss: 0.6411593 Vali Loss: 0.6396623 Vali AUC: 0.7722590
EarlyStopping counter: 2 out of 15
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.6650085
	speed: 0.5150s/iter; left time: 11618.5212s
	iters: 200, epoch: 7 | loss: 0.5616084
	speed: 0.0118s/iter; left time: 265.7971s
	iters: 300, epoch: 7 | loss: 0.6470655
	speed: 0.0118s/iter; left time: 264.0871s
	iters: 400, epoch: 7 | loss: 0.6337162
	speed: 0.0118s/iter; left time: 262.9801s
	iters: 500, epoch: 7 | loss: 0.6477636
	speed: 0.0118s/iter; left time: 260.6717s
Epoch: 7 cost time: 24.116544485092163
Epoch: 7, Steps: 515 | Train Loss: 0.6403785 Vali Loss: 0.6354264 Vali AUC: 0.7778099
Validation loss decreased (0.639578 --> 0.635426).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6035453
	speed: 0.5148s/iter; left time: 11349.9050s
	iters: 200, epoch: 8 | loss: 0.6812050
	speed: 0.0118s/iter; left time: 259.1295s
	iters: 300, epoch: 8 | loss: 0.6295692
	speed: 0.0118s/iter; left time: 258.0126s
	iters: 400, epoch: 8 | loss: 0.6050153
	speed: 0.0118s/iter; left time: 256.8900s
	iters: 500, epoch: 8 | loss: 0.6196861
	speed: 0.0118s/iter; left time: 254.4068s
Epoch: 8 cost time: 24.117389678955078
Epoch: 8, Steps: 515 | Train Loss: 0.6358272 Vali Loss: 0.6361030 Vali AUC: 0.7695448
EarlyStopping counter: 1 out of 15
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6373733
	speed: 0.5120s/iter; left time: 11023.9368s
	iters: 200, epoch: 9 | loss: 0.5768721
	speed: 0.0118s/iter; left time: 253.3925s
	iters: 300, epoch: 9 | loss: 0.6124167
	speed: 0.0118s/iter; left time: 251.9824s
	iters: 400, epoch: 9 | loss: 0.6186422
	speed: 0.0118s/iter; left time: 250.8597s
	iters: 500, epoch: 9 | loss: 0.5983303
	speed: 0.0118s/iter; left time: 248.3728s
Epoch: 9 cost time: 24.01935076713562
Epoch: 9, Steps: 515 | Train Loss: 0.6359006 Vali Loss: 0.6336802 Vali AUC: 0.7818434
Validation loss decreased (0.635426 --> 0.633680).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.6533448
	speed: 0.5131s/iter; left time: 10783.0543s
	iters: 200, epoch: 10 | loss: 0.6202343
	speed: 0.0118s/iter; left time: 246.9965s
	iters: 300, epoch: 10 | loss: 0.5884531
	speed: 0.0118s/iter; left time: 245.9456s
	iters: 400, epoch: 10 | loss: 0.6178520
	speed: 0.0118s/iter; left time: 244.6186s
	iters: 500, epoch: 10 | loss: 0.5854679
	speed: 0.0118s/iter; left time: 242.4418s
Epoch: 10 cost time: 24.010403871536255
Epoch: 10, Steps: 515 | Train Loss: 0.6342459 Vali Loss: 0.6339636 Vali AUC: 0.7818367
EarlyStopping counter: 1 out of 15
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6135411
	speed: 0.5129s/iter; left time: 10515.9723s
	iters: 200, epoch: 11 | loss: 0.6555454
	speed: 0.0118s/iter; left time: 240.1742s
	iters: 300, epoch: 11 | loss: 0.6201630
	speed: 0.0118s/iter; left time: 238.9664s
	iters: 400, epoch: 11 | loss: 0.6111491
	speed: 0.0118s/iter; left time: 237.9373s
	iters: 500, epoch: 11 | loss: 0.5421402
	speed: 0.0118s/iter; left time: 236.2834s
Epoch: 11 cost time: 24.035853624343872
Epoch: 11, Steps: 515 | Train Loss: 0.6327631 Vali Loss: 0.6344969 Vali AUC: 0.7805018
EarlyStopping counter: 2 out of 15
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.6653250
	speed: 0.5139s/iter; left time: 10270.3421s
	iters: 200, epoch: 12 | loss: 0.6184058
	speed: 0.0118s/iter; left time: 234.4631s
	iters: 300, epoch: 12 | loss: 0.6361619
	speed: 0.0118s/iter; left time: 233.1439s
	iters: 400, epoch: 12 | loss: 0.5617807
	speed: 0.0118s/iter; left time: 231.9421s
	iters: 500, epoch: 12 | loss: 0.6930436
	speed: 0.0117s/iter; left time: 229.9860s
Epoch: 12 cost time: 24.099334239959717
Epoch: 12, Steps: 515 | Train Loss: 0.6328910 Vali Loss: 0.6323131 Vali AUC: 0.7831960
Validation loss decreased (0.633680 --> 0.632313).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6765064
	speed: 0.5142s/iter; left time: 10011.5018s
	iters: 200, epoch: 13 | loss: 0.5967666
	speed: 0.0118s/iter; left time: 228.7610s
	iters: 300, epoch: 13 | loss: 0.6256504
	speed: 0.0118s/iter; left time: 227.4998s
	iters: 400, epoch: 13 | loss: 0.6657844
	speed: 0.0118s/iter; left time: 226.1034s
	iters: 500, epoch: 13 | loss: 0.6280336
	speed: 0.0118s/iter; left time: 224.8733s
Epoch: 13 cost time: 24.00598931312561
Epoch: 13, Steps: 515 | Train Loss: 0.6301315 Vali Loss: 0.6343397 Vali AUC: 0.7789307
EarlyStopping counter: 1 out of 15
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6082142
	speed: 0.5131s/iter; left time: 9725.8171s
	iters: 200, epoch: 14 | loss: 0.6531551
	speed: 0.0118s/iter; left time: 223.2169s
	iters: 300, epoch: 14 | loss: 0.6812395
	speed: 0.0118s/iter; left time: 222.1052s
	iters: 400, epoch: 14 | loss: 0.6492468
	speed: 0.0118s/iter; left time: 221.0139s
	iters: 500, epoch: 14 | loss: 0.6664917
	speed: 0.0118s/iter; left time: 218.5830s
Epoch: 14 cost time: 24.082231760025024
Epoch: 14, Steps: 515 | Train Loss: 0.6315227 Vali Loss: 0.6314853 Vali AUC: 0.7823017
Validation loss decreased (0.632313 --> 0.631485).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6605031
	speed: 0.5138s/iter; left time: 9475.2778s
	iters: 200, epoch: 15 | loss: 0.6532933
	speed: 0.0118s/iter; left time: 216.7697s
	iters: 300, epoch: 15 | loss: 0.6398450
	speed: 0.0118s/iter; left time: 215.7822s
	iters: 400, epoch: 15 | loss: 0.6688092
	speed: 0.0118s/iter; left time: 214.5526s
	iters: 500, epoch: 15 | loss: 0.7235424
	speed: 0.0118s/iter; left time: 212.2073s
Epoch: 15 cost time: 24.041347980499268
Epoch: 15, Steps: 515 | Train Loss: 0.6304019 Vali Loss: 0.6329695 Vali AUC: 0.7820515
EarlyStopping counter: 1 out of 15
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.6455001
	speed: 0.5137s/iter; left time: 9208.6007s
	iters: 200, epoch: 16 | loss: 0.5759813
	speed: 0.0118s/iter; left time: 210.3923s
	iters: 300, epoch: 16 | loss: 0.6466609
	speed: 0.0118s/iter; left time: 209.4847s
	iters: 400, epoch: 16 | loss: 0.5308617
	speed: 0.0118s/iter; left time: 208.1866s
	iters: 500, epoch: 16 | loss: 0.5711468
	speed: 0.0118s/iter; left time: 206.3432s
Epoch: 16 cost time: 24.02946662902832
Epoch: 16, Steps: 515 | Train Loss: 0.6300404 Vali Loss: 0.6317900 Vali AUC: 0.7818229
EarlyStopping counter: 2 out of 15
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6534920
	speed: 0.5142s/iter; left time: 8952.6900s
	iters: 200, epoch: 17 | loss: 0.5797905
	speed: 0.0118s/iter; left time: 204.6789s
	iters: 300, epoch: 17 | loss: 0.6304047
	speed: 0.0118s/iter; left time: 203.5124s
	iters: 400, epoch: 17 | loss: 0.7135401
	speed: 0.0118s/iter; left time: 202.3782s
	iters: 500, epoch: 17 | loss: 0.6168804
	speed: 0.0118s/iter; left time: 200.0018s
Epoch: 17 cost time: 24.046549797058105
Epoch: 17, Steps: 515 | Train Loss: 0.6290733 Vali Loss: 0.6311484 Vali AUC: 0.7822798
Validation loss decreased (0.631485 --> 0.631148).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6066938
	speed: 0.5137s/iter; left time: 8678.7217s
	iters: 200, epoch: 18 | loss: 0.6203651
	speed: 0.0118s/iter; left time: 197.4241s
	iters: 300, epoch: 18 | loss: 0.6194215
	speed: 0.0118s/iter; left time: 196.9651s
	iters: 400, epoch: 18 | loss: 0.6509835
	speed: 0.0118s/iter; left time: 195.7232s
	iters: 500, epoch: 18 | loss: 0.6420194
	speed: 0.0117s/iter; left time: 193.7520s
Epoch: 18 cost time: 23.994367122650146
Epoch: 18, Steps: 515 | Train Loss: 0.6286068 Vali Loss: 0.6309552 Vali AUC: 0.7845862
Validation loss decreased (0.631148 --> 0.630955).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.6419568
	speed: 0.5138s/iter; left time: 8416.5477s
	iters: 200, epoch: 19 | loss: 0.6295650
	speed: 0.0118s/iter; left time: 192.2304s
	iters: 300, epoch: 19 | loss: 0.6073856
	speed: 0.0118s/iter; left time: 191.0523s
	iters: 400, epoch: 19 | loss: 0.6382794
	speed: 0.0118s/iter; left time: 190.1822s
	iters: 500, epoch: 19 | loss: 0.6776870
	speed: 0.0118s/iter; left time: 187.9362s
Epoch: 19 cost time: 24.0132954120636
Epoch: 19, Steps: 515 | Train Loss: 0.6279167 Vali Loss: 0.6320055 Vali AUC: 0.7832034
EarlyStopping counter: 1 out of 15
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6149143
	speed: 0.5155s/iter; left time: 8178.7253s
	iters: 200, epoch: 20 | loss: 0.6380708
	speed: 0.0118s/iter; left time: 185.9836s
	iters: 300, epoch: 20 | loss: 0.6399791
	speed: 0.0118s/iter; left time: 184.8630s
	iters: 400, epoch: 20 | loss: 0.5748981
	speed: 0.0118s/iter; left time: 183.5535s
	iters: 500, epoch: 20 | loss: 0.6353521
	speed: 0.0117s/iter; left time: 181.4756s
Epoch: 20 cost time: 24.018723964691162
Epoch: 20, Steps: 515 | Train Loss: 0.6284937 Vali Loss: 0.6313874 Vali AUC: 0.7839191
EarlyStopping counter: 2 out of 15
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6427997
	speed: 0.5119s/iter; left time: 7858.6823s
	iters: 200, epoch: 21 | loss: 0.5992696
	speed: 0.0118s/iter; left time: 180.1192s
	iters: 300, epoch: 21 | loss: 0.6167026
	speed: 0.0118s/iter; left time: 179.0023s
	iters: 400, epoch: 21 | loss: 0.6145936
	speed: 0.0118s/iter; left time: 177.7260s
	iters: 500, epoch: 21 | loss: 0.6341445
	speed: 0.0118s/iter; left time: 176.0128s
Epoch: 21 cost time: 24.018879175186157
Epoch: 21, Steps: 515 | Train Loss: 0.6281852 Vali Loss: 0.6317072 Vali AUC: 0.7843510
EarlyStopping counter: 3 out of 15
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6526816
	speed: 0.5131s/iter; left time: 7611.7972s
	iters: 200, epoch: 22 | loss: 0.6239147
	speed: 0.0118s/iter; left time: 174.0078s
	iters: 300, epoch: 22 | loss: 0.6943828
	speed: 0.0118s/iter; left time: 172.8923s
	iters: 400, epoch: 22 | loss: 0.6506772
	speed: 0.0118s/iter; left time: 171.5188s
	iters: 500, epoch: 22 | loss: 0.6412450
	speed: 0.0118s/iter; left time: 169.7206s
Epoch: 22 cost time: 23.995086431503296
Epoch: 22, Steps: 515 | Train Loss: 0.6292971 Vali Loss: 0.6307475 Vali AUC: 0.7848328
Validation loss decreased (0.630955 --> 0.630748).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6509889
	speed: 0.5139s/iter; left time: 7359.0766s
	iters: 200, epoch: 23 | loss: 0.6030823
	speed: 0.0119s/iter; left time: 168.6534s
	iters: 300, epoch: 23 | loss: 0.5953294
	speed: 0.0118s/iter; left time: 167.2694s
	iters: 400, epoch: 23 | loss: 0.6640953
	speed: 0.0119s/iter; left time: 166.2373s
	iters: 500, epoch: 23 | loss: 0.6276112
	speed: 0.0118s/iter; left time: 164.2610s
Epoch: 23 cost time: 24.13444948196411
Epoch: 23, Steps: 515 | Train Loss: 0.6257823 Vali Loss: 0.6303832 Vali AUC: 0.7859368
Validation loss decreased (0.630748 --> 0.630383).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5946039
	speed: 0.5144s/iter; left time: 7101.9204s
	iters: 200, epoch: 24 | loss: 0.6073507
	speed: 0.0118s/iter; left time: 161.7525s
	iters: 300, epoch: 24 | loss: 0.6060750
	speed: 0.0118s/iter; left time: 160.4841s
	iters: 400, epoch: 24 | loss: 0.6226889
	speed: 0.0118s/iter; left time: 159.1231s
	iters: 500, epoch: 24 | loss: 0.5677937
	speed: 0.0117s/iter; left time: 157.3421s
Epoch: 24 cost time: 24.082800149917603
Epoch: 24, Steps: 515 | Train Loss: 0.6269494 Vali Loss: 0.6307258 Vali AUC: 0.7844235
EarlyStopping counter: 1 out of 15
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.5916780
	speed: 0.5139s/iter; left time: 6830.6334s
	iters: 200, epoch: 25 | loss: 0.6346031
	speed: 0.0118s/iter; left time: 155.8750s
	iters: 300, epoch: 25 | loss: 0.6032959
	speed: 0.0118s/iter; left time: 154.8808s
	iters: 400, epoch: 25 | loss: 0.6291844
	speed: 0.0118s/iter; left time: 153.3652s
	iters: 500, epoch: 25 | loss: 0.6225718
	speed: 0.0118s/iter; left time: 151.6588s
Epoch: 25 cost time: 24.075997591018677
Epoch: 25, Steps: 515 | Train Loss: 0.6273041 Vali Loss: 0.6307183 Vali AUC: 0.7850782
EarlyStopping counter: 2 out of 15
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.6901619
	speed: 0.5149s/iter; left time: 6578.8213s
	iters: 200, epoch: 26 | loss: 0.6470307
	speed: 0.0118s/iter; left time: 149.5272s
	iters: 300, epoch: 26 | loss: 0.6340305
	speed: 0.0118s/iter; left time: 148.5161s
	iters: 400, epoch: 26 | loss: 0.5836271
	speed: 0.0118s/iter; left time: 147.4351s
	iters: 500, epoch: 26 | loss: 0.6180552
	speed: 0.0117s/iter; left time: 145.3378s
Epoch: 26 cost time: 24.140251636505127
Epoch: 26, Steps: 515 | Train Loss: 0.6261550 Vali Loss: 0.6308430 Vali AUC: 0.7848046
EarlyStopping counter: 3 out of 15
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6345260
	speed: 0.5151s/iter; left time: 6315.9157s
	iters: 200, epoch: 27 | loss: 0.6044689
	speed: 0.0118s/iter; left time: 143.8509s
	iters: 300, epoch: 27 | loss: 0.6347029
	speed: 0.0118s/iter; left time: 142.5252s
	iters: 400, epoch: 27 | loss: 0.6306131
	speed: 0.0118s/iter; left time: 141.4844s
	iters: 500, epoch: 27 | loss: 0.6968322
	speed: 0.0118s/iter; left time: 139.4765s
Epoch: 27 cost time: 24.048582792282104
Epoch: 27, Steps: 515 | Train Loss: 0.6269794 Vali Loss: 0.6311435 Vali AUC: 0.7857991
EarlyStopping counter: 4 out of 15
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.6394373
	speed: 0.5136s/iter; left time: 6032.7306s
	iters: 200, epoch: 28 | loss: 0.6583753
	speed: 0.0118s/iter; left time: 137.2926s
	iters: 300, epoch: 28 | loss: 0.7093331
	speed: 0.0118s/iter; left time: 136.2488s
	iters: 400, epoch: 28 | loss: 0.6192083
	speed: 0.0118s/iter; left time: 134.9080s
	iters: 500, epoch: 28 | loss: 0.6232206
	speed: 0.0118s/iter; left time: 133.3589s
Epoch: 28 cost time: 24.049156188964844
Epoch: 28, Steps: 515 | Train Loss: 0.6262762 Vali Loss: 0.6315135 Vali AUC: 0.7857108
EarlyStopping counter: 5 out of 15
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.5863163
	speed: 0.5136s/iter; left time: 5768.8029s
	iters: 200, epoch: 29 | loss: 0.5922059
	speed: 0.0118s/iter; left time: 131.0774s
	iters: 300, epoch: 29 | loss: 0.5985054
	speed: 0.0118s/iter; left time: 129.6370s
	iters: 400, epoch: 29 | loss: 0.6327186
	speed: 0.0118s/iter; left time: 128.5303s
	iters: 500, epoch: 29 | loss: 0.6153939
	speed: 0.0117s/iter; left time: 126.8379s
Epoch: 29 cost time: 24.067007303237915
Epoch: 29, Steps: 515 | Train Loss: 0.6253314 Vali Loss: 0.6307981 Vali AUC: 0.7868071
EarlyStopping counter: 6 out of 15
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.6038005
	speed: 0.5130s/iter; left time: 5497.6323s
	iters: 200, epoch: 30 | loss: 0.6508529
	speed: 0.0118s/iter; left time: 124.8789s
	iters: 300, epoch: 30 | loss: 0.6365598
	speed: 0.0118s/iter; left time: 123.7988s
	iters: 400, epoch: 30 | loss: 0.6407313
	speed: 0.0118s/iter; left time: 122.4523s
	iters: 500, epoch: 30 | loss: 0.6267523
	speed: 0.0117s/iter; left time: 121.0105s
Epoch: 30 cost time: 24.036035537719727
Epoch: 30, Steps: 515 | Train Loss: 0.6259271 Vali Loss: 0.6312553 Vali AUC: 0.7856373
EarlyStopping counter: 7 out of 15
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.6368740
	speed: 0.5139s/iter; left time: 5242.5384s
	iters: 200, epoch: 31 | loss: 0.5991272
	speed: 0.0118s/iter; left time: 118.9357s
	iters: 300, epoch: 31 | loss: 0.6446031
	speed: 0.0118s/iter; left time: 117.8726s
	iters: 400, epoch: 31 | loss: 0.6170572
	speed: 0.0118s/iter; left time: 116.6490s
	iters: 500, epoch: 31 | loss: 0.6662315
	speed: 0.0117s/iter; left time: 115.0463s
Epoch: 31 cost time: 24.037578582763672
Epoch: 31, Steps: 515 | Train Loss: 0.6245726 Vali Loss: 0.6301806 Vali AUC: 0.7863394
Validation loss decreased (0.630383 --> 0.630181).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.6624969
	speed: 0.5136s/iter; left time: 4975.0408s
	iters: 200, epoch: 32 | loss: 0.5905798
	speed: 0.0118s/iter; left time: 112.6937s
	iters: 300, epoch: 32 | loss: 0.6690381
	speed: 0.0117s/iter; left time: 111.4406s
	iters: 400, epoch: 32 | loss: 0.6348749
	speed: 0.0118s/iter; left time: 110.3734s
	iters: 500, epoch: 32 | loss: 0.6369964
	speed: 0.0117s/iter; left time: 108.6379s
Epoch: 32 cost time: 23.991124153137207
Epoch: 32, Steps: 515 | Train Loss: 0.6264356 Vali Loss: 0.6299573 Vali AUC: 0.7866969
Validation loss decreased (0.630181 --> 0.629957).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.6599051
	speed: 0.5140s/iter; left time: 4713.8630s
	iters: 200, epoch: 33 | loss: 0.6418141
	speed: 0.0118s/iter; left time: 107.2198s
	iters: 300, epoch: 33 | loss: 0.6324025
	speed: 0.0118s/iter; left time: 105.9656s
	iters: 400, epoch: 33 | loss: 0.7208955
	speed: 0.0118s/iter; left time: 104.9237s
	iters: 500, epoch: 33 | loss: 0.6796942
	speed: 0.0118s/iter; left time: 103.2171s
Epoch: 33 cost time: 24.155385971069336
Epoch: 33, Steps: 515 | Train Loss: 0.6258901 Vali Loss: 0.6307649 Vali AUC: 0.7856827
EarlyStopping counter: 1 out of 15
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.5827165
	speed: 0.5140s/iter; left time: 4448.9056s
	iters: 200, epoch: 34 | loss: 0.6017447
	speed: 0.0118s/iter; left time: 100.9993s
	iters: 300, epoch: 34 | loss: 0.6291569
	speed: 0.0118s/iter; left time: 99.8195s
	iters: 400, epoch: 34 | loss: 0.6307334
	speed: 0.0118s/iter; left time: 98.6752s
	iters: 500, epoch: 34 | loss: 0.5673491
	speed: 0.0117s/iter; left time: 96.9889s
Epoch: 34 cost time: 24.108943939208984
Epoch: 34, Steps: 515 | Train Loss: 0.6257534 Vali Loss: 0.6300650 Vali AUC: 0.7868198
EarlyStopping counter: 2 out of 15
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.6546542
	speed: 0.5133s/iter; left time: 4178.7878s
	iters: 200, epoch: 35 | loss: 0.6515669
	speed: 0.0118s/iter; left time: 94.9179s
	iters: 300, epoch: 35 | loss: 0.6302243
	speed: 0.0118s/iter; left time: 93.5777s
	iters: 400, epoch: 35 | loss: 0.6887038
	speed: 0.0118s/iter; left time: 92.4751s
	iters: 500, epoch: 35 | loss: 0.6227971
	speed: 0.0117s/iter; left time: 90.8778s
Epoch: 35 cost time: 24.046563625335693
Epoch: 35, Steps: 515 | Train Loss: 0.6252678 Vali Loss: 0.6308385 Vali AUC: 0.7855377
EarlyStopping counter: 3 out of 15
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.5944885
	speed: 0.5130s/iter; left time: 3912.1484s
	iters: 200, epoch: 36 | loss: 0.6379392
	speed: 0.0118s/iter; left time: 88.5585s
	iters: 300, epoch: 36 | loss: 0.6427284
	speed: 0.0118s/iter; left time: 87.6126s
	iters: 400, epoch: 36 | loss: 0.6175740
	speed: 0.0118s/iter; left time: 86.2738s
	iters: 500, epoch: 36 | loss: 0.5675606
	speed: 0.0117s/iter; left time: 84.7717s
Epoch: 36 cost time: 24.07546639442444
Epoch: 36, Steps: 515 | Train Loss: 0.6255228 Vali Loss: 0.6305294 Vali AUC: 0.7864858
EarlyStopping counter: 4 out of 15
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.6069016
	speed: 0.5127s/iter; left time: 3645.7110s
	iters: 200, epoch: 37 | loss: 0.6132231
	speed: 0.0118s/iter; left time: 82.8450s
	iters: 300, epoch: 37 | loss: 0.7304452
	speed: 0.0117s/iter; left time: 81.1650s
	iters: 400, epoch: 37 | loss: 0.5564398
	speed: 0.0118s/iter; left time: 80.4697s
	iters: 500, epoch: 37 | loss: 0.5830889
	speed: 0.0118s/iter; left time: 78.9324s
Epoch: 37 cost time: 24.00739336013794
Epoch: 37, Steps: 515 | Train Loss: 0.6250101 Vali Loss: 0.6304357 Vali AUC: 0.7861250
EarlyStopping counter: 5 out of 15
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.6978803
	speed: 0.5141s/iter; left time: 3390.8961s
	iters: 200, epoch: 38 | loss: 0.6215203
	speed: 0.0118s/iter; left time: 76.5160s
	iters: 300, epoch: 38 | loss: 0.5836038
	speed: 0.0118s/iter; left time: 75.2054s
	iters: 400, epoch: 38 | loss: 0.6461931
	speed: 0.0118s/iter; left time: 74.0127s
	iters: 500, epoch: 38 | loss: 0.5667579
	speed: 0.0117s/iter; left time: 72.6288s
Epoch: 38 cost time: 24.04453182220459
Epoch: 38, Steps: 515 | Train Loss: 0.6253323 Vali Loss: 0.6298685 Vali AUC: 0.7868238
Validation loss decreased (0.629957 --> 0.629869).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.6041583
	speed: 0.5137s/iter; left time: 3124.0646s
	iters: 200, epoch: 39 | loss: 0.5852295
	speed: 0.0118s/iter; left time: 70.3874s
	iters: 300, epoch: 39 | loss: 0.7027979
	speed: 0.0118s/iter; left time: 69.1256s
	iters: 400, epoch: 39 | loss: 0.5970492
	speed: 0.0118s/iter; left time: 68.0474s
	iters: 500, epoch: 39 | loss: 0.6222993
	speed: 0.0117s/iter; left time: 66.5582s
Epoch: 39 cost time: 24.048677682876587
Epoch: 39, Steps: 515 | Train Loss: 0.6244166 Vali Loss: 0.6298781 Vali AUC: 0.7867164
EarlyStopping counter: 1 out of 15
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.5768510
	speed: 0.5152s/iter; left time: 2867.5520s
	iters: 200, epoch: 40 | loss: 0.5629619
	speed: 0.0117s/iter; left time: 63.9871s
	iters: 300, epoch: 40 | loss: 0.6136423
	speed: 0.0117s/iter; left time: 62.9550s
	iters: 400, epoch: 40 | loss: 0.6760567
	speed: 0.0117s/iter; left time: 61.7857s
	iters: 500, epoch: 40 | loss: 0.6773962
	speed: 0.0117s/iter; left time: 60.2853s
Epoch: 40 cost time: 24.00162124633789
Epoch: 40, Steps: 515 | Train Loss: 0.6235331 Vali Loss: 0.6297861 Vali AUC: 0.7869033
Validation loss decreased (0.629869 --> 0.629786).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.6413276
	speed: 0.5140s/iter; left time: 2596.0966s
	iters: 200, epoch: 41 | loss: 0.6001809
	speed: 0.0118s/iter; left time: 58.6357s
	iters: 300, epoch: 41 | loss: 0.5950761
	speed: 0.0118s/iter; left time: 57.3477s
	iters: 400, epoch: 41 | loss: 0.6550246
	speed: 0.0118s/iter; left time: 56.2465s
	iters: 500, epoch: 41 | loss: 0.6691010
	speed: 0.0118s/iter; left time: 54.7971s
Epoch: 41 cost time: 24.10246753692627
Epoch: 41, Steps: 515 | Train Loss: 0.6241941 Vali Loss: 0.6301985 Vali AUC: 0.7864737
EarlyStopping counter: 1 out of 15
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.6320642
	speed: 0.5144s/iter; left time: 2333.2945s
	iters: 200, epoch: 42 | loss: 0.5891045
	speed: 0.0118s/iter; left time: 52.4036s
	iters: 300, epoch: 42 | loss: 0.6302878
	speed: 0.0118s/iter; left time: 51.2024s
	iters: 400, epoch: 42 | loss: 0.6356164
	speed: 0.0118s/iter; left time: 49.9874s
	iters: 500, epoch: 42 | loss: 0.6500314
	speed: 0.0117s/iter; left time: 48.5470s
Epoch: 42 cost time: 24.044365167617798
Epoch: 42, Steps: 515 | Train Loss: 0.6243452 Vali Loss: 0.6302647 Vali AUC: 0.7861745
EarlyStopping counter: 2 out of 15
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.6066082
	speed: 0.5155s/iter; left time: 2072.7221s
	iters: 200, epoch: 43 | loss: 0.5820669
	speed: 0.0118s/iter; left time: 46.3745s
	iters: 300, epoch: 43 | loss: 0.5810270
	speed: 0.0118s/iter; left time: 45.1767s
	iters: 400, epoch: 43 | loss: 0.6353712
	speed: 0.0118s/iter; left time: 44.0249s
	iters: 500, epoch: 43 | loss: 0.6442159
	speed: 0.0118s/iter; left time: 42.6630s
Epoch: 43 cost time: 24.13348126411438
Epoch: 43, Steps: 515 | Train Loss: 0.6253058 Vali Loss: 0.6297838 Vali AUC: 0.7866958
Validation loss decreased (0.629786 --> 0.629784).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.6243240
	speed: 0.5140s/iter; left time: 1802.1468s
	iters: 200, epoch: 44 | loss: 0.6154233
	speed: 0.0118s/iter; left time: 40.0825s
	iters: 300, epoch: 44 | loss: 0.6468735
	speed: 0.0118s/iter; left time: 38.9810s
	iters: 400, epoch: 44 | loss: 0.6484286
	speed: 0.0118s/iter; left time: 37.8529s
	iters: 500, epoch: 44 | loss: 0.6165664
	speed: 0.0117s/iter; left time: 36.4867s
Epoch: 44 cost time: 24.042722463607788
Epoch: 44, Steps: 515 | Train Loss: 0.6251160 Vali Loss: 0.6307631 Vali AUC: 0.7857546
EarlyStopping counter: 1 out of 15
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.6417333
	speed: 0.5131s/iter; left time: 1534.5941s
	iters: 200, epoch: 45 | loss: 0.6295274
	speed: 0.0118s/iter; left time: 34.2114s
	iters: 300, epoch: 45 | loss: 0.6266478
	speed: 0.0118s/iter; left time: 33.0235s
	iters: 400, epoch: 45 | loss: 0.6086766
	speed: 0.0118s/iter; left time: 31.8356s
	iters: 500, epoch: 45 | loss: 0.6034099
	speed: 0.0118s/iter; left time: 30.4944s
Epoch: 45 cost time: 24.056602478027344
Epoch: 45, Steps: 515 | Train Loss: 0.6249159 Vali Loss: 0.6308554 Vali AUC: 0.7860548
EarlyStopping counter: 2 out of 15
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.6388547
	speed: 0.5139s/iter; left time: 1272.4439s
	iters: 200, epoch: 46 | loss: 0.6203486
	speed: 0.0118s/iter; left time: 28.0822s
	iters: 300, epoch: 46 | loss: 0.5686561
	speed: 0.0118s/iter; left time: 26.8850s
	iters: 400, epoch: 46 | loss: 0.6334919
	speed: 0.0118s/iter; left time: 25.6772s
	iters: 500, epoch: 46 | loss: 0.6503484
	speed: 0.0117s/iter; left time: 24.3613s
Epoch: 46 cost time: 23.992223262786865
Epoch: 46, Steps: 515 | Train Loss: 0.6254481 Vali Loss: 0.6296868 Vali AUC: 0.7866285
Validation loss decreased (0.629784 --> 0.629687).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.6974861
	speed: 0.5127s/iter; left time: 1005.4230s
	iters: 200, epoch: 47 | loss: 0.5977734
	speed: 0.0118s/iter; left time: 21.9362s
	iters: 300, epoch: 47 | loss: 0.6150689
	speed: 0.0118s/iter; left time: 20.7684s
	iters: 400, epoch: 47 | loss: 0.5315016
	speed: 0.0118s/iter; left time: 19.6069s
	iters: 500, epoch: 47 | loss: 0.6135163
	speed: 0.0118s/iter; left time: 18.3425s
Epoch: 47 cost time: 24.080881357192993
Epoch: 47, Steps: 515 | Train Loss: 0.6249610 Vali Loss: 0.6298819 Vali AUC: 0.7864307
EarlyStopping counter: 1 out of 15
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.5736831
	speed: 0.5162s/iter; left time: 746.4780s
	iters: 200, epoch: 48 | loss: 0.5105373
	speed: 0.0118s/iter; left time: 15.8724s
	iters: 300, epoch: 48 | loss: 0.5613802
	speed: 0.0118s/iter; left time: 14.7289s
	iters: 400, epoch: 48 | loss: 0.6434714
	speed: 0.0118s/iter; left time: 13.5498s
	iters: 500, epoch: 48 | loss: 0.5627465
	speed: 0.0118s/iter; left time: 12.2973s
Epoch: 48 cost time: 24.109636783599854
Epoch: 48, Steps: 515 | Train Loss: 0.6253235 Vali Loss: 0.6293899 Vali AUC: 0.7865713
Validation loss decreased (0.629687 --> 0.629390).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.6700749
	speed: 0.5173s/iter; left time: 481.6103s
	iters: 200, epoch: 49 | loss: 0.6842522
	speed: 0.0118s/iter; left time: 9.7950s
	iters: 300, epoch: 49 | loss: 0.6479172
	speed: 0.0118s/iter; left time: 8.6243s
	iters: 400, epoch: 49 | loss: 0.6252750
	speed: 0.0118s/iter; left time: 7.4629s
	iters: 500, epoch: 49 | loss: 0.6124132
	speed: 0.0118s/iter; left time: 6.2455s
Epoch: 49 cost time: 24.169370889663696
Epoch: 49, Steps: 515 | Train Loss: 0.6249575 Vali Loss: 0.6299021 Vali AUC: 0.7866494
EarlyStopping counter: 1 out of 15
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.6447921
	speed: 0.5155s/iter; left time: 214.4447s
	iters: 200, epoch: 50 | loss: 0.6147536
	speed: 0.0117s/iter; left time: 3.7128s
	iters: 300, epoch: 50 | loss: 0.6158828
	speed: 0.0118s/iter; left time: 2.5413s
	iters: 400, epoch: 50 | loss: 0.5221115
	speed: 0.0118s/iter; left time: 1.3639s
	iters: 500, epoch: 50 | loss: 0.5949098
	speed: 0.0117s/iter; left time: 0.1873s
Epoch: 50 cost time: 24.044681310653687
Epoch: 50, Steps: 515 | Train Loss: 0.6248524 Vali Loss: 0.6305780 Vali AUC: 0.7859729
EarlyStopping counter: 2 out of 15
Updating learning rate to 7.069650490151056e-07
>>>>>>>testing : ctg_960_PatchTST_CTG_sl960_nc2_dm128_nh8_el4_df640_fc1_Exp<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Dataset saved to ./jResults/20240925 1350
test set size: 4118
accuracy:0.727294803302574, precision:0.8439407149084568, recall:0.5062761506276151, f1:0.6328865642366788, auc:0.7865712852357776
